2024-06-27 23:49:05.582861: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-27 23:49:05.584126: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-06-27 23:49:05.591764: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-06-27 23:49:05.629286: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-27 23:49:16.889804: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
  0%|          | 0/500000 [00:00<?, ?it/s]  0%|          | 1/500000 [00:07<1040:26:45,  7.49s/it]  0%|          | 724/500000 [00:07<1:01:26, 135.42it/s]  0%|          | 1466/500000 [00:07<25:33, 325.09it/s]   0%|          | 2208/500000 [00:07<14:18, 579.51it/s]  1%|          | 2939/500000 [00:07<09:07, 907.48it/s]  1%|          | 3679/500000 [00:07<06:13, 1329.95it/s]  1%|          | 4430/500000 [00:08<04:27, 1855.50it/s]  1%|          | 5180/500000 [00:08<03:20, 2466.84it/s]  1%|          | 5930/500000 [00:08<02:37, 3141.22it/s]  1%|▏         | 6680/500000 [00:08<02:08, 3841.13it/s]  1%|▏         | 7422/500000 [00:08<01:49, 4508.60it/s]  2%|▏         | 8171/500000 [00:08<01:35, 5135.78it/s]  2%|▏         | 8922/500000 [00:08<01:26, 5683.06it/s]  2%|▏         | 9671/500000 [00:08<01:19, 6130.26it/s]  2%|▏         | 10422/500000 [00:08<01:15, 6490.87it/s]  2%|▏         | 11174/500000 [00:08<01:12, 6769.04it/s]  2%|▏         | 11923/500000 [00:09<01:10, 6948.06it/s]  3%|▎         | 12669/500000 [00:09<01:08, 7086.45it/s]  3%|▎         | 13415/500000 [00:09<01:08, 7150.00it/s]  3%|▎         | 14158/500000 [00:09<01:07, 7229.84it/s]  3%|▎         | 14907/500000 [00:09<01:06, 7306.20it/s]  3%|▎         | 15651/500000 [00:09<01:05, 7342.74it/s]  3%|▎         | 16395/500000 [00:17<25:14, 319.32it/s]   3%|▎         | 17111/500000 [00:17<18:10, 442.66it/s]  4%|▎         | 17860/500000 [00:17<12:58, 619.63it/s]  4%|▎         | 18608/500000 [00:17<09:21, 857.20it/s]  4%|▍         | 19348/500000 [00:17<06:52, 1165.60it/s]  4%|▍         | 20087/500000 [00:17<05:07, 1558.28it/s]  4%|▍         | 20836/500000 [00:17<03:53, 2048.62it/s]  4%|▍         | 21568/500000 [00:17<03:03, 2605.26it/s]  4%|▍         | 22316/500000 [00:17<02:27, 3244.31it/s]  5%|▍         | 23060/500000 [00:18<02:02, 3905.75it/s]  5%|▍         | 23807/500000 [00:18<01:44, 4560.39it/s]  5%|▍         | 24551/500000 [00:18<01:32, 5159.09it/s]  5%|▌         | 25301/500000 [00:18<01:23, 5695.33it/s]  5%|▌         | 26044/500000 [00:18<01:17, 6106.53it/s]  5%|▌         | 26793/500000 [00:18<01:13, 6465.68it/s]  6%|▌         | 27541/500000 [00:18<01:10, 6739.62it/s]  6%|▌         | 28292/500000 [00:18<01:07, 6953.31it/s]  6%|▌         | 29040/500000 [00:18<01:06, 7102.61it/s]  6%|▌         | 29791/500000 [00:18<01:05, 7220.05it/s]  6%|▌         | 30543/500000 [00:19<01:04, 7306.24it/s]  6%|▋         | 31292/500000 [00:19<01:03, 7359.65it/s]Traceback (most recent call last):
  File "/exports/eddie/scratch/s2524927/msc-project/atari/analyze_atari_data.py", line 225, in <module>
    main()
  File "/exports/eddie/scratch/s2524927/msc-project/atari/analyze_atari_data.py", line 198, in main
    obss, actions, rewards, done_idxs = analyze_game_data(
  File "/exports/eddie/scratch/s2524927/msc-project/atari/analyze_atari_data.py", line 35, in analyze_game_data
    states, ac, ret, next_states, next_action, next_reward, terminal, indices = frb.sample_transition_batch(batch_size=1, indices=[i])
  File "/exports/eddie/scratch/s2524927/msc-project/atari/data_process_atari/fixed_replay_buffer.py", line 124, in sample_transition_batch
    return self._replay_buffers[buffer_index].sample_transition_batch(
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/dopamine/replay_memory/circular_replay_buffer.py", line 635, in sample_transition_batch
    element_array[batch_element] = self.get_observation_stack(
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/dopamine/replay_memory/circular_replay_buffer.py", line 444, in get_observation_stack
    return self._get_element_stack(index, 'observation')
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/dopamine/replay_memory/circular_replay_buffer.py", line 447, in _get_element_stack
    state = self.get_range(
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/dopamine/replay_memory/circular_replay_buffer.py", line 433, in get_range
    return_array = array[start_index:end_index, ...]
KeyboardInterrupt
  6%|▋         | 31669/500000 [00:19<04:45, 1639.60it/s]
