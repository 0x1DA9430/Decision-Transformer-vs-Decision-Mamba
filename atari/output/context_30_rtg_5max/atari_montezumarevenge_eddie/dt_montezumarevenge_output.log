CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 3
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-24 01:03:38.661919: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-24 01:03:39.371603: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-24 01:03:44.398378: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 19%|█▊        | 93155/500000 [01:06<04:52, 1391.28it/s] 25%|██▍       | 124489/500000 [01:19<04:29, 1391.28it/s] 43%|████▎     | 213895/500000 [02:06<02:44, 1739.96it/s] 54%|█████▍    | 268974/500000 [02:19<02:12, 1739.96it/s] 77%|███████▋  | 384063/500000 [03:13<00:54, 2122.19it/s] 88%|████████▊ | 440295/500000 [03:29<00:28, 2122.19it/s]518309it [04:15, 2143.87it/s]                            565133it [04:30, 2143.87it/s]576332it [04:31, 2119.38it/s]
07/24/2024 01:12:30 - INFO - mingpt.model_atari - number of parameters: 4662528
this buffer has 11198 loaded transitions and there are now 500000 transitions total divided into 201 trajectories
max rtg is 0
max timestep is 27002
epoch 0
  0%|          | 0/1953 [00:00<?, ?it/s]  2%|▏         | 39/1953 [01:00<49:49,  1.56s/it]  2%|▏         | 39/1953 [01:11<49:49,  1.56s/it]  3%|▎         | 59/1953 [01:30<48:34,  1.54s/it]
Traceback (most recent call last):
  File "/exports/eddie/scratch/s2524927/msc-project/atari/train_atari.py", line 212, in <module>
    main()
  File "/exports/eddie/scratch/s2524927/msc-project/atari/train_atari.py", line 191, in main
    trainer.train()
  File "/exports/eddie/scratch/s2524927/msc-project/atari/mingpt/trainer_atari.py", line 214, in train
    loss = run_epoch('train', epoch_num=epoch, epoch_losses=epoch_losses, epoch_lrs=epoch_lrs)
  File "/exports/eddie/scratch/s2524927/msc-project/atari/mingpt/trainer_atari.py", line 152, in run_epoch
    for it, (x, y, r, t) in pbar:
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/_utils.py", line 705, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 316, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 173, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 173, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 141, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/exports/eddie/scratch/s2524927/anaconda/envs/ssm/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

2024-07-24 01:14:28.551514: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-24 01:14:29.094389: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-24 01:14:33.039567: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 21%|██        | 103643/500000 [01:07<04:17, 1538.32it/s] 28%|██▊       | 140656/500000 [01:20<03:53, 1538.32it/s] 45%|████▌     | 226000/500000 [02:07<02:30, 1818.81it/s] 49%|████▉     | 244255/500000 [02:20<02:20, 1818.81it/s] 70%|██████▉   | 349634/500000 [03:07<01:18, 1926.25it/s] 80%|███████▉  | 399626/500000 [03:20<00:52, 1926.25it/s]538698it [04:07, 2401.87it/s]                            553585it [04:09, 2219.20it/s]
07/24/2024 01:23:29 - INFO - mingpt.model_atari - number of parameters: 4662528
this buffer has 19187 loaded transitions and there are now 500000 transitions total divided into 196 trajectories
max rtg is 0
max timestep is 27002
epoch 0
  0%|          | 0/1953 [00:00<?, ?it/s]  2%|▏         | 39/1953 [01:01<50:11,  1.57s/it]  2%|▏         | 39/1953 [01:20<50:11,  1.57s/it]  4%|▍         | 80/1953 [02:02<47:39,  1.53s/it]  4%|▍         | 80/1953 [02:20<47:39,  1.53s/it]  6%|▌         | 121/1953 [03:03<46:06,  1.51s/it]  6%|▌         | 121/1953 [03:20<46:06,  1.51s/it]  8%|▊         | 162/1953 [04:04<44:49,  1.50s/it]  8%|▊         | 162/1953 [04:20<44:49,  1.50s/it] 10%|█         | 203/1953 [05:05<43:40,  1.50s/it] 10%|█         | 203/1953 [05:20<43:40,  1.50s/it] 12%|█▏        | 244/1953 [06:06<42:34,  1.49s/it] 12%|█▏        | 244/1953 [06:20<42:34,  1.49s/it] 15%|█▍        | 285/1953 [07:08<41:30,  1.49s/it] 15%|█▍        | 285/1953 [07:20<41:30,  1.49s/it] 17%|█▋        | 326/1953 [08:09<40:26,  1.49s/it] 17%|█▋        | 326/1953 [08:20<40:26,  1.49s/it] 19%|█▉        | 367/1953 [09:10<39:24,  1.49s/it] 19%|█▉        | 367/1953 [09:20<39:24,  1.49s/it] 21%|██        | 408/1953 [10:11<38:26,  1.49s/it]