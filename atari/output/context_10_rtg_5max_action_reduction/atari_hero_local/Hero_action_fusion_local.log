2024-07-04 22:23:27.045026: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-04 22:23:27.098588: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-04 22:23:27.826565: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 13%|█▎        | 67309/500000 [01:06<07:05, 1016.35it/s] 20%|██        | 100479/500000 [01:20<06:33, 1016.35it/s] 30%|██▉       | 148807/500000 [02:06<04:50, 1209.25it/s] 34%|███▍      | 170488/500000 [02:20<04:32, 1209.25it/s] 44%|████▎     | 218195/500000 [03:06<03:57, 1185.70it/s] 49%|████▊     | 243591/500000 [03:20<03:36, 1185.70it/s] 57%|█████▋    | 285429/500000 [04:06<03:04, 1159.85it/s] 62%|██████▏   | 309420/500000 [04:20<02:44, 1159.85it/s] 71%|███████   | 352514/500000 [05:06<02:08, 1144.92it/s] 76%|███████▌  | 378215/500000 [05:20<01:46, 1144.92it/s] 84%|████████▍ | 420947/500000 [06:14<01:12, 1095.22it/s] 89%|████████▉ | 446958/500000 [06:30<00:48, 1095.22it/s] 99%|█████████▉| 493845/500000 [07:15<00:05, 1122.55it/s]100%|██████████| 500000/500000 [07:16<00:00, 1144.69it/s]
07/04/2024 22:31:35 - INFO - mingpt.model_atari - number of parameters: 1930880
this buffer has 6155 loaded transitions and there are now 500000 transitions total divided into 365 trajectories
max rtg is 189
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▍         | 96/1954 [01:00<19:23,  1.60it/s]  5%|▍         | 96/1954 [01:12<19:23,  1.60it/s] 10%|█         | 202/1954 [02:00<17:17,  1.69it/s] 10%|█         | 202/1954 [02:12<17:17,  1.69it/s] 16%|█▌        | 317/1954 [03:00<15:13,  1.79it/s] 16%|█▌        | 317/1954 [03:12<15:13,  1.79it/s] 22%|██▏       | 437/1954 [04:01<13:31,  1.87it/s] 22%|██▏       | 437/1954 [04:12<13:31,  1.87it/s] 29%|██▊       | 560/1954 [05:01<12:02,  1.93it/s] 29%|██▊       | 560/1954 [05:12<12:02,  1.93it/s] 35%|███▌      | 685/1954 [06:02<10:42,  1.98it/s] 35%|███▌      | 685/1954 [06:12<10:42,  1.98it/s] 41%|████▏     | 810/1954 [07:02<09:29,  2.01it/s] 41%|████▏     | 810/1954 [07:12<09:29,  2.01it/s] 48%|████▊     | 933/1954 [08:02<08:25,  2.02it/s] 48%|████▊     | 933/1954 [08:12<08:25,  2.02it/s] 54%|█████▍    | 1059/1954 [09:02<07:18,  2.04it/s] 54%|█████▍    | 1059/1954 [09:22<07:18,  2.04it/s] 61%|██████    | 1184/1954 [10:03<06:15,  2.05it/s] 61%|██████    | 1184/1954 [10:22<06:15,  2.05it/s] 67%|██████▋   | 1310/1954 [11:03<05:11,  2.07it/s] 67%|██████▋   | 1310/1954 [11:22<05:11,  2.07it/s] 73%|███████▎  | 1436/1954 [12:03<04:09,  2.07it/s] 73%|███████▎  | 1436/1954 [12:22<04:09,  2.07it/s] 80%|████████  | 1564/1954 [13:03<03:06,  2.09it/s] 80%|████████  | 1564/1954 [13:22<03:06,  2.09it/s] 87%|████████▋ | 1691/1954 [14:03<02:05,  2.09it/s] 87%|████████▋ | 1691/1954 [14:22<02:05,  2.09it/s] 93%|█████████▎| 1818/1954 [15:04<01:04,  2.10it/s] 93%|█████████▎| 1818/1954 [15:22<01:04,  2.10it/s] 99%|█████████▉| 1944/1954 [16:04<00:04,  2.10it/s]100%|██████████| 1954/1954 [16:09<00:00,  2.02it/s]
07/04/2024 22:47:45 - INFO - mingpt.trainer_atari - train loss: 1.154302
target return: 950, eval return: 2911
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 121/1954 [01:00<15:14,  2.00it/s]  6%|▌         | 121/1954 [01:14<15:14,  2.00it/s] 12%|█▏        | 244/1954 [02:00<14:04,  2.02it/s] 12%|█▏        | 244/1954 [02:14<14:04,  2.02it/s] 19%|█▉        | 369/1954 [03:01<12:54,  2.05it/s] 19%|█▉        | 369/1954 [03:14<12:54,  2.05it/s] 25%|██▌       | 494/1954 [04:01<11:49,  2.06it/s] 25%|██▌       | 494/1954 [04:14<11:49,  2.06it/s] 32%|███▏      | 618/1954 [05:01<10:48,  2.06it/s] 32%|███▏      | 618/1954 [05:14<10:48,  2.06it/s] 38%|███▊      | 743/1954 [06:01<09:46,  2.06it/s] 38%|███▊      | 743/1954 [06:14<09:46,  2.06it/s] 44%|████▍     | 868/1954 [07:01<08:44,  2.07it/s] 44%|████▍     | 868/1954 [07:14<08:44,  2.07it/s] 51%|█████     | 993/1954 [08:02<07:44,  2.07it/s] 51%|█████     | 993/1954 [08:14<07:44,  2.07it/s] 57%|█████▋    | 1117/1954 [09:02<06:45,  2.07it/s] 57%|█████▋    | 1117/1954 [09:14<06:45,  2.07it/s] 64%|██████▎   | 1244/1954 [10:02<05:41,  2.08it/s] 64%|██████▎   | 1244/1954 [10:14<05:41,  2.08it/s] 70%|███████   | 1369/1954 [11:03<04:41,  2.08it/s] 70%|███████   | 1369/1954 [11:14<04:41,  2.08it/s] 76%|███████▋  | 1494/1954 [12:03<03:41,  2.08it/s] 76%|███████▋  | 1494/1954 [12:14<03:41,  2.08it/s] 83%|████████▎ | 1618/1954 [13:03<02:42,  2.07it/s] 83%|████████▎ | 1618/1954 [13:14<02:42,  2.07it/s] 89%|████████▉ | 1743/1954 [14:03<01:41,  2.07it/s] 89%|████████▉ | 1743/1954 [14:14<01:41,  2.07it/s] 96%|█████████▌| 1868/1954 [15:04<00:41,  2.07it/s] 96%|█████████▌| 1868/1954 [15:14<00:41,  2.07it/s]100%|██████████| 1954/1954 [15:45<00:00,  2.07it/s]
07/04/2024 23:04:19 - INFO - mingpt.trainer_atari - train loss: 1.032164
target return: 950, eval return: 2883
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 208/1954 [01:00<08:25,  3.45it/s] 11%|█         | 208/1954 [01:13<08:25,  3.45it/s] 22%|██▏       | 422/1954 [02:00<07:16,  3.51it/s] 22%|██▏       | 422/1954 [02:13<07:16,  3.51it/s] 33%|███▎      | 638/1954 [03:00<06:11,  3.55it/s] 33%|███▎      | 638/1954 [03:13<06:11,  3.55it/s] 44%|████▍     | 855/1954 [04:00<05:07,  3.57it/s] 44%|████▍     | 855/1954 [04:13<05:07,  3.57it/s] 55%|█████▍    | 1068/1954 [05:01<04:08,  3.56it/s] 55%|█████▍    | 1068/1954 [05:13<04:08,  3.56it/s] 66%|██████▌   | 1283/1954 [06:01<03:08,  3.56it/s] 66%|██████▌   | 1283/1954 [06:13<03:08,  3.56it/s] 77%|███████▋  | 1499/1954 [07:01<02:07,  3.57it/s] 77%|███████▋  | 1499/1954 [07:13<02:07,  3.57it/s] 88%|████████▊ | 1714/1954 [08:01<01:07,  3.57it/s] 88%|████████▊ | 1714/1954 [08:13<01:07,  3.57it/s] 99%|█████████▊| 1929/1954 [09:01<00:06,  3.58it/s]100%|██████████| 1954/1954 [09:09<00:00,  3.55it/s]
07/04/2024 23:16:25 - INFO - mingpt.trainer_atari - train loss: 0.953543
target return: 950, eval return: 3163
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 215/1954 [01:00<08:05,  3.58it/s] 11%|█         | 215/1954 [01:19<08:05,  3.58it/s] 22%|██▏       | 438/1954 [02:00<06:54,  3.66it/s] 22%|██▏       | 438/1954 [02:19<06:54,  3.66it/s] 34%|███▍      | 663/1954 [03:00<05:49,  3.70it/s] 34%|███▍      | 663/1954 [03:19<05:49,  3.70it/s] 45%|████▌     | 889/1954 [04:00<04:46,  3.72it/s] 45%|████▌     | 889/1954 [04:19<04:46,  3.72it/s] 57%|█████▋    | 1114/1954 [05:00<03:45,  3.73it/s] 57%|█████▋    | 1114/1954 [05:19<03:45,  3.73it/s] 69%|██████▊   | 1340/1954 [06:00<02:44,  3.74it/s] 69%|██████▊   | 1340/1954 [06:19<02:44,  3.74it/s] 80%|████████  | 1566/1954 [07:00<01:43,  3.74it/s] 80%|████████  | 1566/1954 [07:19<01:43,  3.74it/s] 92%|█████████▏| 1791/1954 [08:01<00:43,  3.74it/s] 92%|█████████▏| 1791/1954 [08:19<00:43,  3.74it/s]100%|██████████| 1954/1954 [08:44<00:00,  3.72it/s]
07/04/2024 23:26:44 - INFO - mingpt.trainer_atari - train loss: 0.870231
target return: 950, eval return: 2867
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 10%|█         | 205/1954 [01:00<08:32,  3.41it/s] 10%|█         | 205/1954 [01:15<08:32,  3.41it/s] 21%|██▏       | 417/1954 [02:00<07:21,  3.48it/s] 21%|██▏       | 417/1954 [02:15<07:21,  3.48it/s] 32%|███▏      | 631/1954 [03:00<06:15,  3.52it/s] 32%|███▏      | 631/1954 [03:15<06:15,  3.52it/s] 43%|████▎     | 845/1954 [04:00<05:13,  3.53it/s] 43%|████▎     | 845/1954 [04:15<05:13,  3.53it/s] 54%|█████▍    | 1059/1954 [05:00<04:12,  3.54it/s] 54%|█████▍    | 1059/1954 [05:15<04:12,  3.54it/s] 65%|██████▌   | 1273/1954 [06:00<03:11,  3.55it/s] 65%|██████▌   | 1273/1954 [06:15<03:11,  3.55it/s] 76%|███████▌  | 1487/1954 [07:00<02:11,  3.56it/s] 76%|███████▌  | 1487/1954 [07:15<02:11,  3.56it/s] 87%|████████▋ | 1701/1954 [08:00<01:11,  3.56it/s] 87%|████████▋ | 1701/1954 [08:15<01:11,  3.56it/s] 98%|█████████▊| 1915/1954 [09:00<00:10,  3.56it/s]100%|██████████| 1954/1954 [09:11<00:00,  3.54it/s]
07/04/2024 23:37:35 - INFO - mingpt.trainer_atari - train loss: 0.800669
target return: 950, eval return: 2901
2024-07-04 23:40:10.672689: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-04 23:40:10.918694: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-04 23:40:11.787008: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 16%|█▋        | 81666/500000 [01:09<05:53, 1182.29it/s] 19%|█▉        | 94106/500000 [01:20<05:43, 1182.29it/s] 33%|███▎      | 165591/500000 [02:17<04:36, 1208.14it/s] 37%|███▋      | 182726/500000 [02:30<04:22, 1208.14it/s] 48%|████▊     | 240919/500000 [03:27<03:45, 1149.90it/s] 53%|█████▎    | 262877/500000 [03:40<03:26, 1149.90it/s] 61%|██████▏   | 306986/500000 [04:27<02:50, 1132.27it/s] 65%|██████▌   | 325950/500000 [04:40<02:33, 1132.27it/s] 75%|███████▍  | 372693/500000 [05:27<01:53, 1118.50it/s] 78%|███████▊  | 392053/500000 [05:40<01:36, 1118.50it/s] 88%|████████▊ | 442083/500000 [06:27<00:51, 1129.68it/s] 92%|█████████▏| 457596/500000 [06:40<00:37, 1129.68it/s]100%|██████████| 500000/500000 [07:17<00:00, 1143.35it/s]
07/04/2024 23:48:21 - INFO - mingpt.model_atari - number of parameters: 1927808
this buffer has 18403 loaded transitions and there are now 500000 transitions total divided into 364 trajectories
max rtg is 189
max timestep is 3349
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 146/1954 [01:00<12:24,  2.43it/s]  7%|▋         | 146/1954 [01:11<12:24,  2.43it/s] 17%|█▋        | 331/1954 [02:00<09:37,  2.81it/s] 17%|█▋        | 331/1954 [02:11<09:37,  2.81it/s] 28%|██▊       | 539/1954 [03:00<07:35,  3.11it/s] 28%|██▊       | 539/1954 [03:11<07:35,  3.11it/s] 39%|███▊      | 756/1954 [04:00<06:02,  3.30it/s] 39%|███▊      | 756/1954 [04:11<06:02,  3.30it/s] 50%|████▉     | 975/1954 [05:00<04:45,  3.42it/s] 50%|████▉     | 975/1954 [05:11<04:45,  3.42it/s] 61%|██████▏   | 1197/1954 [06:00<03:35,  3.51it/s] 61%|██████▏   | 1197/1954 [06:11<03:35,  3.51it/s] 73%|███████▎  | 1422/1954 [07:01<02:28,  3.59it/s] 73%|███████▎  | 1422/1954 [07:11<02:28,  3.59it/s] 84%|████████▍ | 1648/1954 [08:01<01:23,  3.64it/s] 84%|████████▍ | 1648/1954 [08:11<01:23,  3.64it/s] 96%|█████████▌| 1874/1954 [09:01<00:21,  3.68it/s] 96%|█████████▌| 1874/1954 [09:21<00:21,  3.68it/s]100%|██████████| 1954/1954 [09:23<00:00,  3.47it/s]
07/04/2024 23:57:45 - INFO - mingpt.trainer_atari - train loss: 1.148587
target return: 950, eval return: 2662
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 216/1954 [01:00<08:04,  3.59it/s] 11%|█         | 216/1954 [01:11<08:04,  3.59it/s] 22%|██▏       | 439/1954 [02:00<06:53,  3.66it/s] 22%|██▏       | 439/1954 [02:11<06:53,  3.66it/s] 34%|███▍      | 664/1954 [03:00<05:48,  3.70it/s] 34%|███▍      | 664/1954 [03:11<05:48,  3.70it/s] 45%|████▌     | 889/1954 [04:00<04:46,  3.71it/s] 45%|████▌     | 889/1954 [04:11<04:46,  3.71it/s] 57%|█████▋    | 1114/1954 [05:00<03:45,  3.73it/s] 57%|█████▋    | 1114/1954 [05:11<03:45,  3.73it/s] 69%|██████▊   | 1340/1954 [06:00<02:44,  3.74it/s] 69%|██████▊   | 1340/1954 [06:11<02:44,  3.74it/s] 80%|███████▉  | 1563/1954 [07:00<01:44,  3.73it/s] 80%|███████▉  | 1563/1954 [07:11<01:44,  3.73it/s] 91%|█████████ | 1783/1954 [08:00<00:46,  3.71it/s] 91%|█████████ | 1783/1954 [08:11<00:46,  3.71it/s]100%|██████████| 1954/1954 [08:46<00:00,  3.71it/s]
07/05/2024 00:08:17 - INFO - mingpt.trainer_atari - train loss: 1.028934
target return: 950, eval return: 2963
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 207/1954 [01:00<08:26,  3.45it/s] 11%|█         | 207/1954 [01:19<08:26,  3.45it/s] 22%|██▏       | 421/1954 [02:00<07:16,  3.51it/s] 22%|██▏       | 421/1954 [02:19<07:16,  3.51it/s] 32%|███▏      | 623/1954 [03:00<06:26,  3.44it/s] 32%|███▏      | 623/1954 [03:19<06:26,  3.44it/s] 42%|████▏     | 813/1954 [04:00<05:42,  3.33it/s] 42%|████▏     | 813/1954 [04:19<05:42,  3.33it/s] 52%|█████▏    | 1009/1954 [05:00<04:45,  3.31it/s] 52%|█████▏    | 1009/1954 [05:19<04:45,  3.31it/s] 62%|██████▏   | 1207/1954 [06:00<03:46,  3.30it/s] 62%|██████▏   | 1207/1954 [06:19<03:46,  3.30it/s] 71%|███████▏  | 1395/1954 [07:01<02:52,  3.24it/s] 71%|███████▏  | 1395/1954 [07:19<02:52,  3.24it/s] 81%|████████▏ | 1591/1954 [08:01<01:51,  3.25it/s] 81%|████████▏ | 1591/1954 [08:19<01:51,  3.25it/s] 92%|█████████▏| 1791/1954 [09:01<00:49,  3.27it/s] 92%|█████████▏| 1791/1954 [09:19<00:49,  3.27it/s]100%|██████████| 1954/1954 [09:49<00:00,  3.31it/s]
07/05/2024 00:19:23 - INFO - mingpt.trainer_atari - train loss: 0.950059
target return: 950, eval return: 2841
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 206/1954 [01:00<08:31,  3.42it/s] 11%|█         | 206/1954 [01:10<08:31,  3.42it/s] 21%|██        | 414/1954 [02:00<07:26,  3.45it/s] 21%|██        | 414/1954 [02:10<07:26,  3.45it/s] 32%|███▏      | 619/1954 [03:00<06:29,  3.43it/s] 32%|███▏      | 619/1954 [03:10<06:29,  3.43it/s] 42%|████▏     | 827/1954 [04:00<05:27,  3.44it/s] 42%|████▏     | 827/1954 [04:10<05:27,  3.44it/s] 53%|█████▎    | 1039/1954 [05:00<04:23,  3.47it/s] 53%|█████▎    | 1039/1954 [05:10<04:23,  3.47it/s] 64%|██████▍   | 1256/1954 [06:00<03:18,  3.52it/s] 64%|██████▍   | 1256/1954 [06:10<03:18,  3.52it/s] 75%|███████▌  | 1472/1954 [07:00<02:15,  3.54it/s] 75%|███████▌  | 1472/1954 [07:10<02:15,  3.54it/s] 87%|████████▋ | 1692/1954 [08:00<01:13,  3.58it/s] 87%|████████▋ | 1692/1954 [08:20<01:13,  3.58it/s] 98%|█████████▊| 1911/1954 [09:00<00:11,  3.60it/s]100%|██████████| 1954/1954 [09:12<00:00,  3.54it/s]
07/05/2024 00:29:55 - INFO - mingpt.trainer_atari - train loss: 0.865791
target return: 950, eval return: 2872
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 212/1954 [01:00<08:14,  3.52it/s] 11%|█         | 212/1954 [01:13<08:14,  3.52it/s] 22%|██▏       | 429/1954 [02:00<07:06,  3.57it/s] 22%|██▏       | 429/1954 [02:13<07:06,  3.57it/s] 33%|███▎      | 648/1954 [03:00<06:02,  3.60it/s] 33%|███▎      | 648/1954 [03:13<06:02,  3.60it/s] 44%|████▍     | 858/1954 [04:00<05:08,  3.56it/s] 44%|████▍     | 858/1954 [04:13<05:08,  3.56it/s] 55%|█████▍    | 1071/1954 [05:00<04:08,  3.55it/s] 55%|█████▍    | 1071/1954 [05:13<04:08,  3.55it/s] 66%|██████▌   | 1287/1954 [06:01<03:07,  3.56it/s] 66%|██████▌   | 1287/1954 [06:13<03:07,  3.56it/s] 77%|███████▋  | 1506/1954 [07:01<02:04,  3.59it/s] 77%|███████▋  | 1506/1954 [07:13<02:04,  3.59it/s] 88%|████████▊ | 1725/1954 [08:01<01:03,  3.61it/s] 88%|████████▊ | 1725/1954 [08:13<01:03,  3.61it/s] 99%|█████████▉| 1942/1954 [09:01<00:03,  3.61it/s]100%|██████████| 1954/1954 [09:05<00:00,  3.59it/s]
07/05/2024 00:39:44 - INFO - mingpt.trainer_atari - train loss: 0.795262
target return: 950, eval return: 2884
2024-07-05 00:40:44.915399: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-05 00:40:45.164905: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-05 00:40:46.051617: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 13%|█▎        | 67309/500000 [01:09<07:24, 973.82it/s] 16%|█▌        | 79436/500000 [01:20<07:11, 973.82it/s] 29%|██▊       | 142862/500000 [02:10<05:19, 1118.07it/s] 34%|███▍      | 170488/500000 [02:30<04:54, 1118.07it/s] 44%|████▎     | 217982/500000 [03:13<04:04, 1154.44it/s] 49%|████▉     | 245358/500000 [03:30<03:40, 1154.44it/s] 57%|█████▋    | 285429/500000 [04:14<03:08, 1135.98it/s] 62%|██████▏   | 309420/500000 [04:30<02:47, 1135.98it/s] 70%|██████▉   | 349023/500000 [05:14<02:16, 1105.23it/s] 76%|███████▌  | 378215/500000 [05:30<01:50, 1105.23it/s] 83%|████████▎ | 417194/500000 [06:14<01:14, 1115.54it/s] 87%|████████▋ | 436349/500000 [06:30<00:57, 1115.54it/s] 96%|█████████▌| 478608/500000 [07:15<00:19, 1080.33it/s]100%|██████████| 500000/500000 [07:29<00:00, 1113.02it/s]
07/05/2024 00:49:02 - INFO - mingpt.model_atari - number of parameters: 1628288
this buffer has 6155 loaded transitions and there are now 500000 transitions total divided into 365 trajectories
max rtg is 189
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 133/1954 [01:00<13:46,  2.20it/s]  7%|▋         | 133/1954 [01:10<13:46,  2.20it/s] 16%|█▌        | 305/1954 [02:00<10:36,  2.59it/s] 16%|█▌        | 305/1954 [02:10<10:36,  2.59it/s] 26%|██▌       | 502/1954 [03:00<08:19,  2.91it/s] 26%|██▌       | 502/1954 [03:10<08:19,  2.91it/s] 36%|███▋      | 713/1954 [04:00<06:35,  3.14it/s] 36%|███▋      | 713/1954 [04:20<06:35,  3.14it/s] 47%|████▋     | 926/1954 [05:00<05:12,  3.29it/s] 47%|████▋     | 926/1954 [05:20<05:12,  3.29it/s] 58%|█████▊    | 1143/1954 [06:00<03:58,  3.39it/s] 58%|█████▊    | 1143/1954 [06:20<03:58,  3.39it/s] 70%|██████▉   | 1361/1954 [07:01<02:50,  3.47it/s] 70%|██████▉   | 1361/1954 [07:20<02:50,  3.47it/s] 81%|████████  | 1582/1954 [08:01<01:45,  3.53it/s] 81%|████████  | 1582/1954 [08:20<01:45,  3.53it/s] 92%|█████████▏| 1801/1954 [09:01<00:42,  3.57it/s] 92%|█████████▏| 1801/1954 [09:20<00:42,  3.57it/s]100%|██████████| 1954/1954 [09:45<00:00,  3.34it/s]
07/05/2024 00:58:51 - INFO - mingpt.trainer_atari - train loss: 1.172718
target return: 950, eval return: 2922
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s] 10%|█         | 202/1954 [01:00<08:41,  3.36it/s] 10%|█         | 202/1954 [01:11<08:41,  3.36it/s] 21%|██        | 408/1954 [02:00<07:34,  3.40it/s] 21%|██        | 408/1954 [02:11<07:34,  3.40it/s] 32%|███▏      | 618/1954 [03:00<06:27,  3.45it/s] 32%|███▏      | 618/1954 [03:11<06:27,  3.45it/s] 42%|████▏     | 828/1954 [04:00<05:25,  3.46it/s] 42%|████▏     | 828/1954 [04:11<05:25,  3.46it/s] 53%|█████▎    | 1038/1954 [05:00<04:23,  3.47it/s] 53%|█████▎    | 1038/1954 [05:11<04:23,  3.47it/s] 64%|██████▍   | 1248/1954 [06:00<03:22,  3.48it/s] 64%|██████▍   | 1248/1954 [06:11<03:22,  3.48it/s] 75%|███████▍  | 1457/1954 [07:00<02:22,  3.48it/s] 75%|███████▍  | 1457/1954 [07:11<02:22,  3.48it/s] 85%|████████▌ | 1665/1954 [08:00<01:23,  3.47it/s] 85%|████████▌ | 1665/1954 [08:11<01:23,  3.47it/s] 96%|█████████▌| 1872/1954 [09:00<00:23,  3.47it/s] 96%|█████████▌| 1872/1954 [09:11<00:23,  3.47it/s]100%|██████████| 1954/1954 [09:24<00:00,  3.46it/s]
07/05/2024 01:11:50 - INFO - mingpt.trainer_atari - train loss: 1.082695
target return: 950, eval return: 3011
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 213/1954 [01:00<08:11,  3.54it/s] 11%|█         | 213/1954 [01:13<08:11,  3.54it/s] 22%|██▏       | 432/1954 [02:00<07:03,  3.60it/s] 22%|██▏       | 432/1954 [02:13<07:03,  3.60it/s] 33%|███▎      | 654/1954 [03:00<05:56,  3.64it/s] 33%|███▎      | 654/1954 [03:13<05:56,  3.64it/s] 45%|████▍     | 877/1954 [04:00<04:53,  3.67it/s] 45%|████▍     | 877/1954 [04:13<04:53,  3.67it/s] 56%|█████▌    | 1096/1954 [05:00<03:54,  3.66it/s] 56%|█████▌    | 1096/1954 [05:13<03:54,  3.66it/s] 67%|██████▋   | 1315/1954 [06:00<02:54,  3.65it/s] 67%|██████▋   | 1315/1954 [06:13<02:54,  3.65it/s] 79%|███████▊  | 1536/1954 [07:00<01:54,  3.66it/s] 79%|███████▊  | 1536/1954 [07:13<01:54,  3.66it/s] 90%|████████▉ | 1756/1954 [08:01<00:54,  3.66it/s] 90%|████████▉ | 1756/1954 [08:13<00:54,  3.66it/s]100%|██████████| 1954/1954 [08:55<00:00,  3.65it/s]
07/05/2024 01:21:49 - INFO - mingpt.trainer_atari - train loss: 1.040746
target return: 950, eval return: 3001
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 214/1954 [01:00<08:09,  3.56it/s] 11%|█         | 214/1954 [01:15<08:09,  3.56it/s] 22%|██▏       | 432/1954 [02:00<07:03,  3.59it/s] 22%|██▏       | 432/1954 [02:15<07:03,  3.59it/s] 33%|███▎      | 649/1954 [03:00<06:02,  3.60it/s] 33%|███▎      | 649/1954 [03:15<06:02,  3.60it/s] 44%|████▍     | 855/1954 [04:00<05:10,  3.53it/s] 44%|████▍     | 855/1954 [04:15<05:10,  3.53it/s] 55%|█████▍    | 1065/1954 [05:00<04:12,  3.52it/s] 55%|█████▍    | 1065/1954 [05:15<04:12,  3.52it/s] 66%|██████▌   | 1281/1954 [06:00<03:09,  3.54it/s] 66%|██████▌   | 1281/1954 [06:15<03:09,  3.54it/s] 77%|███████▋  | 1498/1954 [07:00<02:07,  3.57it/s] 77%|███████▋  | 1498/1954 [07:15<02:07,  3.57it/s] 88%|████████▊ | 1717/1954 [08:00<01:05,  3.59it/s] 88%|████████▊ | 1717/1954 [08:15<01:05,  3.59it/s] 99%|█████████▉| 1936/1954 [09:01<00:04,  3.61it/s]100%|██████████| 1954/1954 [09:06<00:00,  3.58it/s]
07/05/2024 01:31:57 - INFO - mingpt.trainer_atari - train loss: 1.004898
target return: 950, eval return: 2990
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 10%|▉         | 195/1954 [01:00<09:01,  3.25it/s] 10%|▉         | 195/1954 [01:15<09:01,  3.25it/s] 21%|██        | 401/1954 [02:00<07:43,  3.35it/s] 21%|██        | 401/1954 [02:15<07:43,  3.35it/s] 31%|███       | 607/1954 [03:00<06:38,  3.38it/s] 31%|███       | 607/1954 [03:15<06:38,  3.38it/s] 42%|████▏     | 814/1954 [04:00<05:34,  3.41it/s] 42%|████▏     | 814/1954 [04:15<05:34,  3.41it/s] 52%|█████▏    | 1025/1954 [05:00<04:29,  3.45it/s] 52%|█████▏    | 1025/1954 [05:15<04:29,  3.45it/s] 64%|██████▎   | 1241/1954 [06:00<03:23,  3.50it/s] 64%|██████▎   | 1241/1954 [06:15<03:23,  3.50it/s] 75%|███████▍  | 1458/1954 [07:00<02:20,  3.53it/s] 75%|███████▍  | 1458/1954 [07:15<02:20,  3.53it/s] 86%|████████▌ | 1675/1954 [08:01<01:18,  3.55it/s] 86%|████████▌ | 1675/1954 [08:15<01:18,  3.55it/s] 97%|█████████▋| 1893/1954 [09:01<00:17,  3.58it/s] 97%|█████████▋| 1893/1954 [09:15<00:17,  3.58it/s]100%|██████████| 1954/1954 [09:18<00:00,  3.50it/s]
07/05/2024 01:43:30 - INFO - mingpt.trainer_atari - train loss: 0.975952
target return: 950, eval return: 2996
2024-07-05 01:46:37.079966: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-05 01:46:37.352361: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-05 01:46:38.333823: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 13%|█▎        | 66992/500000 [01:04<06:58, 1033.99it/s] 19%|█▉        | 93811/500000 [01:20<06:32, 1033.99it/s] 28%|██▊       | 137845/500000 [02:07<05:33, 1084.73it/s] 30%|███       | 150909/500000 [02:20<05:21, 1084.73it/s] 40%|████      | 201331/500000 [03:09<04:42, 1057.64it/s] 42%|████▏     | 211939/500000 [03:20<04:32, 1057.64it/s] 54%|█████▍    | 270739/500000 [04:09<03:29, 1095.64it/s] 55%|█████▌    | 276322/500000 [04:20<03:24, 1095.64it/s] 66%|██████▋   | 331759/500000 [05:10<02:38, 1061.56it/s] 72%|███████▏  | 358519/500000 [05:30<02:13, 1061.56it/s] 79%|███████▉  | 395901/500000 [06:15<01:40, 1037.06it/s] 84%|████████▍ | 421327/500000 [06:30<01:15, 1037.06it/s] 94%|█████████▎| 468480/500000 [07:19<00:29, 1067.37it/s] 96%|█████████▌| 479773/500000 [07:30<00:18, 1067.37it/s]100%|██████████| 500000/500000 [07:46<00:00, 1072.49it/s]
07/05/2024 01:55:13 - INFO - mingpt.model_atari - number of parameters: 1625216
this buffer has 18403 loaded transitions and there are now 500000 transitions total divided into 364 trajectories
max rtg is 189
max timestep is 3349
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 119/1954 [01:00<15:26,  1.98it/s]  6%|▌         | 119/1954 [01:11<15:26,  1.98it/s] 14%|█▍        | 277/1954 [02:00<11:50,  2.36it/s] 14%|█▍        | 277/1954 [02:11<11:50,  2.36it/s] 23%|██▎       | 459/1954 [03:00<09:20,  2.67it/s] 23%|██▎       | 459/1954 [03:11<09:20,  2.67it/s] 34%|███▍      | 661/1954 [04:00<07:20,  2.94it/s] 34%|███▍      | 661/1954 [04:11<07:20,  2.94it/s] 44%|████▍     | 868/1954 [05:00<05:47,  3.12it/s] 44%|████▍     | 868/1954 [05:11<05:47,  3.12it/s] 55%|█████▌    | 1077/1954 [06:00<04:30,  3.24it/s] 55%|█████▌    | 1077/1954 [06:11<04:30,  3.24it/s] 66%|██████▌   | 1289/1954 [07:00<03:19,  3.33it/s] 66%|██████▌   | 1289/1954 [07:11<03:19,  3.33it/s] 77%|███████▋  | 1502/1954 [08:01<02:12,  3.40it/s] 77%|███████▋  | 1502/1954 [08:11<02:12,  3.40it/s] 88%|████████▊ | 1718/1954 [09:01<01:08,  3.46it/s] 88%|████████▊ | 1718/1954 [09:11<01:08,  3.46it/s] 99%|█████████▉| 1934/1954 [10:01<00:05,  3.50it/s]100%|██████████| 1954/1954 [10:08<00:00,  3.21it/s]
07/05/2024 02:05:26 - INFO - mingpt.trainer_atari - train loss: 1.177361
target return: 950, eval return: 2998
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 208/1954 [01:00<08:24,  3.46it/s] 11%|█         | 208/1954 [01:17<08:24,  3.46it/s] 22%|██▏       | 423/1954 [02:00<07:14,  3.53it/s] 22%|██▏       | 423/1954 [02:17<07:14,  3.53it/s] 32%|███▏      | 626/1954 [03:00<06:24,  3.46it/s] 32%|███▏      | 626/1954 [03:17<06:24,  3.46it/s] 43%|████▎     | 836/1954 [04:00<05:22,  3.47it/s] 43%|████▎     | 836/1954 [04:17<05:22,  3.47it/s] 53%|█████▎    | 1045/1954 [05:00<04:21,  3.47it/s] 53%|█████▎    | 1045/1954 [05:17<04:21,  3.47it/s] 65%|██████▍   | 1263/1954 [06:01<03:16,  3.52it/s] 65%|██████▍   | 1263/1954 [06:17<03:16,  3.52it/s] 76%|███████▌  | 1479/1954 [07:01<02:13,  3.55it/s] 76%|███████▌  | 1479/1954 [07:17<02:13,  3.55it/s] 86%|████████▋ | 1690/1954 [08:01<01:14,  3.54it/s] 86%|████████▋ | 1690/1954 [08:17<01:14,  3.54it/s] 97%|█████████▋| 1904/1954 [09:01<00:14,  3.54it/s]100%|██████████| 1954/1954 [09:15<00:00,  3.52it/s]
07/05/2024 02:15:37 - INFO - mingpt.trainer_atari - train loss: 1.087876
target return: 950, eval return: 3001
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 10%|█         | 205/1954 [01:00<08:33,  3.41it/s] 10%|█         | 205/1954 [01:14<08:33,  3.41it/s] 21%|██▏       | 419/1954 [02:00<07:19,  3.49it/s] 21%|██▏       | 419/1954 [02:14<07:19,  3.49it/s] 33%|███▎      | 638/1954 [03:00<06:09,  3.56it/s] 33%|███▎      | 638/1954 [03:14<06:09,  3.56it/s] 44%|████▍     | 859/1954 [04:00<05:03,  3.60it/s] 44%|████▍     | 859/1954 [04:14<05:03,  3.60it/s] 55%|█████▌    | 1079/1954 [05:00<04:01,  3.62it/s] 55%|█████▌    | 1079/1954 [05:14<04:01,  3.62it/s] 66%|██████▋   | 1298/1954 [06:01<03:00,  3.63it/s] 66%|██████▋   | 1298/1954 [06:14<03:00,  3.63it/s] 78%|███████▊  | 1518/1954 [07:01<01:59,  3.64it/s] 78%|███████▊  | 1518/1954 [07:14<01:59,  3.64it/s] 89%|████████▉ | 1738/1954 [08:01<00:59,  3.65it/s] 89%|████████▉ | 1738/1954 [08:14<00:59,  3.65it/s]100%|█████████▉| 1950/1954 [09:01<00:01,  3.61it/s]100%|██████████| 1954/1954 [09:02<00:00,  3.60it/s]
07/05/2024 02:25:28 - INFO - mingpt.trainer_atari - train loss: 1.049062
target return: 950, eval return: 2992
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 208/1954 [01:00<08:23,  3.47it/s] 11%|█         | 208/1954 [01:16<08:23,  3.47it/s] 22%|██▏       | 422/1954 [02:00<07:14,  3.53it/s] 22%|██▏       | 422/1954 [02:16<07:14,  3.53it/s] 33%|███▎      | 639/1954 [03:00<06:08,  3.56it/s] 33%|███▎      | 639/1954 [03:16<06:08,  3.56it/s] 44%|████▍     | 859/1954 [04:00<05:04,  3.60it/s] 44%|████▍     | 859/1954 [04:16<05:04,  3.60it/s] 55%|█████▌    | 1076/1954 [05:00<04:03,  3.60it/s] 55%|█████▌    | 1076/1954 [05:16<04:03,  3.60it/s] 66%|██████▌   | 1286/1954 [06:00<03:07,  3.56it/s] 66%|██████▌   | 1286/1954 [06:16<03:07,  3.56it/s] 77%|███████▋  | 1501/1954 [07:00<02:06,  3.57it/s] 77%|███████▋  | 1501/1954 [07:16<02:06,  3.57it/s] 88%|████████▊ | 1716/1954 [08:00<01:06,  3.57it/s] 88%|████████▊ | 1716/1954 [08:16<01:06,  3.57it/s] 99%|█████████▉| 1931/1954 [09:01<00:06,  3.57it/s]100%|██████████| 1954/1954 [09:07<00:00,  3.57it/s]
07/05/2024 02:35:41 - INFO - mingpt.trainer_atari - train loss: 1.015872
target return: 950, eval return: 3025
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 209/1954 [01:00<08:22,  3.47it/s] 11%|█         | 209/1954 [01:16<08:22,  3.47it/s] 22%|██▏       | 427/1954 [02:00<07:09,  3.56it/s] 22%|██▏       | 427/1954 [02:16<07:09,  3.56it/s] 33%|███▎      | 647/1954 [03:00<06:02,  3.61it/s] 33%|███▎      | 647/1954 [03:16<06:02,  3.61it/s] 44%|████▍     | 867/1954 [04:00<04:59,  3.63it/s] 44%|████▍     | 867/1954 [04:16<04:59,  3.63it/s] 56%|█████▌    | 1088/1954 [05:00<03:57,  3.65it/s] 56%|█████▌    | 1088/1954 [05:16<03:57,  3.65it/s] 67%|██████▋   | 1308/1954 [06:00<02:57,  3.65it/s] 67%|██████▋   | 1308/1954 [06:16<02:57,  3.65it/s] 78%|███████▊  | 1529/1954 [07:01<01:56,  3.66it/s] 78%|███████▊  | 1529/1954 [07:16<01:56,  3.66it/s] 90%|████████▉ | 1749/1954 [08:01<00:56,  3.66it/s] 90%|████████▉ | 1749/1954 [08:16<00:56,  3.66it/s]100%|██████████| 1954/1954 [08:56<00:00,  3.64it/s]
07/05/2024 02:45:30 - INFO - mingpt.trainer_atari - train loss: 0.989126
target return: 950, eval return: 3020
