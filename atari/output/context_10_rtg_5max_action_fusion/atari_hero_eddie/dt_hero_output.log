CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 0
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-17 06:37:53.681846: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 06:37:54.366682: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 06:37:58.934932: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▍        | 74749/500000 [01:00<05:44, 1234.31it/s] 20%|█▉        | 99571/500000 [01:19<05:24, 1234.31it/s] 32%|███▏      | 161073/500000 [02:01<04:12, 1342.49it/s] 38%|███▊      | 188310/500000 [02:19<03:52, 1342.49it/s] 49%|████▉     | 246191/500000 [03:02<03:05, 1370.25it/s] 54%|█████▍    | 270833/500000 [03:19<02:47, 1370.25it/s] 66%|██████▌   | 328201/500000 [04:02<02:05, 1368.91it/s] 71%|███████   | 352922/500000 [04:20<01:47, 1368.91it/s] 85%|████████▌ | 425569/500000 [05:02<00:50, 1460.05it/s] 91%|█████████▏| 457354/500000 [05:20<00:29, 1460.05it/s]100%|██████████| 500000/500000 [05:51<00:00, 1421.37it/s]
07/17/2024 06:44:37 - INFO - mingpt.model_atari - number of parameters: 1625216
this buffer has 2670 loaded transitions and there are now 500000 transitions total divided into 343 trajectories
max rtg is 189
max timestep is 3349
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 128/1954 [01:00<14:19,  2.12it/s]  7%|▋         | 128/1954 [01:19<14:19,  2.12it/s] 14%|█▎        | 265/1954 [02:00<12:42,  2.22it/s] 14%|█▎        | 265/1954 [02:19<12:42,  2.22it/s] 21%|██        | 402/1954 [03:00<11:31,  2.25it/s] 21%|██        | 402/1954 [03:19<11:31,  2.25it/s] 28%|██▊       | 540/1954 [04:00<10:25,  2.26it/s] 28%|██▊       | 540/1954 [04:19<10:25,  2.26it/s] 35%|███▍      | 678/1954 [05:01<09:22,  2.27it/s] 35%|███▍      | 678/1954 [05:19<09:22,  2.27it/s] 42%|████▏     | 816/1954 [06:01<08:19,  2.28it/s] 42%|████▏     | 816/1954 [06:19<08:19,  2.28it/s] 49%|████▉     | 954/1954 [07:01<07:18,  2.28it/s] 49%|████▉     | 954/1954 [07:19<07:18,  2.28it/s] 56%|█████▌    | 1092/1954 [08:02<06:17,  2.28it/s] 56%|█████▌    | 1092/1954 [08:19<06:17,  2.28it/s] 63%|██████▎   | 1230/1954 [09:02<05:16,  2.29it/s] 63%|██████▎   | 1230/1954 [09:19<05:16,  2.29it/s] 70%|██████▉   | 1367/1954 [10:02<04:16,  2.28it/s] 70%|██████▉   | 1367/1954 [10:19<04:16,  2.28it/s] 77%|███████▋  | 1505/1954 [11:02<03:16,  2.29it/s] 77%|███████▋  | 1505/1954 [11:19<03:16,  2.29it/s] 84%|████████▍ | 1643/1954 [12:02<02:15,  2.29it/s] 84%|████████▍ | 1643/1954 [12:19<02:15,  2.29it/s] 91%|█████████ | 1781/1954 [13:03<01:15,  2.29it/s] 91%|█████████ | 1781/1954 [13:19<01:15,  2.29it/s] 98%|█████████▊| 1919/1954 [14:03<00:15,  2.29it/s]100%|██████████| 1954/1954 [14:18<00:00,  2.28it/s]
07/17/2024 06:59:06 - INFO - mingpt.trainer_atari - train loss: 1.158347
target return: 950, eval return: 4577
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 121/1954 [01:00<15:15,  2.00it/s]  6%|▌         | 121/1954 [01:17<15:15,  2.00it/s] 12%|█▏        | 243/1954 [02:00<14:10,  2.01it/s] 12%|█▏        | 243/1954 [02:17<14:10,  2.01it/s] 19%|█▊        | 365/1954 [03:01<13:06,  2.02it/s] 19%|█▊        | 365/1954 [03:17<13:06,  2.02it/s] 25%|██▍       | 487/1954 [04:01<12:04,  2.02it/s] 25%|██▍       | 487/1954 [04:17<12:04,  2.02it/s] 31%|███       | 609/1954 [05:01<11:04,  2.02it/s] 31%|███       | 609/1954 [05:17<11:04,  2.02it/s] 37%|███▋      | 731/1954 [06:01<10:03,  2.03it/s] 37%|███▋      | 731/1954 [06:17<10:03,  2.03it/s] 44%|████▎     | 853/1954 [07:01<09:03,  2.03it/s] 44%|████▎     | 853/1954 [07:17<09:03,  2.03it/s] 50%|████▉     | 975/1954 [08:01<08:02,  2.03it/s] 50%|████▉     | 975/1954 [08:17<08:02,  2.03it/s] 56%|█████▌    | 1097/1954 [09:02<07:02,  2.03it/s] 56%|█████▌    | 1097/1954 [09:17<07:02,  2.03it/s] 62%|██████▏   | 1219/1954 [10:02<06:02,  2.03it/s] 62%|██████▏   | 1219/1954 [10:17<06:02,  2.03it/s] 69%|██████▊   | 1341/1954 [11:02<05:02,  2.03it/s] 69%|██████▊   | 1341/1954 [11:17<05:02,  2.03it/s] 75%|███████▍  | 1463/1954 [12:02<04:02,  2.03it/s] 75%|███████▍  | 1463/1954 [12:17<04:02,  2.03it/s] 81%|████████  | 1585/1954 [13:02<03:01,  2.03it/s] 81%|████████  | 1585/1954 [13:17<03:01,  2.03it/s] 87%|████████▋ | 1707/1954 [14:02<02:01,  2.03it/s] 87%|████████▋ | 1707/1954 [14:17<02:01,  2.03it/s] 94%|█████████▎| 1829/1954 [15:02<01:01,  2.03it/s] 94%|█████████▎| 1829/1954 [15:17<01:01,  2.03it/s]100%|█████████▉| 1951/1954 [16:03<00:01,  2.03it/s]100%|██████████| 1954/1954 [16:04<00:00,  2.03it/s]
07/17/2024 07:15:43 - INFO - mingpt.trainer_atari - train loss: 1.075659
target return: 950, eval return: 5623
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 120/1954 [01:00<15:18,  2.00it/s]  6%|▌         | 120/1954 [01:19<15:18,  2.00it/s] 12%|█▏        | 241/1954 [02:00<14:14,  2.00it/s] 12%|█▏        | 241/1954 [02:19<14:14,  2.00it/s] 19%|█▊        | 362/1954 [03:00<13:12,  2.01it/s] 19%|█▊        | 362/1954 [03:19<13:12,  2.01it/s] 25%|██▍       | 483/1954 [04:00<12:11,  2.01it/s] 25%|██▍       | 483/1954 [04:19<12:11,  2.01it/s] 31%|███       | 604/1954 [05:00<11:11,  2.01it/s] 31%|███       | 604/1954 [05:19<11:11,  2.01it/s] 37%|███▋      | 725/1954 [06:00<10:10,  2.01it/s] 37%|███▋      | 725/1954 [06:19<10:10,  2.01it/s] 43%|████▎     | 847/1954 [07:01<09:09,  2.01it/s] 43%|████▎     | 847/1954 [07:19<09:09,  2.01it/s] 50%|████▉     | 969/1954 [08:01<08:08,  2.02it/s] 50%|████▉     | 969/1954 [08:19<08:08,  2.02it/s] 56%|█████▌    | 1093/1954 [09:01<07:04,  2.03it/s] 56%|█████▌    | 1093/1954 [09:19<07:04,  2.03it/s] 62%|██████▏   | 1217/1954 [10:02<06:01,  2.04it/s] 62%|██████▏   | 1217/1954 [10:19<06:01,  2.04it/s] 69%|██████▊   | 1341/1954 [11:02<05:00,  2.04it/s] 69%|██████▊   | 1341/1954 [11:19<05:00,  2.04it/s] 75%|███████▍  | 1464/1954 [12:02<03:59,  2.04it/s] 75%|███████▍  | 1464/1954 [12:19<03:59,  2.04it/s] 81%|████████  | 1587/1954 [13:02<02:59,  2.04it/s] 81%|████████  | 1587/1954 [13:19<02:59,  2.04it/s] 88%|████████▊ | 1711/1954 [14:03<01:58,  2.05it/s] 88%|████████▊ | 1711/1954 [14:19<01:58,  2.05it/s] 94%|█████████▍| 1834/1954 [15:03<00:58,  2.05it/s] 94%|█████████▍| 1834/1954 [15:19<00:58,  2.05it/s]100%|██████████| 1954/1954 [16:01<00:00,  2.03it/s]
07/17/2024 07:32:19 - INFO - mingpt.trainer_atari - train loss: 1.039114
target return: 950, eval return: 6233
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 110/1954 [01:00<16:45,  1.83it/s]  6%|▌         | 110/1954 [01:17<16:45,  1.83it/s] 12%|█▏        | 225/1954 [02:00<15:20,  1.88it/s] 12%|█▏        | 225/1954 [02:17<15:20,  1.88it/s] 18%|█▊        | 357/1954 [03:00<13:09,  2.02it/s] 18%|█▊        | 357/1954 [03:17<13:09,  2.02it/s] 25%|██▍       | 487/1954 [04:00<11:45,  2.08it/s] 25%|██▍       | 487/1954 [04:17<11:45,  2.08it/s] 32%|███▏      | 618/1954 [05:00<10:32,  2.11it/s] 32%|███▏      | 618/1954 [05:17<10:32,  2.11it/s] 38%|███▊      | 748/1954 [06:00<09:26,  2.13it/s] 38%|███▊      | 748/1954 [06:17<09:26,  2.13it/s] 45%|████▍     | 879/1954 [07:01<08:21,  2.14it/s] 45%|████▍     | 879/1954 [07:17<08:21,  2.14it/s] 52%|█████▏    | 1009/1954 [08:01<07:20,  2.15it/s] 52%|█████▏    | 1009/1954 [08:17<07:20,  2.15it/s] 58%|█████▊    | 1140/1954 [09:02<06:18,  2.15it/s] 58%|█████▊    | 1140/1954 [09:17<06:18,  2.15it/s] 65%|██████▌   | 1271/1954 [10:02<05:16,  2.16it/s] 65%|██████▌   | 1271/1954 [10:17<05:16,  2.16it/s] 72%|███████▏  | 1402/1954 [11:02<04:15,  2.16it/s] 72%|███████▏  | 1402/1954 [11:17<04:15,  2.16it/s] 78%|███████▊  | 1533/1954 [12:03<03:14,  2.16it/s] 78%|███████▊  | 1533/1954 [12:17<03:14,  2.16it/s] 85%|████████▌ | 1664/1954 [13:03<02:13,  2.17it/s] 85%|████████▌ | 1664/1954 [13:17<02:13,  2.17it/s] 92%|█████████▏| 1794/1954 [14:03<01:13,  2.16it/s] 92%|█████████▏| 1794/1954 [14:17<01:13,  2.16it/s] 98%|█████████▊| 1924/1954 [15:03<00:13,  2.16it/s] 98%|█████████▊| 1924/1954 [15:17<00:13,  2.16it/s]100%|██████████| 1954/1954 [15:17<00:00,  2.13it/s]
07/17/2024 07:48:17 - INFO - mingpt.trainer_atari - train loss: 1.006330
target return: 950, eval return: 4271
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 100/1954 [01:00<18:36,  1.66it/s]  5%|▌         | 100/1954 [01:11<18:36,  1.66it/s] 10%|█         | 200/1954 [02:00<17:34,  1.66it/s] 10%|█         | 200/1954 [02:11<17:34,  1.66it/s] 15%|█▌        | 301/1954 [03:00<16:29,  1.67it/s] 15%|█▌        | 301/1954 [03:11<16:29,  1.67it/s] 21%|██        | 402/1954 [04:00<15:28,  1.67it/s] 21%|██        | 402/1954 [04:11<15:28,  1.67it/s] 26%|██▌       | 503/1954 [05:01<14:28,  1.67it/s] 26%|██▌       | 503/1954 [05:21<14:28,  1.67it/s] 31%|███       | 604/1954 [06:01<13:26,  1.67it/s] 31%|███       | 604/1954 [06:21<13:26,  1.67it/s] 36%|███▌      | 705/1954 [07:01<12:25,  1.67it/s] 36%|███▌      | 705/1954 [07:21<12:25,  1.67it/s] 41%|████      | 806/1954 [08:01<11:25,  1.68it/s] 41%|████      | 806/1954 [08:21<11:25,  1.68it/s] 46%|████▋     | 907/1954 [09:02<10:25,  1.67it/s] 46%|████▋     | 907/1954 [09:21<10:25,  1.67it/s] 52%|█████▏    | 1008/1954 [10:02<09:24,  1.67it/s] 52%|█████▏    | 1008/1954 [10:21<09:24,  1.67it/s] 57%|█████▋    | 1109/1954 [11:02<08:24,  1.68it/s] 57%|█████▋    | 1109/1954 [11:21<08:24,  1.68it/s] 62%|██████▏   | 1210/1954 [12:03<07:24,  1.67it/s] 62%|██████▏   | 1210/1954 [12:21<07:24,  1.67it/s] 67%|██████▋   | 1311/1954 [13:03<06:23,  1.67it/s] 67%|██████▋   | 1311/1954 [13:21<06:23,  1.67it/s] 72%|███████▏  | 1412/1954 [14:03<05:23,  1.68it/s] 72%|███████▏  | 1412/1954 [14:21<05:23,  1.68it/s] 77%|███████▋  | 1513/1954 [15:03<04:23,  1.68it/s] 77%|███████▋  | 1513/1954 [15:21<04:23,  1.68it/s] 83%|████████▎ | 1614/1954 [16:04<03:23,  1.67it/s] 83%|████████▎ | 1614/1954 [16:21<03:23,  1.67it/s] 88%|████████▊ | 1715/1954 [17:04<02:22,  1.68it/s] 88%|████████▊ | 1715/1954 [17:21<02:22,  1.68it/s] 93%|█████████▎| 1816/1954 [18:04<01:22,  1.68it/s] 93%|█████████▎| 1816/1954 [18:21<01:22,  1.68it/s] 98%|█████████▊| 1917/1954 [19:05<00:22,  1.67it/s] 98%|█████████▊| 1917/1954 [19:21<00:22,  1.67it/s]100%|██████████| 1954/1954 [19:26<00:00,  1.67it/s]
07/17/2024 08:09:33 - INFO - mingpt.trainer_atari - train loss: 0.979437
target return: 950, eval return: 5317
2024-07-17 08:10:56.313293: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 08:10:56.909793: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 08:11:00.928793: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 14%|█▍        | 69455/500000 [01:00<06:11, 1157.58it/s] 17%|█▋        | 82625/500000 [01:10<06:00, 1157.58it/s] 31%|███       | 154469/500000 [02:00<04:23, 1310.12it/s] 34%|███▎      | 168275/500000 [02:10<04:13, 1310.12it/s] 47%|████▋     | 237061/500000 [03:00<03:16, 1340.45it/s] 50%|█████     | 250583/500000 [03:10<03:06, 1340.45it/s] 63%|██████▎   | 314225/500000 [04:07<02:27, 1256.60it/s] 67%|██████▋   | 333670/500000 [04:20<02:12, 1256.60it/s] 80%|███████▉  | 399345/500000 [05:07<01:16, 1313.25it/s] 84%|████████▍ | 420294/500000 [05:20<01:00, 1313.25it/s] 98%|█████████▊| 491129/500000 [06:15<00:06, 1328.91it/s]100%|██████████| 500000/500000 [06:16<00:00, 1328.15it/s]
07/17/2024 08:17:58 - INFO - mingpt.model_atari - number of parameters: 1628288
this buffer has 20956 loaded transitions and there are now 500000 transitions total divided into 377 trajectories
max rtg is 189
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:29,  2.10it/s]  6%|▋         | 127/1954 [01:11<14:29,  2.10it/s] 13%|█▎        | 262/1954 [02:00<12:54,  2.19it/s] 13%|█▎        | 262/1954 [02:11<12:54,  2.19it/s] 20%|██        | 397/1954 [03:00<11:43,  2.21it/s] 20%|██        | 397/1954 [03:11<11:43,  2.21it/s] 27%|██▋       | 533/1954 [04:01<10:37,  2.23it/s] 27%|██▋       | 533/1954 [04:21<10:37,  2.23it/s] 34%|███▍      | 669/1954 [05:01<09:34,  2.24it/s] 34%|███▍      | 669/1954 [05:21<09:34,  2.24it/s] 41%|████      | 805/1954 [06:01<08:31,  2.25it/s] 41%|████      | 805/1954 [06:21<08:31,  2.25it/s] 48%|████▊     | 941/1954 [07:01<07:30,  2.25it/s] 48%|████▊     | 941/1954 [07:21<07:30,  2.25it/s] 55%|█████▌    | 1077/1954 [08:01<06:29,  2.25it/s] 55%|█████▌    | 1077/1954 [08:21<06:29,  2.25it/s] 62%|██████▏   | 1213/1954 [09:02<05:28,  2.26it/s] 62%|██████▏   | 1213/1954 [09:21<05:28,  2.26it/s] 69%|██████▉   | 1348/1954 [10:02<04:28,  2.25it/s] 69%|██████▉   | 1348/1954 [10:21<04:28,  2.25it/s] 76%|███████▌  | 1483/1954 [11:02<03:29,  2.25it/s] 76%|███████▌  | 1483/1954 [11:21<03:29,  2.25it/s] 83%|████████▎ | 1619/1954 [12:02<02:28,  2.25it/s] 83%|████████▎ | 1619/1954 [12:21<02:28,  2.25it/s] 90%|████████▉ | 1754/1954 [13:02<01:28,  2.25it/s] 90%|████████▉ | 1754/1954 [13:21<01:28,  2.25it/s] 97%|█████████▋| 1890/1954 [14:02<00:28,  2.25it/s] 97%|█████████▋| 1890/1954 [14:21<00:28,  2.25it/s]100%|██████████| 1954/1954 [14:31<00:00,  2.24it/s]
07/17/2024 08:32:39 - INFO - mingpt.trainer_atari - train loss: 1.134969
target return: 950, eval return: 3206
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 133/1954 [01:00<13:45,  2.21it/s]  7%|▋         | 133/1954 [01:17<13:45,  2.21it/s] 14%|█▎        | 268/1954 [02:00<12:36,  2.23it/s] 14%|█▎        | 268/1954 [02:17<12:36,  2.23it/s] 21%|██        | 403/1954 [03:00<11:33,  2.24it/s] 21%|██        | 403/1954 [03:17<11:33,  2.24it/s] 28%|██▊       | 539/1954 [04:00<10:30,  2.25it/s] 28%|██▊       | 539/1954 [04:17<10:30,  2.25it/s] 35%|███▍      | 675/1954 [05:00<09:28,  2.25it/s] 35%|███▍      | 675/1954 [05:17<09:28,  2.25it/s] 42%|████▏     | 811/1954 [06:01<08:27,  2.25it/s] 42%|████▏     | 811/1954 [06:17<08:27,  2.25it/s] 48%|████▊     | 947/1954 [07:01<07:26,  2.26it/s] 48%|████▊     | 947/1954 [07:17<07:26,  2.26it/s] 55%|█████▌    | 1082/1954 [08:01<06:27,  2.25it/s] 55%|█████▌    | 1082/1954 [08:17<06:27,  2.25it/s] 62%|██████▏   | 1218/1954 [09:01<05:26,  2.26it/s] 62%|██████▏   | 1218/1954 [09:17<05:26,  2.26it/s] 69%|██████▉   | 1354/1954 [10:01<04:25,  2.26it/s] 69%|██████▉   | 1354/1954 [10:17<04:25,  2.26it/s] 76%|███████▋  | 1490/1954 [11:02<03:25,  2.26it/s] 76%|███████▋  | 1490/1954 [11:17<03:25,  2.26it/s] 83%|████████▎ | 1626/1954 [12:02<02:25,  2.25it/s] 83%|████████▎ | 1626/1954 [12:17<02:25,  2.25it/s] 90%|█████████ | 1762/1954 [13:02<01:25,  2.25it/s] 90%|█████████ | 1762/1954 [13:17<01:25,  2.25it/s] 97%|█████████▋| 1898/1954 [14:03<00:24,  2.26it/s] 97%|█████████▋| 1898/1954 [14:17<00:24,  2.26it/s]100%|██████████| 1954/1954 [14:27<00:00,  2.25it/s]
07/17/2024 08:47:49 - INFO - mingpt.trainer_atari - train loss: 1.051802
target return: 950, eval return: 5176
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 133/1954 [01:00<13:45,  2.21it/s]  7%|▋         | 133/1954 [01:15<13:45,  2.21it/s] 14%|█▎        | 267/1954 [02:00<12:39,  2.22it/s] 14%|█▎        | 267/1954 [02:15<12:39,  2.22it/s] 21%|██        | 402/1954 [03:00<11:36,  2.23it/s] 21%|██        | 402/1954 [03:15<11:36,  2.23it/s] 28%|██▊       | 538/1954 [04:01<10:34,  2.23it/s] 28%|██▊       | 538/1954 [04:15<10:34,  2.23it/s] 34%|███▍      | 674/1954 [05:01<09:30,  2.24it/s] 34%|███▍      | 674/1954 [05:15<09:30,  2.24it/s] 41%|████▏     | 810/1954 [06:01<08:28,  2.25it/s] 41%|████▏     | 810/1954 [06:15<08:28,  2.25it/s] 48%|████▊     | 945/1954 [07:01<07:28,  2.25it/s] 48%|████▊     | 945/1954 [07:15<07:28,  2.25it/s] 55%|█████▌    | 1081/1954 [08:02<06:27,  2.25it/s] 55%|█████▌    | 1081/1954 [08:15<06:27,  2.25it/s] 62%|██████▏   | 1216/1954 [09:02<05:27,  2.25it/s] 62%|██████▏   | 1216/1954 [09:15<05:27,  2.25it/s] 69%|██████▉   | 1351/1954 [10:02<04:28,  2.25it/s] 69%|██████▉   | 1351/1954 [10:15<04:28,  2.25it/s] 76%|███████▌  | 1487/1954 [11:02<03:27,  2.25it/s] 76%|███████▌  | 1487/1954 [11:15<03:27,  2.25it/s] 83%|████████▎ | 1623/1954 [12:02<02:26,  2.25it/s] 83%|████████▎ | 1623/1954 [12:15<02:26,  2.25it/s] 90%|█████████ | 1759/1954 [13:03<01:26,  2.25it/s] 90%|█████████ | 1759/1954 [13:15<01:26,  2.25it/s] 97%|█████████▋| 1894/1954 [14:03<00:26,  2.25it/s] 97%|█████████▋| 1894/1954 [14:15<00:26,  2.25it/s]100%|██████████| 1954/1954 [14:29<00:00,  2.25it/s]
07/17/2024 09:03:03 - INFO - mingpt.trainer_atari - train loss: 1.018121
target return: 950, eval return: 5077
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 100/1954 [01:00<18:35,  1.66it/s]  5%|▌         | 100/1954 [01:12<18:35,  1.66it/s] 10%|█         | 202/1954 [02:00<17:25,  1.68it/s] 10%|█         | 202/1954 [02:12<17:25,  1.68it/s] 16%|█▌        | 304/1954 [03:01<16:22,  1.68it/s] 16%|█▌        | 304/1954 [03:12<16:22,  1.68it/s] 21%|██        | 405/1954 [04:01<15:22,  1.68it/s] 21%|██        | 405/1954 [04:12<15:22,  1.68it/s] 26%|██▌       | 507/1954 [05:01<14:20,  1.68it/s] 26%|██▌       | 507/1954 [05:12<14:20,  1.68it/s] 31%|███       | 608/1954 [06:01<13:20,  1.68it/s] 31%|███       | 608/1954 [06:12<13:20,  1.68it/s] 36%|███▋      | 709/1954 [07:01<12:20,  1.68it/s] 36%|███▋      | 709/1954 [07:12<12:20,  1.68it/s] 42%|████▏     | 811/1954 [08:02<11:18,  1.68it/s] 42%|████▏     | 811/1954 [08:12<11:18,  1.68it/s] 47%|████▋     | 913/1954 [09:02<10:17,  1.69it/s] 47%|████▋     | 913/1954 [09:12<10:17,  1.69it/s] 52%|█████▏    | 1015/1954 [10:03<09:16,  1.69it/s] 52%|█████▏    | 1015/1954 [10:22<09:16,  1.69it/s] 57%|█████▋    | 1117/1954 [11:03<08:16,  1.69it/s] 57%|█████▋    | 1117/1954 [11:22<08:16,  1.69it/s] 62%|██████▏   | 1219/1954 [12:04<07:15,  1.69it/s] 62%|██████▏   | 1219/1954 [12:22<07:15,  1.69it/s] 68%|██████▊   | 1321/1954 [13:04<06:15,  1.69it/s] 68%|██████▊   | 1321/1954 [13:22<06:15,  1.69it/s] 73%|███████▎  | 1422/1954 [14:04<05:15,  1.68it/s] 73%|███████▎  | 1422/1954 [14:22<05:15,  1.68it/s] 78%|███████▊  | 1524/1954 [15:05<04:15,  1.69it/s] 78%|███████▊  | 1524/1954 [15:22<04:15,  1.69it/s] 83%|████████▎ | 1626/1954 [16:05<03:14,  1.69it/s] 83%|████████▎ | 1626/1954 [16:22<03:14,  1.69it/s] 88%|████████▊ | 1728/1954 [17:06<02:14,  1.69it/s] 88%|████████▊ | 1728/1954 [17:22<02:14,  1.69it/s] 94%|█████████▎| 1829/1954 [18:06<01:14,  1.68it/s] 94%|█████████▎| 1829/1954 [18:22<01:14,  1.68it/s] 99%|█████████▉| 1931/1954 [19:06<00:13,  1.69it/s]100%|██████████| 1954/1954 [19:19<00:00,  1.68it/s]
07/17/2024 09:23:06 - INFO - mingpt.trainer_atari - train loss: 0.989211
target return: 950, eval return: 6743
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 117/1954 [01:00<15:49,  1.94it/s]  6%|▌         | 117/1954 [01:14<15:49,  1.94it/s] 12%|█▏        | 235/1954 [02:00<14:41,  1.95it/s] 12%|█▏        | 235/1954 [02:14<14:41,  1.95it/s] 18%|█▊        | 352/1954 [03:00<13:42,  1.95it/s] 18%|█▊        | 352/1954 [03:14<13:42,  1.95it/s] 24%|██▍       | 471/1954 [04:01<12:37,  1.96it/s] 24%|██▍       | 471/1954 [04:14<12:37,  1.96it/s] 30%|███       | 591/1954 [05:01<11:32,  1.97it/s] 30%|███       | 591/1954 [05:14<11:32,  1.97it/s] 36%|███▋      | 710/1954 [06:01<10:30,  1.97it/s] 36%|███▋      | 710/1954 [06:14<10:30,  1.97it/s] 43%|████▎     | 835/1954 [07:02<09:18,  2.00it/s] 43%|████▎     | 835/1954 [07:14<09:18,  2.00it/s] 49%|████▉     | 954/1954 [08:02<08:20,  2.00it/s] 49%|████▉     | 954/1954 [08:14<08:20,  2.00it/s] 55%|█████▍    | 1073/1954 [09:02<07:22,  1.99it/s] 55%|█████▍    | 1073/1954 [09:14<07:22,  1.99it/s] 61%|██████    | 1193/1954 [10:02<06:22,  1.99it/s] 61%|██████    | 1193/1954 [10:14<06:22,  1.99it/s] 67%|██████▋   | 1312/1954 [11:03<05:23,  1.98it/s] 67%|██████▋   | 1312/1954 [11:14<05:23,  1.98it/s] 73%|███████▎  | 1431/1954 [12:03<04:23,  1.98it/s] 73%|███████▎  | 1431/1954 [12:14<04:23,  1.98it/s] 79%|███████▉  | 1550/1954 [13:03<03:23,  1.98it/s] 79%|███████▉  | 1550/1954 [13:14<03:23,  1.98it/s] 85%|████████▌ | 1669/1954 [14:03<02:23,  1.98it/s] 85%|████████▌ | 1669/1954 [14:14<02:23,  1.98it/s] 91%|█████████▏| 1787/1954 [15:03<01:24,  1.98it/s] 91%|█████████▏| 1787/1954 [15:14<01:24,  1.98it/s] 98%|█████████▊| 1906/1954 [16:03<00:24,  1.98it/s] 98%|█████████▊| 1906/1954 [16:14<00:24,  1.98it/s]100%|██████████| 1954/1954 [16:27<00:00,  1.98it/s]
07/17/2024 09:40:32 - INFO - mingpt.trainer_atari - train loss: 0.964789
target return: 950, eval return: 5435
2024-07-17 09:42:05.571149: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 09:42:06.304786: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 09:42:10.951935: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 14%|█▍        | 71514/500000 [01:00<05:59, 1191.90it/s] 17%|█▋        | 85269/500000 [01:10<05:47, 1191.90it/s] 30%|██▉       | 149628/500000 [02:06<04:56, 1182.82it/s] 36%|███▌      | 178772/500000 [02:20<04:31, 1182.82it/s] 47%|████▋     | 236497/500000 [03:06<03:22, 1299.86it/s] 52%|█████▏    | 261350/500000 [03:20<03:03, 1299.86it/s] 65%|██████▌   | 325293/500000 [04:06<02:07, 1369.52it/s] 69%|██████▉   | 344797/500000 [04:20<01:53, 1369.52it/s] 82%|████████▏ | 411343/500000 [05:06<01:03, 1392.53it/s] 86%|████████▌ | 429565/500000 [05:20<00:50, 1392.53it/s] 99%|█████████▉| 495730/500000 [06:12<00:03, 1347.08it/s]100%|██████████| 500000/500000 [06:13<00:00, 1338.35it/s]
07/17/2024 09:49:06 - INFO - mingpt.model_atari - number of parameters: 1628288
this buffer has 4270 loaded transitions and there are now 500000 transitions total divided into 373 trajectories
max rtg is 187
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:24,  2.11it/s]  6%|▋         | 127/1954 [01:11<14:24,  2.11it/s] 13%|█▎        | 261/1954 [02:00<12:55,  2.18it/s] 13%|█▎        | 261/1954 [02:11<12:55,  2.18it/s] 20%|██        | 395/1954 [03:00<11:47,  2.20it/s] 20%|██        | 395/1954 [03:11<11:47,  2.20it/s] 27%|██▋       | 530/1954 [04:00<10:42,  2.22it/s] 27%|██▋       | 530/1954 [04:11<10:42,  2.22it/s] 34%|███▍      | 665/1954 [05:00<09:39,  2.22it/s] 34%|███▍      | 665/1954 [05:11<09:39,  2.22it/s] 41%|████      | 800/1954 [06:01<08:37,  2.23it/s] 41%|████      | 800/1954 [06:11<08:37,  2.23it/s] 48%|████▊     | 935/1954 [07:01<07:36,  2.23it/s] 48%|████▊     | 935/1954 [07:21<07:36,  2.23it/s] 55%|█████▍    | 1070/1954 [08:01<06:35,  2.24it/s] 55%|█████▍    | 1070/1954 [08:21<06:35,  2.24it/s] 62%|██████▏   | 1205/1954 [09:01<05:34,  2.24it/s] 62%|██████▏   | 1205/1954 [09:21<05:34,  2.24it/s] 69%|██████▊   | 1339/1954 [10:02<04:35,  2.23it/s] 69%|██████▊   | 1339/1954 [10:21<04:35,  2.23it/s] 75%|███████▌  | 1473/1954 [11:02<03:35,  2.23it/s] 75%|███████▌  | 1473/1954 [11:21<03:35,  2.23it/s] 82%|████████▏ | 1608/1954 [12:02<02:34,  2.23it/s] 82%|████████▏ | 1608/1954 [12:21<02:34,  2.23it/s] 89%|████████▉ | 1742/1954 [13:02<01:34,  2.23it/s] 89%|████████▉ | 1742/1954 [13:21<01:34,  2.23it/s] 96%|█████████▌| 1877/1954 [14:02<00:34,  2.23it/s] 96%|█████████▌| 1877/1954 [14:21<00:34,  2.23it/s]100%|██████████| 1954/1954 [14:37<00:00,  2.23it/s]
07/17/2024 10:03:55 - INFO - mingpt.trainer_atari - train loss: 1.132932
target return: 950, eval return: 4213
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 135/1954 [01:00<13:30,  2.24it/s]  7%|▋         | 135/1954 [01:13<13:30,  2.24it/s] 14%|█▍        | 273/1954 [02:00<12:20,  2.27it/s] 14%|█▍        | 273/1954 [02:13<12:20,  2.27it/s] 21%|██        | 411/1954 [03:00<11:16,  2.28it/s] 21%|██        | 411/1954 [03:13<11:16,  2.28it/s] 28%|██▊       | 549/1954 [04:00<10:15,  2.28it/s] 28%|██▊       | 549/1954 [04:13<10:15,  2.28it/s] 35%|███▌      | 687/1954 [05:01<09:13,  2.29it/s] 35%|███▌      | 687/1954 [05:13<09:13,  2.29it/s] 42%|████▏     | 825/1954 [06:01<08:13,  2.29it/s] 42%|████▏     | 825/1954 [06:13<08:13,  2.29it/s] 49%|████▉     | 963/1954 [07:01<07:12,  2.29it/s] 49%|████▉     | 963/1954 [07:13<07:12,  2.29it/s] 56%|█████▋    | 1101/1954 [08:01<06:12,  2.29it/s] 56%|█████▋    | 1101/1954 [08:13<06:12,  2.29it/s] 63%|██████▎   | 1239/1954 [09:01<05:12,  2.29it/s] 63%|██████▎   | 1239/1954 [09:13<05:12,  2.29it/s] 70%|███████   | 1377/1954 [10:02<04:11,  2.29it/s] 70%|███████   | 1377/1954 [10:13<04:11,  2.29it/s] 78%|███████▊  | 1515/1954 [11:02<03:11,  2.29it/s] 78%|███████▊  | 1515/1954 [11:13<03:11,  2.29it/s] 85%|████████▍ | 1652/1954 [12:02<02:12,  2.28it/s] 85%|████████▍ | 1652/1954 [12:13<02:12,  2.28it/s] 92%|█████████▏| 1790/1954 [13:03<01:11,  2.28it/s] 92%|█████████▏| 1790/1954 [13:13<01:11,  2.28it/s] 99%|█████████▊| 1928/1954 [14:03<00:11,  2.29it/s] 99%|█████████▊| 1928/1954 [14:13<00:11,  2.29it/s]100%|██████████| 1954/1954 [14:14<00:00,  2.29it/s]
07/17/2024 10:18:50 - INFO - mingpt.trainer_atari - train loss: 1.045481
target return: 950, eval return: 4170
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 132/1954 [01:00<13:51,  2.19it/s]  7%|▋         | 132/1954 [01:12<13:51,  2.19it/s] 14%|█▎        | 265/1954 [02:00<12:46,  2.20it/s] 14%|█▎        | 265/1954 [02:12<12:46,  2.20it/s] 20%|██        | 398/1954 [03:00<11:44,  2.21it/s] 20%|██        | 398/1954 [03:12<11:44,  2.21it/s] 27%|██▋       | 532/1954 [04:00<10:41,  2.22it/s] 27%|██▋       | 532/1954 [04:12<10:41,  2.22it/s] 34%|███▍      | 666/1954 [05:00<09:40,  2.22it/s] 34%|███▍      | 666/1954 [05:12<09:40,  2.22it/s] 41%|████      | 800/1954 [06:00<08:38,  2.22it/s] 41%|████      | 800/1954 [06:12<08:38,  2.22it/s] 48%|████▊     | 934/1954 [07:01<07:38,  2.22it/s] 48%|████▊     | 934/1954 [07:12<07:38,  2.22it/s] 55%|█████▍    | 1068/1954 [08:01<06:38,  2.23it/s] 55%|█████▍    | 1068/1954 [08:12<06:38,  2.23it/s] 62%|██████▏   | 1202/1954 [09:01<05:37,  2.23it/s] 62%|██████▏   | 1202/1954 [09:12<05:37,  2.23it/s] 68%|██████▊   | 1336/1954 [10:01<04:37,  2.23it/s] 68%|██████▊   | 1336/1954 [10:12<04:37,  2.23it/s] 75%|███████▌  | 1469/1954 [11:01<03:38,  2.22it/s] 75%|███████▌  | 1469/1954 [11:12<03:38,  2.22it/s] 82%|████████▏ | 1603/1954 [12:01<02:37,  2.23it/s] 82%|████████▏ | 1603/1954 [12:12<02:37,  2.23it/s] 89%|████████▉ | 1737/1954 [13:01<01:37,  2.23it/s] 89%|████████▉ | 1737/1954 [13:12<01:37,  2.23it/s] 96%|█████████▌| 1871/1954 [14:01<00:37,  2.23it/s] 96%|█████████▌| 1871/1954 [14:12<00:37,  2.23it/s]100%|██████████| 1954/1954 [14:38<00:00,  2.22it/s]
07/17/2024 10:33:56 - INFO - mingpt.trainer_atari - train loss: 1.006191
target return: 950, eval return: 3483
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 99/1954 [01:00<18:53,  1.64it/s]  5%|▌         | 99/1954 [01:14<18:53,  1.64it/s] 10%|█         | 199/1954 [02:01<17:46,  1.65it/s] 10%|█         | 199/1954 [02:14<17:46,  1.65it/s] 16%|█▌        | 314/1954 [03:01<15:29,  1.76it/s] 16%|█▌        | 314/1954 [03:14<15:29,  1.76it/s] 22%|██▏       | 430/1954 [04:01<13:52,  1.83it/s] 22%|██▏       | 430/1954 [04:14<13:52,  1.83it/s] 28%|██▊       | 546/1954 [05:01<12:34,  1.87it/s] 28%|██▊       | 546/1954 [05:15<12:34,  1.87it/s] 34%|███▍      | 662/1954 [06:01<11:24,  1.89it/s] 34%|███▍      | 662/1954 [06:15<11:24,  1.89it/s] 40%|███▉      | 778/1954 [07:01<10:18,  1.90it/s] 40%|███▉      | 778/1954 [07:15<10:18,  1.90it/s] 46%|████▌     | 894/1954 [08:01<09:15,  1.91it/s] 46%|████▌     | 894/1954 [08:15<09:15,  1.91it/s] 52%|█████▏    | 1010/1954 [09:02<08:12,  1.92it/s] 52%|█████▏    | 1010/1954 [09:15<08:12,  1.92it/s] 58%|█████▊    | 1127/1954 [10:02<07:10,  1.92it/s] 58%|█████▊    | 1127/1954 [10:15<07:10,  1.92it/s] 64%|██████▎   | 1243/1954 [11:03<06:10,  1.92it/s] 64%|██████▎   | 1243/1954 [11:15<06:10,  1.92it/s] 70%|██████▉   | 1360/1954 [12:03<05:08,  1.92it/s] 70%|██████▉   | 1360/1954 [12:15<05:08,  1.92it/s] 76%|███████▌  | 1476/1954 [13:03<04:08,  1.93it/s] 76%|███████▌  | 1476/1954 [13:15<04:08,  1.93it/s] 81%|████████▏ | 1592/1954 [14:03<03:07,  1.93it/s] 81%|████████▏ | 1592/1954 [14:15<03:07,  1.93it/s] 87%|████████▋ | 1708/1954 [15:04<02:07,  1.93it/s] 87%|████████▋ | 1708/1954 [15:15<02:07,  1.93it/s] 93%|█████████▎| 1824/1954 [16:04<01:07,  1.93it/s] 93%|█████████▎| 1824/1954 [16:15<01:07,  1.93it/s] 99%|█████████▉| 1941/1954 [17:04<00:06,  1.93it/s]100%|██████████| 1954/1954 [17:11<00:00,  1.90it/s]
07/17/2024 10:51:46 - INFO - mingpt.trainer_atari - train loss: 0.972081
target return: 950, eval return: 6056
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 130/1954 [01:00<14:06,  2.15it/s]  7%|▋         | 130/1954 [01:14<14:06,  2.15it/s] 13%|█▎        | 261/1954 [02:00<13:01,  2.17it/s] 13%|█▎        | 261/1954 [02:14<13:01,  2.17it/s] 20%|██        | 393/1954 [03:00<11:57,  2.18it/s] 20%|██        | 393/1954 [03:14<11:57,  2.18it/s] 27%|██▋       | 524/1954 [04:01<10:57,  2.17it/s] 27%|██▋       | 524/1954 [04:14<10:57,  2.17it/s] 34%|███▎      | 656/1954 [05:01<09:55,  2.18it/s] 34%|███▎      | 656/1954 [05:14<09:55,  2.18it/s] 40%|████      | 788/1954 [06:01<08:54,  2.18it/s] 40%|████      | 788/1954 [06:14<08:54,  2.18it/s] 47%|████▋     | 919/1954 [07:01<07:54,  2.18it/s] 47%|████▋     | 919/1954 [07:14<07:54,  2.18it/s] 54%|█████▍    | 1051/1954 [08:02<06:53,  2.18it/s] 54%|█████▍    | 1051/1954 [08:14<06:53,  2.18it/s] 61%|██████    | 1183/1954 [09:02<05:52,  2.19it/s] 61%|██████    | 1183/1954 [09:14<05:52,  2.19it/s] 67%|██████▋   | 1314/1954 [10:02<04:53,  2.18it/s] 67%|██████▋   | 1314/1954 [10:14<04:53,  2.18it/s] 74%|███████▍  | 1445/1954 [11:02<03:53,  2.18it/s] 74%|███████▍  | 1445/1954 [11:14<03:53,  2.18it/s] 81%|████████  | 1576/1954 [12:02<02:53,  2.18it/s] 81%|████████  | 1576/1954 [12:14<02:53,  2.18it/s] 87%|████████▋ | 1707/1954 [13:03<01:53,  2.18it/s] 87%|████████▋ | 1707/1954 [13:14<01:53,  2.18it/s] 94%|█████████▍| 1838/1954 [14:03<00:53,  2.18it/s] 94%|█████████▍| 1838/1954 [14:14<00:53,  2.18it/s]100%|██████████| 1954/1954 [14:56<00:00,  2.18it/s]
07/17/2024 11:07:22 - INFO - mingpt.trainer_atari - train loss: 0.943572
target return: 950, eval return: 5533
CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 2
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-18 08:04:11.137249: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 08:04:11.883233: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 08:04:16.188863: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▍        | 74749/500000 [01:00<05:45, 1229.97it/s] 20%|█▉        | 99571/500000 [01:19<05:25, 1229.97it/s] 32%|███▏      | 161073/500000 [02:02<04:13, 1335.00it/s] 38%|███▊      | 188310/500000 [02:19<03:53, 1335.00it/s] 49%|████▉     | 246191/500000 [03:03<03:06, 1363.08it/s] 54%|█████▍    | 270833/500000 [03:20<02:48, 1363.08it/s] 65%|██████▌   | 325624/500000 [04:03<02:09, 1347.03it/s] 71%|███████   | 352922/500000 [04:20<01:49, 1347.03it/s] 84%|████████▍ | 420514/500000 [05:03<00:55, 1431.00it/s] 91%|█████████▏| 457354/500000 [05:20<00:29, 1431.00it/s]100%|██████████| 500000/500000 [05:53<00:00, 1412.95it/s]
07/18/2024 08:10:57 - INFO - mingpt.model_atari - number of parameters: 1625216
this buffer has 2670 loaded transitions and there are now 500000 transitions total divided into 343 trajectories
max rtg is 189
max timestep is 3349
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 123/1954 [01:00<14:57,  2.04it/s]  6%|▋         | 123/1954 [01:18<14:57,  2.04it/s] 13%|█▎        | 255/1954 [02:00<13:19,  2.12it/s] 13%|█▎        | 255/1954 [02:18<13:19,  2.12it/s] 20%|█▉        | 386/1954 [03:00<12:09,  2.15it/s] 20%|█▉        | 386/1954 [03:18<12:09,  2.15it/s] 27%|██▋       | 518/1954 [04:01<11:03,  2.16it/s] 27%|██▋       | 518/1954 [04:18<11:03,  2.16it/s] 33%|███▎      | 649/1954 [05:01<10:01,  2.17it/s] 33%|███▎      | 649/1954 [05:18<10:01,  2.17it/s] 40%|███▉      | 781/1954 [06:01<08:58,  2.18it/s] 40%|███▉      | 781/1954 [06:18<08:58,  2.18it/s] 47%|████▋     | 914/1954 [07:01<07:55,  2.19it/s] 47%|████▋     | 914/1954 [07:18<07:55,  2.19it/s] 54%|█████▎    | 1046/1954 [08:01<06:54,  2.19it/s] 54%|█████▎    | 1046/1954 [08:18<06:54,  2.19it/s] 60%|██████    | 1178/1954 [09:02<05:54,  2.19it/s] 60%|██████    | 1178/1954 [09:18<05:54,  2.19it/s] 67%|██████▋   | 1310/1954 [10:02<04:53,  2.19it/s] 67%|██████▋   | 1310/1954 [10:18<04:53,  2.19it/s] 74%|███████▎  | 1441/1954 [11:02<03:54,  2.19it/s] 74%|███████▎  | 1441/1954 [11:18<03:54,  2.19it/s] 80%|████████  | 1572/1954 [12:02<02:54,  2.18it/s] 80%|████████  | 1572/1954 [12:18<02:54,  2.18it/s] 87%|████████▋ | 1703/1954 [13:02<01:54,  2.18it/s] 87%|████████▋ | 1703/1954 [13:18<01:54,  2.18it/s] 94%|█████████▍| 1834/1954 [14:02<00:54,  2.18it/s] 94%|█████████▍| 1834/1954 [14:18<00:54,  2.18it/s]100%|██████████| 1954/1954 [14:57<00:00,  2.18it/s]
07/18/2024 08:26:16 - INFO - mingpt.trainer_atari - train loss: 1.158527
target return: 950, eval return: 4599
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 130/1954 [01:00<14:04,  2.16it/s]  7%|▋         | 130/1954 [01:19<14:04,  2.16it/s] 13%|█▎        | 263/1954 [02:00<12:53,  2.19it/s] 13%|█▎        | 263/1954 [02:19<12:53,  2.19it/s] 20%|██        | 396/1954 [03:00<11:48,  2.20it/s] 20%|██        | 396/1954 [03:19<11:48,  2.20it/s] 27%|██▋       | 529/1954 [04:00<10:47,  2.20it/s] 27%|██▋       | 529/1954 [04:19<10:47,  2.20it/s] 34%|███▍      | 661/1954 [05:01<09:49,  2.19it/s] 34%|███▍      | 661/1954 [05:19<09:49,  2.19it/s] 41%|████      | 793/1954 [06:01<08:49,  2.19it/s] 41%|████      | 793/1954 [06:19<08:49,  2.19it/s] 47%|████▋     | 926/1954 [07:02<07:48,  2.19it/s] 47%|████▋     | 926/1954 [07:19<07:48,  2.19it/s] 54%|█████▍    | 1058/1954 [08:02<06:48,  2.19it/s] 54%|█████▍    | 1058/1954 [08:19<06:48,  2.19it/s] 61%|██████    | 1189/1954 [09:02<05:49,  2.19it/s] 61%|██████    | 1189/1954 [09:19<05:49,  2.19it/s] 68%|██████▊   | 1321/1954 [10:03<04:49,  2.19it/s] 68%|██████▊   | 1321/1954 [10:19<04:49,  2.19it/s] 74%|███████▍  | 1453/1954 [11:03<03:48,  2.19it/s] 74%|███████▍  | 1453/1954 [11:19<03:48,  2.19it/s] 81%|████████  | 1585/1954 [12:03<02:48,  2.19it/s] 81%|████████  | 1585/1954 [12:19<02:48,  2.19it/s] 88%|████████▊ | 1717/1954 [13:03<01:48,  2.19it/s] 88%|████████▊ | 1717/1954 [13:19<01:48,  2.19it/s] 95%|█████████▍| 1850/1954 [14:03<00:47,  2.20it/s] 95%|█████████▍| 1850/1954 [14:19<00:47,  2.20it/s]100%|██████████| 1954/1954 [14:51<00:00,  2.19it/s]
07/18/2024 08:41:48 - INFO - mingpt.trainer_atari - train loss: 1.076186
target return: 950, eval return: 6177
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 128/1954 [01:00<14:21,  2.12it/s]  7%|▋         | 128/1954 [01:12<14:21,  2.12it/s] 13%|█▎        | 257/1954 [02:00<13:15,  2.13it/s] 13%|█▎        | 257/1954 [02:12<13:15,  2.13it/s] 20%|█▉        | 385/1954 [03:00<12:15,  2.13it/s] 20%|█▉        | 385/1954 [03:12<12:15,  2.13it/s] 26%|██▋       | 514/1954 [04:00<11:13,  2.14it/s] 26%|██▋       | 514/1954 [04:12<11:13,  2.14it/s] 33%|███▎      | 644/1954 [05:00<10:10,  2.14it/s] 33%|███▎      | 644/1954 [05:12<10:10,  2.14it/s] 40%|███▉      | 774/1954 [06:01<09:08,  2.15it/s] 40%|███▉      | 774/1954 [06:12<09:08,  2.15it/s] 46%|████▋     | 904/1954 [07:01<08:07,  2.16it/s] 46%|████▋     | 904/1954 [07:12<08:07,  2.16it/s] 53%|█████▎    | 1035/1954 [08:01<07:05,  2.16it/s] 53%|█████▎    | 1035/1954 [08:12<07:05,  2.16it/s] 60%|█████▉    | 1166/1954 [09:01<06:04,  2.16it/s] 60%|█████▉    | 1166/1954 [09:12<06:04,  2.16it/s] 66%|██████▋   | 1296/1954 [10:02<05:04,  2.16it/s] 66%|██████▋   | 1296/1954 [10:12<05:04,  2.16it/s] 73%|███████▎  | 1425/1954 [11:02<04:05,  2.16it/s] 73%|███████▎  | 1425/1954 [11:12<04:05,  2.16it/s] 80%|███████▉  | 1554/1954 [12:02<03:05,  2.15it/s] 80%|███████▉  | 1554/1954 [12:22<03:05,  2.15it/s] 86%|████████▌ | 1684/1954 [13:02<02:05,  2.15it/s] 86%|████████▌ | 1684/1954 [13:22<02:05,  2.15it/s] 93%|█████████▎| 1813/1954 [14:02<01:05,  2.15it/s] 93%|█████████▎| 1813/1954 [14:22<01:05,  2.15it/s] 99%|█████████▉| 1943/1954 [15:03<00:05,  2.15it/s]100%|██████████| 1954/1954 [15:07<00:00,  2.15it/s]
07/18/2024 08:57:42 - INFO - mingpt.trainer_atari - train loss: 1.040504
target return: 950, eval return: 5653
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:27,  2.11it/s]  6%|▋         | 127/1954 [01:19<14:27,  2.11it/s] 13%|█▎        | 253/1954 [02:00<13:29,  2.10it/s] 13%|█▎        | 253/1954 [02:19<13:29,  2.10it/s] 19%|█▉        | 380/1954 [03:00<12:27,  2.11it/s] 19%|█▉        | 380/1954 [03:19<12:27,  2.11it/s] 26%|██▌       | 507/1954 [04:00<11:27,  2.10it/s] 26%|██▌       | 507/1954 [04:19<11:27,  2.10it/s] 32%|███▏      | 634/1954 [05:01<10:26,  2.11it/s] 32%|███▏      | 634/1954 [05:20<10:26,  2.11it/s] 39%|███▉      | 762/1954 [06:01<09:24,  2.11it/s] 39%|███▉      | 762/1954 [06:20<09:24,  2.11it/s] 45%|████▌     | 889/1954 [07:01<08:24,  2.11it/s] 45%|████▌     | 889/1954 [07:20<08:24,  2.11it/s] 52%|█████▏    | 1016/1954 [08:01<07:24,  2.11it/s] 52%|█████▏    | 1016/1954 [08:20<07:24,  2.11it/s] 58%|█████▊    | 1143/1954 [09:01<06:23,  2.11it/s] 58%|█████▊    | 1143/1954 [09:20<06:23,  2.11it/s] 65%|██████▍   | 1269/1954 [10:02<05:25,  2.11it/s] 65%|██████▍   | 1269/1954 [10:20<05:25,  2.11it/s] 71%|███████▏  | 1396/1954 [11:02<04:24,  2.11it/s] 71%|███████▏  | 1396/1954 [11:20<04:24,  2.11it/s] 78%|███████▊  | 1524/1954 [12:02<03:23,  2.11it/s] 78%|███████▊  | 1524/1954 [12:20<03:23,  2.11it/s] 85%|████████▍ | 1653/1954 [13:02<02:21,  2.12it/s] 85%|████████▍ | 1653/1954 [13:20<02:21,  2.12it/s] 91%|█████████ | 1781/1954 [14:03<01:21,  2.12it/s] 91%|█████████ | 1781/1954 [14:20<01:21,  2.12it/s] 98%|█████████▊| 1909/1954 [15:03<00:21,  2.12it/s] 98%|█████████▊| 1909/1954 [15:20<00:21,  2.12it/s]100%|██████████| 1954/1954 [15:24<00:00,  2.11it/s]
07/18/2024 09:14:01 - INFO - mingpt.trainer_atari - train loss: 1.008416
target return: 950, eval return: 6409
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 115/1954 [01:00<16:02,  1.91it/s]  6%|▌         | 115/1954 [01:11<16:02,  1.91it/s] 12%|█▏        | 230/1954 [02:00<15:04,  1.91it/s] 12%|█▏        | 230/1954 [02:11<15:04,  1.91it/s] 18%|█▊        | 345/1954 [03:00<14:04,  1.91it/s] 18%|█▊        | 345/1954 [03:11<14:04,  1.91it/s] 24%|██▎       | 460/1954 [04:01<13:03,  1.91it/s] 24%|██▎       | 460/1954 [04:11<13:03,  1.91it/s] 29%|██▉       | 576/1954 [05:01<12:01,  1.91it/s] 29%|██▉       | 576/1954 [05:21<12:01,  1.91it/s] 35%|███▌      | 691/1954 [06:01<11:01,  1.91it/s] 35%|███▌      | 691/1954 [06:21<11:01,  1.91it/s] 41%|████▏     | 807/1954 [07:02<09:58,  1.92it/s] 41%|████▏     | 807/1954 [07:21<09:58,  1.92it/s] 47%|████▋     | 923/1954 [08:02<08:57,  1.92it/s] 47%|████▋     | 923/1954 [08:21<08:57,  1.92it/s] 53%|█████▎    | 1038/1954 [09:02<07:57,  1.92it/s] 53%|█████▎    | 1038/1954 [09:21<07:57,  1.92it/s] 59%|█████▉    | 1154/1954 [10:02<06:57,  1.92it/s] 59%|█████▉    | 1154/1954 [10:21<06:57,  1.92it/s] 65%|██████▍   | 1269/1954 [11:03<05:57,  1.92it/s] 65%|██████▍   | 1269/1954 [11:21<05:57,  1.92it/s] 71%|███████   | 1385/1954 [12:03<04:56,  1.92it/s] 71%|███████   | 1385/1954 [12:21<04:56,  1.92it/s] 77%|███████▋  | 1501/1954 [13:04<03:56,  1.92it/s] 77%|███████▋  | 1501/1954 [13:21<03:56,  1.92it/s] 83%|████████▎ | 1616/1954 [14:04<02:56,  1.91it/s] 83%|████████▎ | 1616/1954 [14:21<02:56,  1.91it/s] 89%|████████▊ | 1731/1954 [15:04<01:56,  1.91it/s] 89%|████████▊ | 1731/1954 [15:21<01:56,  1.91it/s] 95%|█████████▍| 1847/1954 [16:04<00:55,  1.92it/s] 95%|█████████▍| 1847/1954 [16:21<00:55,  1.92it/s]100%|██████████| 1954/1954 [17:01<00:00,  1.91it/s]
07/18/2024 09:31:46 - INFO - mingpt.trainer_atari - train loss: 0.982217
target return: 950, eval return: 5684
2024-07-18 09:32:44.421462: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 09:32:45.191467: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 09:32:49.351951: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 13%|█▎        | 66782/500000 [01:00<06:30, 1108.86it/s] 20%|█▉        | 99600/500000 [01:20<06:01, 1108.86it/s] 30%|███       | 152378/500000 [02:00<04:29, 1289.90it/s] 35%|███▌      | 177443/500000 [02:20<04:10, 1289.90it/s] 46%|████▋     | 232390/500000 [03:00<03:24, 1309.76it/s] 51%|█████     | 253241/500000 [03:20<03:08, 1309.76it/s] 62%|██████▏   | 309120/500000 [04:00<02:27, 1297.57it/s] 67%|██████▋   | 333063/500000 [04:20<02:08, 1297.57it/s] 78%|███████▊  | 390305/500000 [05:08<01:27, 1257.10it/s] 83%|████████▎ | 414916/500000 [05:20<01:07, 1257.10it/s] 96%|█████████▌| 480825/500000 [06:08<00:14, 1339.93it/s]100%|██████████| 500000/500000 [06:19<00:00, 1317.90it/s]
07/18/2024 09:39:49 - INFO - mingpt.model_atari - number of parameters: 1628288
this buffer has 20956 loaded transitions and there are now 500000 transitions total divided into 377 trajectories
max rtg is 189
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 126/1954 [01:00<14:32,  2.10it/s]  6%|▋         | 126/1954 [01:19<14:32,  2.10it/s] 13%|█▎        | 258/1954 [02:00<13:09,  2.15it/s] 13%|█▎        | 258/1954 [02:19<13:09,  2.15it/s] 20%|█▉        | 390/1954 [03:00<12:00,  2.17it/s] 20%|█▉        | 390/1954 [03:19<12:00,  2.17it/s] 27%|██▋       | 523/1954 [04:00<10:55,  2.18it/s] 27%|██▋       | 523/1954 [04:19<10:55,  2.18it/s] 34%|███▎      | 656/1954 [05:01<09:51,  2.19it/s] 34%|███▎      | 656/1954 [05:19<09:51,  2.19it/s] 40%|████      | 790/1954 [06:01<08:48,  2.20it/s] 40%|████      | 790/1954 [06:19<08:48,  2.20it/s] 47%|████▋     | 923/1954 [07:01<07:47,  2.21it/s] 47%|████▋     | 923/1954 [07:19<07:47,  2.21it/s] 54%|█████▍    | 1057/1954 [08:02<06:45,  2.21it/s] 54%|█████▍    | 1057/1954 [08:19<06:45,  2.21it/s] 61%|██████    | 1191/1954 [09:02<05:44,  2.21it/s] 61%|██████    | 1191/1954 [09:19<05:44,  2.21it/s] 68%|██████▊   | 1322/1954 [10:02<04:46,  2.20it/s] 68%|██████▊   | 1322/1954 [10:19<04:46,  2.20it/s] 74%|███████▍  | 1455/1954 [11:02<03:46,  2.21it/s] 74%|███████▍  | 1455/1954 [11:19<03:46,  2.21it/s] 81%|████████▏ | 1589/1954 [12:02<02:45,  2.21it/s] 81%|████████▏ | 1589/1954 [12:19<02:45,  2.21it/s] 88%|████████▊ | 1723/1954 [13:03<01:44,  2.22it/s] 88%|████████▊ | 1723/1954 [13:19<01:44,  2.22it/s] 95%|█████████▍| 1856/1954 [14:03<00:44,  2.21it/s] 95%|█████████▍| 1856/1954 [14:19<00:44,  2.21it/s]100%|██████████| 1954/1954 [14:47<00:00,  2.20it/s]
07/18/2024 09:54:56 - INFO - mingpt.trainer_atari - train loss: 1.132802
target return: 950, eval return: 6023
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 116/1954 [01:00<15:56,  1.92it/s]  6%|▌         | 116/1954 [01:13<15:56,  1.92it/s] 12%|█▏        | 232/1954 [02:00<14:53,  1.93it/s] 12%|█▏        | 232/1954 [02:13<14:53,  1.93it/s] 18%|█▊        | 349/1954 [03:00<13:49,  1.94it/s] 18%|█▊        | 349/1954 [03:13<13:49,  1.94it/s] 24%|██▍       | 466/1954 [04:00<12:47,  1.94it/s] 24%|██▍       | 466/1954 [04:13<12:47,  1.94it/s] 30%|██▉       | 583/1954 [05:00<11:46,  1.94it/s] 30%|██▉       | 583/1954 [05:13<11:46,  1.94it/s] 36%|███▌      | 700/1954 [06:01<10:46,  1.94it/s] 36%|███▌      | 700/1954 [06:13<10:46,  1.94it/s] 42%|████▏     | 817/1954 [07:01<09:45,  1.94it/s] 42%|████▏     | 817/1954 [07:13<09:45,  1.94it/s] 48%|████▊     | 934/1954 [08:01<08:45,  1.94it/s] 48%|████▊     | 934/1954 [08:13<08:45,  1.94it/s] 54%|█████▎    | 1050/1954 [09:01<07:46,  1.94it/s] 54%|█████▎    | 1050/1954 [09:13<07:46,  1.94it/s] 60%|█████▉    | 1166/1954 [10:01<06:47,  1.93it/s] 60%|█████▉    | 1166/1954 [10:13<06:47,  1.93it/s] 66%|██████▌   | 1282/1954 [11:02<05:47,  1.93it/s] 66%|██████▌   | 1282/1954 [11:13<05:47,  1.93it/s] 72%|███████▏  | 1398/1954 [12:02<04:48,  1.93it/s] 72%|███████▏  | 1398/1954 [12:13<04:48,  1.93it/s] 77%|███████▋  | 1514/1954 [13:02<03:48,  1.93it/s] 77%|███████▋  | 1514/1954 [13:13<03:48,  1.93it/s] 83%|████████▎ | 1630/1954 [14:03<02:48,  1.93it/s] 83%|████████▎ | 1630/1954 [14:13<02:48,  1.93it/s] 89%|████████▉ | 1746/1954 [15:03<01:47,  1.93it/s] 89%|████████▉ | 1746/1954 [15:13<01:47,  1.93it/s] 95%|█████████▌| 1863/1954 [16:03<00:47,  1.93it/s] 95%|█████████▌| 1863/1954 [16:13<00:47,  1.93it/s]100%|██████████| 1954/1954 [16:50<00:00,  1.93it/s]
07/18/2024 10:12:45 - INFO - mingpt.trainer_atari - train loss: 1.048742
target return: 950, eval return: 6108
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 111/1954 [01:00<16:40,  1.84it/s]  6%|▌         | 111/1954 [01:16<16:40,  1.84it/s] 11%|█▏        | 223/1954 [02:00<15:33,  1.85it/s] 11%|█▏        | 223/1954 [02:16<15:33,  1.85it/s] 17%|█▋        | 336/1954 [03:00<14:29,  1.86it/s] 17%|█▋        | 336/1954 [03:16<14:29,  1.86it/s] 23%|██▎       | 449/1954 [04:01<13:27,  1.86it/s] 23%|██▎       | 449/1954 [04:16<13:27,  1.86it/s] 29%|██▉       | 562/1954 [05:01<12:24,  1.87it/s] 29%|██▉       | 562/1954 [05:16<12:24,  1.87it/s] 35%|███▍      | 675/1954 [06:01<11:23,  1.87it/s] 35%|███▍      | 675/1954 [06:16<11:23,  1.87it/s] 40%|████      | 788/1954 [07:02<10:23,  1.87it/s] 40%|████      | 788/1954 [07:16<10:23,  1.87it/s] 46%|████▌     | 901/1954 [08:02<09:22,  1.87it/s] 46%|████▌     | 901/1954 [08:16<09:22,  1.87it/s] 52%|█████▏    | 1014/1954 [09:03<08:22,  1.87it/s] 52%|█████▏    | 1014/1954 [09:16<08:22,  1.87it/s] 58%|█████▊    | 1126/1954 [10:03<07:23,  1.87it/s] 58%|█████▊    | 1126/1954 [10:17<07:23,  1.87it/s] 63%|██████▎   | 1239/1954 [11:03<06:22,  1.87it/s] 63%|██████▎   | 1239/1954 [11:17<06:22,  1.87it/s] 69%|██████▉   | 1350/1954 [12:03<05:24,  1.86it/s] 69%|██████▉   | 1350/1954 [12:17<05:24,  1.86it/s] 75%|███████▍  | 1462/1954 [13:04<04:24,  1.86it/s] 75%|███████▍  | 1462/1954 [13:17<04:24,  1.86it/s] 81%|████████  | 1574/1954 [14:04<03:24,  1.86it/s] 81%|████████  | 1574/1954 [14:17<03:24,  1.86it/s] 86%|████████▌ | 1685/1954 [15:04<02:25,  1.85it/s] 86%|████████▌ | 1685/1954 [15:17<02:25,  1.85it/s] 92%|█████████▏| 1797/1954 [16:05<01:24,  1.85it/s] 92%|█████████▏| 1797/1954 [16:17<01:24,  1.85it/s] 98%|█████████▊| 1909/1954 [17:05<00:24,  1.86it/s] 98%|█████████▊| 1909/1954 [17:17<00:24,  1.86it/s]100%|██████████| 1954/1954 [17:29<00:00,  1.86it/s]
07/18/2024 10:31:51 - INFO - mingpt.trainer_atari - train loss: 1.012787
target return: 950, eval return: 6279
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 98/1954 [01:00<19:11,  1.61it/s]  5%|▌         | 98/1954 [01:13<19:11,  1.61it/s] 10%|█         | 196/1954 [02:01<18:07,  1.62it/s] 10%|█         | 196/1954 [02:13<18:07,  1.62it/s] 15%|█▌        | 294/1954 [03:01<17:05,  1.62it/s] 15%|█▌        | 294/1954 [03:13<17:05,  1.62it/s] 20%|██        | 392/1954 [04:02<16:04,  1.62it/s] 20%|██        | 392/1954 [04:13<16:04,  1.62it/s] 25%|██▌       | 490/1954 [05:02<15:02,  1.62it/s] 25%|██▌       | 490/1954 [05:13<15:02,  1.62it/s] 30%|███       | 588/1954 [06:02<14:02,  1.62it/s] 30%|███       | 588/1954 [06:13<14:02,  1.62it/s] 35%|███▌      | 687/1954 [07:03<12:58,  1.63it/s] 35%|███▌      | 687/1954 [07:14<12:58,  1.63it/s] 40%|████      | 786/1954 [08:03<11:55,  1.63it/s] 40%|████      | 786/1954 [08:14<11:55,  1.63it/s] 45%|████▌     | 885/1954 [09:03<10:54,  1.63it/s] 45%|████▌     | 885/1954 [09:14<10:54,  1.63it/s] 50%|█████     | 984/1954 [10:04<09:52,  1.64it/s] 50%|█████     | 984/1954 [10:14<09:52,  1.64it/s] 55%|█████▌    | 1082/1954 [11:04<08:53,  1.63it/s] 55%|█████▌    | 1082/1954 [11:24<08:53,  1.63it/s] 60%|██████    | 1180/1954 [12:04<07:54,  1.63it/s] 60%|██████    | 1180/1954 [12:24<07:54,  1.63it/s] 65%|██████▌   | 1278/1954 [13:05<06:55,  1.63it/s] 65%|██████▌   | 1278/1954 [13:24<06:55,  1.63it/s] 70%|███████   | 1376/1954 [14:05<05:55,  1.63it/s] 70%|███████   | 1376/1954 [14:24<05:55,  1.63it/s] 75%|███████▌  | 1474/1954 [15:05<04:55,  1.63it/s] 75%|███████▌  | 1474/1954 [15:24<04:55,  1.63it/s] 80%|████████  | 1571/1954 [16:06<03:56,  1.62it/s] 80%|████████  | 1571/1954 [16:24<03:56,  1.62it/s] 85%|████████▌ | 1668/1954 [17:06<02:56,  1.62it/s] 85%|████████▌ | 1668/1954 [17:24<02:56,  1.62it/s] 90%|█████████ | 1765/1954 [18:06<01:56,  1.62it/s] 90%|█████████ | 1765/1954 [18:24<01:56,  1.62it/s] 95%|█████████▌| 1862/1954 [19:06<00:56,  1.62it/s] 95%|█████████▌| 1862/1954 [19:24<00:56,  1.62it/s]100%|██████████| 1954/1954 [20:02<00:00,  1.62it/s]
07/18/2024 10:53:08 - INFO - mingpt.trainer_atari - train loss: 0.981679
target return: 950, eval return: 5660
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 124/1954 [01:00<14:51,  2.05it/s]  6%|▋         | 124/1954 [01:16<14:51,  2.05it/s] 13%|█▎        | 249/1954 [02:00<13:46,  2.06it/s] 13%|█▎        | 249/1954 [02:16<13:46,  2.06it/s] 19%|█▉        | 374/1954 [03:01<12:43,  2.07it/s] 19%|█▉        | 374/1954 [03:16<12:43,  2.07it/s] 26%|██▌       | 499/1954 [04:01<11:41,  2.07it/s] 26%|██▌       | 499/1954 [04:16<11:41,  2.07it/s] 32%|███▏      | 626/1954 [05:01<10:37,  2.08it/s] 32%|███▏      | 626/1954 [05:16<10:37,  2.08it/s] 38%|███▊      | 752/1954 [06:01<09:36,  2.09it/s] 38%|███▊      | 752/1954 [06:16<09:36,  2.09it/s] 45%|████▍     | 878/1954 [07:02<08:35,  2.09it/s] 45%|████▍     | 878/1954 [07:16<08:35,  2.09it/s] 51%|█████▏    | 1004/1954 [08:02<07:35,  2.09it/s] 51%|█████▏    | 1004/1954 [08:16<07:35,  2.09it/s] 58%|█████▊    | 1129/1954 [09:02<06:35,  2.08it/s] 58%|█████▊    | 1129/1954 [09:16<06:35,  2.08it/s] 64%|██████▍   | 1255/1954 [10:03<05:35,  2.08it/s] 64%|██████▍   | 1255/1954 [10:16<05:35,  2.08it/s] 71%|███████   | 1381/1954 [11:03<04:34,  2.08it/s] 71%|███████   | 1381/1954 [11:16<04:34,  2.08it/s] 77%|███████▋  | 1505/1954 [12:03<03:36,  2.08it/s] 77%|███████▋  | 1505/1954 [12:16<03:36,  2.08it/s] 83%|████████▎ | 1631/1954 [13:04<02:35,  2.08it/s] 83%|████████▎ | 1631/1954 [13:16<02:35,  2.08it/s] 90%|████████▉ | 1756/1954 [14:04<01:35,  2.08it/s] 90%|████████▉ | 1756/1954 [14:16<01:35,  2.08it/s] 96%|█████████▋| 1881/1954 [15:04<00:35,  2.08it/s] 96%|█████████▋| 1881/1954 [15:16<00:35,  2.08it/s]100%|██████████| 1954/1954 [15:38<00:00,  2.08it/s]
07/18/2024 11:09:32 - INFO - mingpt.trainer_atari - train loss: 0.955706
target return: 950, eval return: 7782
2024-07-18 11:10:29.341039: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 11:10:30.060046: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 11:10:34.218514: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 14%|█▍        | 70148/500000 [01:00<06:13, 1152.16it/s] 19%|█▉        | 95823/500000 [01:20<05:50, 1152.16it/s] 30%|██▉       | 147691/500000 [02:00<04:45, 1234.15it/s] 34%|███▍      | 171933/500000 [02:20<04:25, 1234.15it/s] 46%|████▌     | 229130/500000 [03:00<03:29, 1290.20it/s] 50%|█████     | 250616/500000 [03:20<03:13, 1290.20it/s] 62%|██████▏   | 310989/500000 [04:00<02:23, 1319.40it/s] 67%|██████▋   | 333416/500000 [04:20<02:06, 1319.40it/s] 78%|███████▊  | 388143/500000 [05:00<01:25, 1307.34it/s] 83%|████████▎ | 414972/500000 [05:20<01:05, 1307.34it/s] 95%|█████████▌| 475410/500000 [06:08<00:18, 1299.30it/s] 99%|█████████▉| 496700/500000 [06:20<00:02, 1299.30it/s]100%|██████████| 500000/500000 [06:20<00:00, 1314.13it/s]
07/18/2024 11:17:36 - INFO - mingpt.model_atari - number of parameters: 1628288
this buffer has 4270 loaded transitions and there are now 500000 transitions total divided into 373 trajectories
max rtg is 187
max timestep is 3373
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 121/1954 [01:00<15:10,  2.01it/s]  6%|▌         | 121/1954 [01:16<15:10,  2.01it/s] 13%|█▎        | 248/1954 [02:00<13:44,  2.07it/s] 13%|█▎        | 248/1954 [02:16<13:44,  2.07it/s] 19%|█▉        | 376/1954 [03:00<12:34,  2.09it/s] 19%|█▉        | 376/1954 [03:16<12:34,  2.09it/s] 26%|██▌       | 504/1954 [04:01<11:29,  2.10it/s] 26%|██▌       | 504/1954 [04:16<11:29,  2.10it/s] 32%|███▏      | 631/1954 [05:01<10:29,  2.10it/s] 32%|███▏      | 631/1954 [05:16<10:29,  2.10it/s] 39%|███▉      | 759/1954 [06:01<09:26,  2.11it/s] 39%|███▉      | 759/1954 [06:16<09:26,  2.11it/s] 45%|████▌     | 886/1954 [07:01<08:26,  2.11it/s] 45%|████▌     | 886/1954 [07:16<08:26,  2.11it/s] 52%|█████▏    | 1013/1954 [08:02<07:25,  2.11it/s] 52%|█████▏    | 1013/1954 [08:16<07:25,  2.11it/s] 58%|█████▊    | 1140/1954 [09:02<06:25,  2.11it/s] 58%|█████▊    | 1140/1954 [09:16<06:25,  2.11it/s] 65%|██████▍   | 1267/1954 [10:02<05:25,  2.11it/s] 65%|██████▍   | 1267/1954 [10:16<05:25,  2.11it/s] 71%|███████▏  | 1394/1954 [11:02<04:25,  2.11it/s] 71%|███████▏  | 1394/1954 [11:16<04:25,  2.11it/s] 78%|███████▊  | 1521/1954 [12:02<03:25,  2.11it/s] 78%|███████▊  | 1521/1954 [12:16<03:25,  2.11it/s] 84%|████████▍ | 1648/1954 [13:03<02:25,  2.11it/s] 84%|████████▍ | 1648/1954 [13:16<02:25,  2.11it/s] 91%|█████████ | 1775/1954 [14:03<01:24,  2.11it/s] 91%|█████████ | 1775/1954 [14:16<01:24,  2.11it/s] 97%|█████████▋| 1902/1954 [15:04<00:24,  2.10it/s] 97%|█████████▋| 1902/1954 [15:16<00:24,  2.10it/s]100%|██████████| 1954/1954 [15:28<00:00,  2.10it/s]
07/18/2024 11:33:15 - INFO - mingpt.trainer_atari - train loss: 1.133443
target return: 950, eval return: 3647
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:36,  2.09it/s]  6%|▋         | 127/1954 [01:16<14:36,  2.09it/s] 13%|█▎        | 256/1954 [02:01<13:22,  2.11it/s] 13%|█▎        | 256/1954 [02:16<13:22,  2.11it/s] 20%|█▉        | 384/1954 [03:01<12:19,  2.12it/s] 20%|█▉        | 384/1954 [03:16<12:19,  2.12it/s] 26%|██▌       | 512/1954 [04:01<11:18,  2.13it/s] 26%|██▌       | 512/1954 [04:16<11:18,  2.13it/s] 33%|███▎      | 640/1954 [05:01<10:18,  2.12it/s] 33%|███▎      | 640/1954 [05:16<10:18,  2.12it/s] 39%|███▉      | 769/1954 [06:02<09:17,  2.13it/s] 39%|███▉      | 769/1954 [06:16<09:17,  2.13it/s] 46%|████▌     | 897/1954 [07:02<08:17,  2.13it/s] 46%|████▌     | 897/1954 [07:16<08:17,  2.13it/s] 52%|█████▏    | 1025/1954 [08:02<07:17,  2.13it/s] 52%|█████▏    | 1025/1954 [08:16<07:17,  2.13it/s] 59%|█████▉    | 1151/1954 [09:02<06:19,  2.12it/s] 59%|█████▉    | 1151/1954 [09:16<06:19,  2.12it/s] 65%|██████▌   | 1279/1954 [10:03<05:18,  2.12it/s] 65%|██████▌   | 1279/1954 [10:16<05:18,  2.12it/s] 72%|███████▏  | 1407/1954 [11:03<04:18,  2.12it/s] 72%|███████▏  | 1407/1954 [11:16<04:18,  2.12it/s] 79%|███████▊  | 1534/1954 [12:03<03:18,  2.12it/s] 79%|███████▊  | 1534/1954 [12:16<03:18,  2.12it/s] 85%|████████▍ | 1659/1954 [13:03<02:20,  2.11it/s] 85%|████████▍ | 1659/1954 [13:16<02:20,  2.11it/s] 91%|█████████▏| 1784/1954 [14:03<01:21,  2.10it/s] 91%|█████████▏| 1784/1954 [14:16<01:21,  2.10it/s] 98%|█████████▊| 1910/1954 [15:04<00:21,  2.09it/s] 98%|█████████▊| 1910/1954 [15:16<00:21,  2.09it/s]100%|██████████| 1954/1954 [15:25<00:00,  2.11it/s]
07/18/2024 11:49:21 - INFO - mingpt.trainer_atari - train loss: 1.045908
target return: 950, eval return: 4663
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 125/1954 [01:00<14:40,  2.08it/s]  6%|▋         | 125/1954 [01:19<14:40,  2.08it/s] 13%|█▎        | 251/1954 [02:00<13:35,  2.09it/s] 13%|█▎        | 251/1954 [02:19<13:35,  2.09it/s] 19%|█▉        | 377/1954 [03:00<12:34,  2.09it/s] 19%|█▉        | 377/1954 [03:19<12:34,  2.09it/s] 26%|██▌       | 504/1954 [04:00<11:31,  2.10it/s] 26%|██▌       | 504/1954 [04:19<11:31,  2.10it/s] 32%|███▏      | 631/1954 [05:00<10:29,  2.10it/s] 32%|███▏      | 631/1954 [05:19<10:29,  2.10it/s] 39%|███▊      | 757/1954 [06:01<09:30,  2.10it/s] 39%|███▊      | 757/1954 [06:19<09:30,  2.10it/s] 45%|████▌     | 883/1954 [07:01<08:31,  2.10it/s] 45%|████▌     | 883/1954 [07:19<08:31,  2.10it/s] 52%|█████▏    | 1010/1954 [08:01<07:30,  2.10it/s] 52%|█████▏    | 1010/1954 [08:19<07:30,  2.10it/s] 58%|█████▊    | 1135/1954 [09:01<06:31,  2.09it/s] 58%|█████▊    | 1135/1954 [09:19<06:31,  2.09it/s] 65%|██████▍   | 1261/1954 [10:02<05:31,  2.09it/s] 65%|██████▍   | 1261/1954 [10:19<05:31,  2.09it/s] 71%|███████   | 1387/1954 [11:02<04:31,  2.09it/s] 71%|███████   | 1387/1954 [11:19<04:31,  2.09it/s] 77%|███████▋  | 1512/1954 [12:02<03:31,  2.09it/s] 77%|███████▋  | 1512/1954 [12:19<03:31,  2.09it/s] 84%|████████▍ | 1638/1954 [13:02<02:31,  2.09it/s] 84%|████████▍ | 1638/1954 [13:19<02:31,  2.09it/s] 90%|█████████ | 1764/1954 [14:03<01:30,  2.09it/s] 90%|█████████ | 1764/1954 [14:19<01:30,  2.09it/s] 97%|█████████▋| 1890/1954 [15:03<00:30,  2.09it/s] 97%|█████████▋| 1890/1954 [15:19<00:30,  2.09it/s]100%|██████████| 1954/1954 [15:33<00:00,  2.09it/s]
07/18/2024 12:05:26 - INFO - mingpt.trainer_atari - train loss: 1.007678
target return: 950, eval return: 5540
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▍         | 97/1954 [01:00<19:13,  1.61it/s]  5%|▍         | 97/1954 [01:13<19:13,  1.61it/s] 10%|▉         | 194/1954 [02:00<18:10,  1.61it/s] 10%|▉         | 194/1954 [02:13<18:10,  1.61it/s] 15%|█▍        | 292/1954 [03:00<17:07,  1.62it/s] 15%|█▍        | 292/1954 [03:13<17:07,  1.62it/s] 20%|█▉        | 389/1954 [04:01<16:10,  1.61it/s] 20%|█▉        | 389/1954 [04:13<16:10,  1.61it/s] 25%|██▌       | 490/1954 [05:01<14:54,  1.64it/s] 25%|██▌       | 490/1954 [05:13<14:54,  1.64it/s] 30%|██▉       | 586/1954 [06:01<14:03,  1.62it/s] 30%|██▉       | 586/1954 [06:13<14:03,  1.62it/s] 35%|███▍      | 682/1954 [07:01<13:09,  1.61it/s] 35%|███▍      | 682/1954 [07:13<13:09,  1.61it/s] 40%|███▉      | 777/1954 [08:02<12:15,  1.60it/s] 40%|███▉      | 777/1954 [08:13<12:15,  1.60it/s] 45%|████▍     | 872/1954 [09:02<11:18,  1.59it/s] 45%|████▍     | 872/1954 [09:13<11:18,  1.59it/s] 49%|████▉     | 967/1954 [10:02<10:20,  1.59it/s] 49%|████▉     | 967/1954 [10:13<10:20,  1.59it/s] 54%|█████▍    | 1063/1954 [11:02<09:20,  1.59it/s] 54%|█████▍    | 1063/1954 [11:13<09:20,  1.59it/s] 60%|█████▉    | 1163/1954 [12:02<08:11,  1.61it/s] 60%|█████▉    | 1163/1954 [12:13<08:11,  1.61it/s] 64%|██████▍   | 1259/1954 [13:03<07:12,  1.61it/s] 64%|██████▍   | 1259/1954 [13:23<07:12,  1.61it/s] 69%|██████▉   | 1355/1954 [14:03<06:14,  1.60it/s] 69%|██████▉   | 1355/1954 [14:23<06:14,  1.60it/s] 74%|███████▍  | 1451/1954 [15:03<05:14,  1.60it/s] 74%|███████▍  | 1451/1954 [15:23<05:14,  1.60it/s] 79%|███████▉  | 1547/1954 [16:03<04:14,  1.60it/s] 79%|███████▉  | 1547/1954 [16:23<04:14,  1.60it/s] 84%|████████▍ | 1643/1954 [17:04<03:14,  1.60it/s] 84%|████████▍ | 1643/1954 [17:23<03:14,  1.60it/s] 89%|████████▉ | 1740/1954 [18:04<02:13,  1.60it/s] 89%|████████▉ | 1740/1954 [18:23<02:13,  1.60it/s] 94%|█████████▍| 1837/1954 [19:05<01:13,  1.60it/s] 94%|█████████▍| 1837/1954 [19:23<01:13,  1.60it/s] 99%|█████████▉| 1934/1954 [20:05<00:12,  1.60it/s]100%|██████████| 1954/1954 [20:17<00:00,  1.60it/s]
07/18/2024 12:26:18 - INFO - mingpt.trainer_atari - train loss: 0.974093
target return: 950, eval return: 4639
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▍         | 97/1954 [01:00<19:18,  1.60it/s]  5%|▍         | 97/1954 [01:11<19:18,  1.60it/s] 10%|▉         | 194/1954 [02:00<18:15,  1.61it/s] 10%|▉         | 194/1954 [02:11<18:15,  1.61it/s] 15%|█▍        | 291/1954 [03:01<17:15,  1.61it/s] 15%|█▍        | 291/1954 [03:11<17:15,  1.61it/s] 20%|█▉        | 388/1954 [04:01<16:13,  1.61it/s] 20%|█▉        | 388/1954 [04:11<16:13,  1.61it/s] 25%|██▍       | 485/1954 [05:01<15:12,  1.61it/s] 25%|██▍       | 485/1954 [05:21<15:12,  1.61it/s] 30%|██▉       | 582/1954 [06:01<14:11,  1.61it/s] 30%|██▉       | 582/1954 [06:21<14:11,  1.61it/s] 35%|███▍      | 680/1954 [07:02<13:09,  1.61it/s] 35%|███▍      | 680/1954 [07:21<13:09,  1.61it/s] 40%|███▉      | 776/1954 [08:02<12:12,  1.61it/s] 40%|███▉      | 776/1954 [08:21<12:12,  1.61it/s] 45%|████▍     | 872/1954 [09:02<11:13,  1.61it/s] 45%|████▍     | 872/1954 [09:21<11:13,  1.61it/s] 50%|████▉     | 968/1954 [10:02<10:15,  1.60it/s] 50%|████▉     | 968/1954 [10:21<10:15,  1.60it/s] 55%|█████▍    | 1065/1954 [11:02<09:14,  1.60it/s] 55%|█████▍    | 1065/1954 [11:21<09:14,  1.60it/s] 59%|█████▉    | 1161/1954 [12:02<08:14,  1.60it/s] 59%|█████▉    | 1161/1954 [12:21<08:14,  1.60it/s] 64%|██████▍   | 1257/1954 [13:02<07:15,  1.60it/s] 64%|██████▍   | 1257/1954 [13:21<07:15,  1.60it/s] 69%|██████▉   | 1353/1954 [14:02<06:15,  1.60it/s] 69%|██████▉   | 1353/1954 [14:21<06:15,  1.60it/s] 74%|███████▍  | 1451/1954 [15:03<05:13,  1.61it/s] 74%|███████▍  | 1451/1954 [15:21<05:13,  1.61it/s] 79%|███████▉  | 1549/1954 [16:04<04:11,  1.61it/s] 79%|███████▉  | 1549/1954 [16:21<04:11,  1.61it/s] 84%|████████▍ | 1646/1954 [17:04<03:11,  1.61it/s] 84%|████████▍ | 1646/1954 [17:21<03:11,  1.61it/s] 89%|████████▉ | 1743/1954 [18:04<02:11,  1.61it/s] 89%|████████▉ | 1743/1954 [18:21<02:11,  1.61it/s] 94%|█████████▍| 1840/1954 [19:05<01:10,  1.61it/s] 94%|█████████▍| 1840/1954 [19:21<01:10,  1.61it/s] 99%|█████████▉| 1936/1954 [20:05<00:11,  1.60it/s]100%|██████████| 1954/1954 [20:16<00:00,  1.61it/s]
07/18/2024 12:47:08 - INFO - mingpt.trainer_atari - train loss: 0.946580
target return: 950, eval return: 5622
