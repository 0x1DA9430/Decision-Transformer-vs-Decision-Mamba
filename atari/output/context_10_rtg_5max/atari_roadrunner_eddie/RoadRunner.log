2024-07-23 15:09:34.382627: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-23 15:09:34.435585: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-23 15:09:35.322542: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s]  7%|▋         | 35190/500000 [01:01<13:38, 567.75it/s] 12%|█▏        | 59478/500000 [01:20<12:55, 567.75it/s] 19%|█▊        | 92973/500000 [02:11<09:15, 733.11it/s] 23%|██▎       | 114912/500000 [02:30<08:45, 733.11it/s] 30%|███       | 151167/500000 [03:19<07:23, 787.25it/s] 33%|███▎      | 163936/500000 [03:30<07:06, 787.25it/s] 42%|████▏     | 207868/500000 [04:27<06:03, 804.42it/s] 44%|████▍     | 218940/500000 [04:40<05:49, 804.42it/s] 53%|█████▎    | 264599/500000 [05:36<04:49, 813.29it/s] 56%|█████▌    | 277943/500000 [05:50<04:33, 813.29it/s] 68%|██████▊   | 339657/500000 [06:48<02:59, 892.99it/s] 70%|███████   | 352335/500000 [07:00<02:45, 892.99it/s] 78%|███████▊  | 389503/500000 [07:56<02:10, 843.58it/s] 81%|████████▏ | 406353/500000 [08:10<01:51, 843.58it/s] 91%|█████████ | 452878/500000 [09:05<00:54, 865.51it/s] 94%|█████████▍| 471880/500000 [09:20<00:32, 865.51it/s]100%|██████████| 500000/500000 [09:48<00:00, 849.04it/s]
07/23/2024 15:20:26 - INFO - mingpt.model_atari - number of parameters: 3472128
this buffer has 14379 loaded transitions and there are now 500000 transitions total divided into 411 trajectories
max rtg is 195
max timestep is 15398
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 123/1954 [01:00<14:59,  2.04it/s]  6%|▋         | 123/1954 [01:19<14:59,  2.04it/s] 14%|█▎        | 264/1954 [02:00<12:41,  2.22it/s] 14%|█▎        | 264/1954 [02:19<12:41,  2.22it/s] 22%|██▏       | 423/1954 [03:00<10:34,  2.41it/s] 22%|██▏       | 423/1954 [03:19<10:34,  2.41it/s] 30%|███       | 587/1954 [04:00<08:59,  2.54it/s] 30%|███       | 587/1954 [04:19<08:59,  2.54it/s] 39%|███▉      | 758/1954 [05:01<07:32,  2.64it/s] 39%|███▉      | 758/1954 [05:19<07:32,  2.64it/s] 48%|████▊     | 930/1954 [06:01<06:16,  2.72it/s] 48%|████▊     | 930/1954 [06:19<06:16,  2.72it/s] 56%|█████▋    | 1104/1954 [07:01<05:06,  2.77it/s] 56%|█████▋    | 1104/1954 [07:19<05:06,  2.77it/s] 66%|██████▌   | 1280/1954 [08:01<03:58,  2.82it/s] 66%|██████▌   | 1280/1954 [08:19<03:58,  2.82it/s] 75%|███████▍  | 1457/1954 [09:01<02:53,  2.86it/s] 75%|███████▍  | 1457/1954 [09:19<02:53,  2.86it/s] 84%|████████▎ | 1635/1954 [10:01<01:50,  2.89it/s] 84%|████████▎ | 1635/1954 [10:19<01:50,  2.89it/s] 93%|█████████▎| 1812/1954 [11:01<00:48,  2.91it/s] 93%|█████████▎| 1812/1954 [11:19<00:48,  2.91it/s]100%|██████████| 1954/1954 [11:50<00:00,  2.75it/s]
07/23/2024 15:32:17 - INFO - mingpt.trainer_atari - train loss: 1.523839
target return: 1075, eval return: 1200
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 218/1954 [01:00<07:59,  3.62it/s] 11%|█         | 218/1954 [01:10<07:59,  3.62it/s] 23%|██▎       | 442/1954 [02:00<06:50,  3.68it/s] 23%|██▎       | 442/1954 [02:10<06:50,  3.68it/s] 34%|███▍      | 669/1954 [03:00<05:44,  3.73it/s] 34%|███▍      | 669/1954 [03:20<05:44,  3.73it/s] 46%|████▌     | 896/1954 [04:00<04:42,  3.74it/s] 46%|████▌     | 896/1954 [04:20<04:42,  3.74it/s] 58%|█████▊    | 1124/1954 [05:00<03:40,  3.76it/s] 58%|█████▊    | 1124/1954 [05:20<03:40,  3.76it/s] 69%|██████▉   | 1352/1954 [06:01<02:39,  3.77it/s] 69%|██████▉   | 1352/1954 [06:20<02:39,  3.77it/s] 81%|████████  | 1580/1954 [07:01<01:39,  3.77it/s] 81%|████████  | 1580/1954 [07:20<01:39,  3.77it/s] 93%|█████████▎| 1808/1954 [08:01<00:38,  3.78it/s] 93%|█████████▎| 1808/1954 [08:20<00:38,  3.78it/s]100%|██████████| 1954/1954 [08:40<00:00,  3.76it/s]
07/23/2024 15:41:26 - INFO - mingpt.trainer_atari - train loss: 1.364743
target return: 1075, eval return: 1590
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 217/1954 [01:00<08:01,  3.61it/s] 11%|█         | 217/1954 [01:19<08:01,  3.61it/s] 23%|██▎       | 440/1954 [02:00<06:52,  3.67it/s] 23%|██▎       | 440/1954 [02:19<06:52,  3.67it/s] 34%|███▍      | 666/1954 [03:00<05:46,  3.71it/s] 34%|███▍      | 666/1954 [03:19<05:46,  3.71it/s] 46%|████▌     | 893/1954 [04:00<04:43,  3.74it/s] 46%|████▌     | 893/1954 [04:19<04:43,  3.74it/s] 57%|█████▋    | 1119/1954 [05:00<03:42,  3.75it/s] 57%|█████▋    | 1119/1954 [05:19<03:42,  3.75it/s] 69%|██████▉   | 1346/1954 [06:00<02:41,  3.76it/s] 69%|██████▉   | 1346/1954 [06:19<02:41,  3.76it/s] 81%|████████  | 1573/1954 [07:00<01:41,  3.76it/s] 81%|████████  | 1573/1954 [07:19<01:41,  3.76it/s] 92%|█████████▏| 1800/1954 [08:00<00:40,  3.77it/s] 92%|█████████▏| 1800/1954 [08:19<00:40,  3.77it/s]100%|██████████| 1954/1954 [08:41<00:00,  3.74it/s]
07/23/2024 15:50:59 - INFO - mingpt.trainer_atari - train loss: 1.272764
target return: 1075, eval return: 2590
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 217/1954 [01:00<08:02,  3.60it/s] 11%|█         | 217/1954 [01:10<08:02,  3.60it/s] 23%|██▎       | 440/1954 [02:00<06:52,  3.67it/s] 23%|██▎       | 440/1954 [02:10<06:52,  3.67it/s] 34%|███▍      | 665/1954 [03:00<05:48,  3.70it/s] 34%|███▍      | 665/1954 [03:20<05:48,  3.70it/s] 46%|████▌     | 891/1954 [04:00<04:45,  3.72it/s] 46%|████▌     | 891/1954 [04:20<04:45,  3.72it/s] 57%|█████▋    | 1118/1954 [05:00<03:43,  3.74it/s] 57%|█████▋    | 1118/1954 [05:20<03:43,  3.74it/s] 69%|██████▉   | 1345/1954 [06:00<02:42,  3.75it/s] 69%|██████▉   | 1345/1954 [06:20<02:42,  3.75it/s] 80%|████████  | 1572/1954 [07:01<01:41,  3.76it/s] 80%|████████  | 1572/1954 [07:20<01:41,  3.76it/s] 92%|█████████▏| 1798/1954 [08:01<00:41,  3.76it/s] 92%|█████████▏| 1798/1954 [08:20<00:41,  3.76it/s]100%|██████████| 1954/1954 [08:42<00:00,  3.74it/s]
07/23/2024 16:00:58 - INFO - mingpt.trainer_atari - train loss: 1.168099
target return: 1075, eval return: 1560
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 207/1954 [01:00<08:27,  3.44it/s] 11%|█         | 207/1954 [01:10<08:27,  3.44it/s] 21%|██▏       | 420/1954 [02:00<07:18,  3.50it/s] 21%|██▏       | 420/1954 [02:10<07:18,  3.50it/s] 32%|███▏      | 635/1954 [03:00<06:13,  3.54it/s] 32%|███▏      | 635/1954 [03:10<06:13,  3.54it/s] 44%|████▎     | 851/1954 [04:00<05:09,  3.56it/s] 44%|████▎     | 851/1954 [04:10<05:09,  3.56it/s] 55%|█████▍    | 1067/1954 [05:00<04:08,  3.57it/s] 55%|█████▍    | 1067/1954 [05:10<04:08,  3.57it/s] 66%|██████▌   | 1284/1954 [06:00<03:07,  3.58it/s] 66%|██████▌   | 1284/1954 [06:10<03:07,  3.58it/s] 77%|███████▋  | 1501/1954 [07:01<02:06,  3.59it/s] 77%|███████▋  | 1501/1954 [07:20<02:06,  3.59it/s] 88%|████████▊ | 1718/1954 [08:01<01:05,  3.59it/s] 88%|████████▊ | 1718/1954 [08:20<01:05,  3.59it/s] 99%|█████████▉| 1934/1954 [09:01<00:05,  3.59it/s]100%|██████████| 1954/1954 [09:07<00:00,  3.57it/s]
07/23/2024 16:11:12 - INFO - mingpt.trainer_atari - train loss: 1.077323
target return: 1075, eval return: 1920
2024-07-23 16:12:15.074644: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-23 16:12:15.337556: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-23 16:12:16.197508: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s]  9%|▉         | 46591/500000 [01:05<10:35, 713.61it/s] 13%|█▎        | 66976/500000 [01:20<10:06, 713.61it/s] 21%|██        | 104255/500000 [02:13<08:17, 795.48it/s] 25%|██▌       | 126800/500000 [02:30<07:49, 795.48it/s] 33%|███▎      | 163937/500000 [03:21<06:43, 832.23it/s] 37%|███▋      | 185285/500000 [03:40<06:18, 832.23it/s] 44%|████▍     | 218941/500000 [04:29<05:41, 824.11it/s] 45%|████▍     | 224675/500000 [04:40<05:34, 824.11it/s] 56%|█████▌    | 277944/500000 [05:37<04:25, 837.69it/s] 58%|█████▊    | 290670/500000 [05:50<04:09, 837.69it/s] 70%|███████   | 352336/500000 [06:48<02:42, 910.80it/s] 72%|███████▏  | 362324/500000 [07:00<02:31, 910.80it/s] 80%|████████  | 401908/500000 [07:54<01:54, 859.17it/s] 85%|████████▍ | 424434/500000 [08:10<01:27, 859.17it/s] 94%|█████████▍| 471881/500000 [09:05<00:31, 902.24it/s] 98%|█████████▊| 487680/500000 [09:20<00:13, 902.24it/s]100%|██████████| 500000/500000 [09:33<00:00, 871.14it/s]
07/23/2024 16:22:48 - INFO - mingpt.model_atari - number of parameters: 3169536
this buffer has 14379 loaded transitions and there are now 500000 transitions total divided into 411 trajectories
max rtg is 195
max timestep is 15398
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 114/1954 [01:00<16:13,  1.89it/s]  6%|▌         | 114/1954 [01:14<16:13,  1.89it/s] 12%|█▏        | 244/1954 [02:00<13:54,  2.05it/s] 12%|█▏        | 244/1954 [02:14<13:54,  2.05it/s] 20%|█▉        | 389/1954 [03:00<11:46,  2.22it/s] 20%|█▉        | 389/1954 [03:14<11:46,  2.22it/s] 28%|██▊       | 542/1954 [04:00<10:02,  2.34it/s] 28%|██▊       | 542/1954 [04:14<10:02,  2.34it/s] 36%|███▌      | 699/1954 [05:00<08:34,  2.44it/s] 36%|███▌      | 699/1954 [05:14<08:34,  2.44it/s] 44%|████▍     | 858/1954 [06:01<07:16,  2.51it/s] 44%|████▍     | 858/1954 [06:14<07:16,  2.51it/s] 52%|█████▏    | 1018/1954 [07:01<06:05,  2.56it/s] 52%|█████▏    | 1018/1954 [07:14<06:05,  2.56it/s] 60%|██████    | 1180/1954 [08:01<04:57,  2.60it/s] 60%|██████    | 1180/1954 [08:14<04:57,  2.60it/s] 69%|██████▊   | 1343/1954 [09:01<03:51,  2.64it/s] 69%|██████▊   | 1343/1954 [09:14<03:51,  2.64it/s] 77%|███████▋  | 1506/1954 [10:01<02:48,  2.66it/s] 77%|███████▋  | 1506/1954 [10:14<02:48,  2.66it/s] 85%|████████▌ | 1670/1954 [11:01<01:45,  2.68it/s] 85%|████████▌ | 1670/1954 [11:14<01:45,  2.68it/s] 94%|█████████▍| 1833/1954 [12:01<00:45,  2.69it/s] 94%|█████████▍| 1833/1954 [12:14<00:45,  2.69it/s]100%|██████████| 1954/1954 [12:46<00:00,  2.55it/s]
07/23/2024 16:35:39 - INFO - mingpt.trainer_atari - train loss: 1.557192
target return: 1075, eval return: 1880
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 215/1954 [01:00<08:06,  3.58it/s] 11%|█         | 215/1954 [01:19<08:06,  3.58it/s] 23%|██▎       | 440/1954 [02:00<06:52,  3.67it/s] 23%|██▎       | 440/1954 [02:19<06:52,  3.67it/s] 34%|███▍      | 668/1954 [03:00<05:45,  3.73it/s] 34%|███▍      | 668/1954 [03:19<05:45,  3.73it/s] 46%|████▌     | 895/1954 [04:00<04:42,  3.75it/s] 46%|████▌     | 895/1954 [04:19<04:42,  3.75it/s] 57%|█████▋    | 1120/1954 [05:00<03:42,  3.74it/s] 57%|█████▋    | 1120/1954 [05:19<03:42,  3.74it/s] 69%|██████▉   | 1346/1954 [06:00<02:42,  3.75it/s] 69%|██████▉   | 1346/1954 [06:19<02:42,  3.75it/s] 80%|████████  | 1570/1954 [07:01<01:42,  3.74it/s] 80%|████████  | 1570/1954 [07:19<01:42,  3.74it/s] 92%|█████████▏| 1796/1954 [08:01<00:42,  3.75it/s] 92%|█████████▏| 1796/1954 [08:19<00:42,  3.75it/s]100%|██████████| 1954/1954 [08:43<00:00,  3.73it/s]
07/23/2024 16:44:50 - INFO - mingpt.trainer_atari - train loss: 1.421739
target return: 1075, eval return: 2670
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 217/1954 [01:00<08:02,  3.60it/s] 11%|█         | 217/1954 [01:17<08:02,  3.60it/s] 23%|██▎       | 441/1954 [02:00<06:51,  3.68it/s] 23%|██▎       | 441/1954 [02:17<06:51,  3.68it/s] 34%|███▍      | 667/1954 [03:00<05:46,  3.71it/s] 34%|███▍      | 667/1954 [03:17<05:46,  3.71it/s] 46%|████▌     | 893/1954 [04:00<04:44,  3.73it/s] 46%|████▌     | 893/1954 [04:17<04:44,  3.73it/s] 57%|█████▋    | 1119/1954 [05:00<03:43,  3.74it/s] 57%|█████▋    | 1119/1954 [05:17<03:43,  3.74it/s] 69%|██████▉   | 1344/1954 [06:00<02:42,  3.74it/s] 69%|██████▉   | 1344/1954 [06:17<02:42,  3.74it/s] 80%|████████  | 1570/1954 [07:00<01:42,  3.75it/s] 80%|████████  | 1570/1954 [07:17<01:42,  3.75it/s] 92%|█████████▏| 1796/1954 [08:01<00:42,  3.75it/s] 92%|█████████▏| 1796/1954 [08:17<00:42,  3.75it/s]100%|██████████| 1954/1954 [08:43<00:00,  3.73it/s]
07/23/2024 16:54:03 - INFO - mingpt.trainer_atari - train loss: 1.378295
target return: 1075, eval return: 1550
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 217/1954 [01:00<08:00,  3.61it/s] 11%|█         | 217/1954 [01:12<08:00,  3.61it/s] 23%|██▎       | 443/1954 [02:00<06:48,  3.70it/s] 23%|██▎       | 443/1954 [02:12<06:48,  3.70it/s] 34%|███▍      | 670/1954 [03:00<05:43,  3.74it/s] 34%|███▍      | 670/1954 [03:12<05:43,  3.74it/s] 46%|████▌     | 898/1954 [04:00<04:41,  3.76it/s] 46%|████▌     | 898/1954 [04:12<04:41,  3.76it/s] 58%|█████▊    | 1126/1954 [05:00<03:39,  3.77it/s] 58%|█████▊    | 1126/1954 [05:12<03:39,  3.77it/s] 69%|██████▉   | 1354/1954 [06:00<02:38,  3.78it/s] 69%|██████▉   | 1354/1954 [06:12<02:38,  3.78it/s] 81%|████████  | 1582/1954 [07:00<01:38,  3.78it/s] 81%|████████  | 1582/1954 [07:12<01:38,  3.78it/s] 93%|█████████▎| 1809/1954 [08:00<00:38,  3.78it/s] 93%|█████████▎| 1809/1954 [08:12<00:38,  3.78it/s]100%|██████████| 1954/1954 [08:39<00:00,  3.76it/s]
07/23/2024 17:03:03 - INFO - mingpt.trainer_atari - train loss: 1.343833
target return: 1075, eval return: 1390
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s] 11%|█         | 217/1954 [01:00<08:01,  3.61it/s] 11%|█         | 217/1954 [01:11<08:01,  3.61it/s] 23%|██▎       | 442/1954 [02:00<06:49,  3.69it/s] 23%|██▎       | 442/1954 [02:11<06:49,  3.69it/s] 34%|███▍      | 669/1954 [03:00<05:44,  3.73it/s] 34%|███▍      | 669/1954 [03:11<05:44,  3.73it/s] 46%|████▌     | 896/1954 [04:00<04:42,  3.75it/s] 46%|████▌     | 896/1954 [04:11<04:42,  3.75it/s] 57%|█████▋    | 1123/1954 [05:00<03:40,  3.76it/s] 57%|█████▋    | 1123/1954 [05:11<03:40,  3.76it/s] 69%|██████▉   | 1350/1954 [06:00<02:40,  3.76it/s] 69%|██████▉   | 1350/1954 [06:11<02:40,  3.76it/s] 81%|████████  | 1578/1954 [07:00<01:39,  3.77it/s] 81%|████████  | 1578/1954 [07:11<01:39,  3.77it/s] 92%|█████████▏| 1805/1954 [08:00<00:39,  3.77it/s] 92%|█████████▏| 1805/1954 [08:11<00:39,  3.77it/s]100%|██████████| 1954/1954 [08:40<00:00,  3.76it/s]
07/23/2024 17:12:06 - INFO - mingpt.trainer_atari - train loss: 1.315437
target return: 1075, eval return: 1030
