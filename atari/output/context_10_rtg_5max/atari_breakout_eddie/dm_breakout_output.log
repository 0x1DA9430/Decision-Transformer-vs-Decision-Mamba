CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 2
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-06-24 07:58:30.229618: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 07:58:31.071053: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 07:58:35.383177: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 16%|█▌        | 81187/500000 [01:00<05:09, 1353.12it/s] 23%|██▎       | 112527/500000 [01:19<04:46, 1353.12it/s] 34%|███▍      | 168768/500000 [02:06<04:09, 1327.20it/s] 39%|███▊      | 193272/500000 [02:19<03:51, 1327.20it/s] 53%|█████▎    | 264464/500000 [03:14<02:52, 1367.57it/s] 58%|█████▊    | 290386/500000 [03:30<02:33, 1367.57it/s] 71%|███████   | 354776/500000 [04:21<01:46, 1359.47it/s] 75%|███████▌  | 375432/500000 [04:40<01:31, 1359.47it/s] 88%|████████▊ | 438124/500000 [05:27<00:46, 1324.90it/s] 93%|█████████▎| 466840/500000 [05:40<00:25, 1324.90it/s]100%|██████████| 500000/500000 [06:07<00:00, 1361.60it/s]
06/24/2024 08:05:37 - INFO - mingpt.model_atari -   number of parameters: 1837312
this buffer has 20698 loaded transitions and there are now 500000 transitions total divided into 373 trajectories
max rtg is 98
max timestep is 2654
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 126/1954 [01:00<14:32,  2.10it/s]  6%|▋         | 126/1954 [01:15<14:32,  2.10it/s] 13%|█▎        | 262/1954 [02:00<12:50,  2.20it/s] 13%|█▎        | 262/1954 [02:15<12:50,  2.20it/s] 20%|██        | 399/1954 [03:00<11:37,  2.23it/s] 20%|██        | 399/1954 [03:15<11:37,  2.23it/s] 27%|██▋       | 536/1954 [04:00<10:30,  2.25it/s] 27%|██▋       | 536/1954 [04:15<10:30,  2.25it/s] 34%|███▍      | 673/1954 [05:00<09:27,  2.26it/s] 34%|███▍      | 673/1954 [05:15<09:27,  2.26it/s] 41%|████▏     | 810/1954 [06:01<08:25,  2.26it/s] 41%|████▏     | 810/1954 [06:15<08:25,  2.26it/s] 48%|████▊     | 947/1954 [07:01<07:23,  2.27it/s] 48%|████▊     | 947/1954 [07:15<07:23,  2.27it/s] 56%|█████▌    | 1085/1954 [08:01<06:21,  2.28it/s] 56%|█████▌    | 1085/1954 [08:15<06:21,  2.28it/s] 63%|██████▎   | 1223/1954 [09:01<05:20,  2.28it/s] 63%|██████▎   | 1223/1954 [09:15<05:20,  2.28it/s] 70%|██████▉   | 1360/1954 [10:01<04:20,  2.28it/s] 70%|██████▉   | 1360/1954 [10:15<04:20,  2.28it/s] 77%|███████▋  | 1498/1954 [11:01<03:19,  2.28it/s] 77%|███████▋  | 1498/1954 [11:15<03:19,  2.28it/s] 84%|████████▎ | 1636/1954 [12:02<02:19,  2.28it/s] 84%|████████▎ | 1636/1954 [12:15<02:19,  2.28it/s] 91%|█████████ | 1774/1954 [13:02<01:18,  2.28it/s] 91%|█████████ | 1774/1954 [13:15<01:18,  2.28it/s] 98%|█████████▊| 1912/1954 [14:02<00:18,  2.29it/s] 98%|█████████▊| 1912/1954 [14:15<00:18,  2.29it/s]100%|██████████| 1954/1954 [14:21<00:00,  2.27it/s]
06/24/2024 08:20:00 - INFO - mingpt.trainer_atari -   train loss: 0.916321
target return: 520, eval return: 17
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 133/1954 [01:00<13:45,  2.21it/s]  7%|▋         | 133/1954 [01:10<13:45,  2.21it/s] 14%|█▎        | 267/1954 [02:00<12:41,  2.22it/s] 14%|█▎        | 267/1954 [02:20<12:41,  2.22it/s] 21%|██        | 401/1954 [03:00<11:38,  2.22it/s] 21%|██        | 401/1954 [03:20<11:38,  2.22it/s] 27%|██▋       | 536/1954 [04:01<10:36,  2.23it/s] 27%|██▋       | 536/1954 [04:20<10:36,  2.23it/s] 34%|███▍      | 671/1954 [05:01<09:35,  2.23it/s] 34%|███▍      | 671/1954 [05:20<09:35,  2.23it/s] 41%|████      | 806/1954 [06:01<08:34,  2.23it/s] 41%|████      | 806/1954 [06:20<08:34,  2.23it/s] 48%|████▊     | 941/1954 [07:02<07:33,  2.23it/s] 48%|████▊     | 941/1954 [07:20<07:33,  2.23it/s] 55%|█████▌    | 1076/1954 [08:02<06:32,  2.24it/s] 55%|█████▌    | 1076/1954 [08:20<06:32,  2.24it/s] 62%|██████▏   | 1211/1954 [09:02<05:31,  2.24it/s] 62%|██████▏   | 1211/1954 [09:20<05:31,  2.24it/s] 69%|██████▉   | 1346/1954 [10:03<04:31,  2.24it/s] 69%|██████▉   | 1346/1954 [10:20<04:31,  2.24it/s] 76%|███████▌  | 1481/1954 [11:03<03:31,  2.24it/s] 76%|███████▌  | 1481/1954 [11:20<03:31,  2.24it/s] 83%|████████▎ | 1616/1954 [12:03<02:31,  2.24it/s] 83%|████████▎ | 1616/1954 [12:20<02:31,  2.24it/s] 90%|████████▉ | 1751/1954 [13:03<01:30,  2.24it/s] 90%|████████▉ | 1751/1954 [13:20<01:30,  2.24it/s] 97%|█████████▋| 1886/1954 [14:03<00:30,  2.24it/s] 97%|█████████▋| 1886/1954 [14:20<00:30,  2.24it/s]100%|██████████| 1954/1954 [14:33<00:00,  2.24it/s]
06/24/2024 08:35:48 - INFO - mingpt.trainer_atari -   train loss: 0.829485
target return: 520, eval return: 20
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 131/1954 [01:00<13:56,  2.18it/s]  7%|▋         | 131/1954 [01:14<13:56,  2.18it/s] 14%|█▎        | 264/1954 [02:00<12:50,  2.19it/s] 14%|█▎        | 264/1954 [02:14<12:50,  2.19it/s] 20%|██        | 397/1954 [03:00<11:46,  2.20it/s] 20%|██        | 397/1954 [03:14<11:46,  2.20it/s] 27%|██▋       | 530/1954 [04:00<10:44,  2.21it/s] 27%|██▋       | 530/1954 [04:14<10:44,  2.21it/s] 34%|███▍      | 664/1954 [05:00<09:42,  2.21it/s] 34%|███▍      | 664/1954 [05:14<09:42,  2.21it/s] 41%|████      | 798/1954 [06:00<08:40,  2.22it/s] 41%|████      | 798/1954 [06:14<08:40,  2.22it/s] 48%|████▊     | 932/1954 [07:01<07:39,  2.22it/s] 48%|████▊     | 932/1954 [07:14<07:39,  2.22it/s] 55%|█████▍    | 1066/1954 [08:01<06:39,  2.22it/s] 55%|█████▍    | 1066/1954 [08:14<06:39,  2.22it/s] 61%|██████▏   | 1200/1954 [09:01<05:38,  2.22it/s] 61%|██████▏   | 1200/1954 [09:14<05:38,  2.22it/s] 68%|██████▊   | 1334/1954 [10:01<04:38,  2.22it/s] 68%|██████▊   | 1334/1954 [10:14<04:38,  2.22it/s] 75%|███████▌  | 1468/1954 [11:02<03:38,  2.22it/s] 75%|███████▌  | 1468/1954 [11:14<03:38,  2.22it/s] 82%|████████▏ | 1602/1954 [12:02<02:38,  2.22it/s] 82%|████████▏ | 1602/1954 [12:14<02:38,  2.22it/s] 89%|████████▉ | 1736/1954 [13:02<01:38,  2.22it/s] 89%|████████▉ | 1736/1954 [13:14<01:38,  2.22it/s] 96%|█████████▌| 1870/1954 [14:02<00:37,  2.22it/s] 96%|█████████▌| 1870/1954 [14:14<00:37,  2.22it/s]100%|██████████| 1954/1954 [14:40<00:00,  2.22it/s]
06/24/2024 08:51:30 - INFO - mingpt.trainer_atari -   train loss: 0.778036
target return: 520, eval return: 60
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 131/1954 [01:00<13:57,  2.18it/s]  7%|▋         | 131/1954 [01:13<13:57,  2.18it/s] 13%|█▎        | 263/1954 [02:00<12:52,  2.19it/s] 13%|█▎        | 263/1954 [02:13<12:52,  2.19it/s] 20%|██        | 396/1954 [03:00<11:49,  2.20it/s] 20%|██        | 396/1954 [03:13<11:49,  2.20it/s] 27%|██▋       | 529/1954 [04:00<10:47,  2.20it/s] 27%|██▋       | 529/1954 [04:13<10:47,  2.20it/s] 34%|███▍      | 662/1954 [05:01<09:46,  2.20it/s] 34%|███▍      | 662/1954 [05:13<09:46,  2.20it/s] 41%|████      | 795/1954 [06:01<08:46,  2.20it/s] 41%|████      | 795/1954 [06:13<08:46,  2.20it/s] 47%|████▋     | 928/1954 [07:01<07:45,  2.20it/s] 47%|████▋     | 928/1954 [07:13<07:45,  2.20it/s] 54%|█████▍    | 1061/1954 [08:01<06:44,  2.21it/s] 54%|█████▍    | 1061/1954 [08:13<06:44,  2.21it/s] 61%|██████    | 1194/1954 [09:02<05:44,  2.21it/s] 61%|██████    | 1194/1954 [09:13<05:44,  2.21it/s] 68%|██████▊   | 1327/1954 [10:02<04:44,  2.21it/s] 68%|██████▊   | 1327/1954 [10:13<04:44,  2.21it/s] 75%|███████▍  | 1460/1954 [11:02<03:43,  2.21it/s] 75%|███████▍  | 1460/1954 [11:13<03:43,  2.21it/s] 82%|████████▏ | 1593/1954 [12:02<02:43,  2.21it/s] 82%|████████▏ | 1593/1954 [12:13<02:43,  2.21it/s] 88%|████████▊ | 1726/1954 [13:03<01:43,  2.21it/s] 88%|████████▊ | 1726/1954 [13:13<01:43,  2.21it/s] 95%|█████████▌| 1859/1954 [14:03<00:43,  2.21it/s] 95%|█████████▌| 1859/1954 [14:23<00:43,  2.21it/s]100%|██████████| 1954/1954 [14:45<00:00,  2.21it/s]
06/24/2024 09:07:57 - INFO - mingpt.trainer_atari -   train loss: 0.723403
target return: 520, eval return: 82
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 99/1954 [01:00<18:54,  1.63it/s]  5%|▌         | 99/1954 [01:14<18:54,  1.63it/s] 10%|█         | 198/1954 [02:01<17:53,  1.64it/s] 10%|█         | 198/1954 [02:14<17:53,  1.64it/s] 15%|█▌        | 297/1954 [03:01<16:53,  1.64it/s] 15%|█▌        | 297/1954 [03:14<16:53,  1.64it/s] 20%|██        | 396/1954 [04:02<15:52,  1.64it/s] 20%|██        | 396/1954 [04:14<15:52,  1.64it/s] 25%|██▌       | 495/1954 [05:02<14:51,  1.64it/s] 25%|██▌       | 495/1954 [05:14<14:51,  1.64it/s] 30%|███       | 594/1954 [06:02<13:50,  1.64it/s] 30%|███       | 594/1954 [06:14<13:50,  1.64it/s] 35%|███▌      | 693/1954 [07:03<12:50,  1.64it/s] 35%|███▌      | 693/1954 [07:14<12:50,  1.64it/s] 41%|████      | 792/1954 [08:03<11:49,  1.64it/s] 41%|████      | 792/1954 [08:14<11:49,  1.64it/s] 46%|████▌     | 891/1954 [09:04<10:49,  1.64it/s] 46%|████▌     | 891/1954 [09:24<10:49,  1.64it/s] 51%|█████     | 990/1954 [10:04<09:48,  1.64it/s] 51%|█████     | 990/1954 [10:24<09:48,  1.64it/s] 56%|█████▌    | 1089/1954 [11:05<08:47,  1.64it/s] 56%|█████▌    | 1089/1954 [11:24<08:47,  1.64it/s] 61%|██████    | 1188/1954 [12:05<07:47,  1.64it/s] 61%|██████    | 1188/1954 [12:24<07:47,  1.64it/s] 66%|██████▌   | 1287/1954 [13:05<06:46,  1.64it/s] 66%|██████▌   | 1287/1954 [13:24<06:46,  1.64it/s] 71%|███████   | 1386/1954 [14:06<05:46,  1.64it/s] 71%|███████   | 1386/1954 [14:24<05:46,  1.64it/s] 76%|███████▌  | 1485/1954 [15:06<04:46,  1.64it/s] 76%|███████▌  | 1485/1954 [15:24<04:46,  1.64it/s] 81%|████████  | 1584/1954 [16:06<03:45,  1.64it/s] 81%|████████  | 1584/1954 [16:24<03:45,  1.64it/s] 86%|████████▌ | 1683/1954 [17:07<02:45,  1.64it/s] 86%|████████▌ | 1683/1954 [17:24<02:45,  1.64it/s] 91%|█████████ | 1781/1954 [18:07<01:45,  1.64it/s] 91%|█████████ | 1781/1954 [18:24<01:45,  1.64it/s] 96%|█████████▌| 1880/1954 [19:07<00:45,  1.64it/s] 96%|█████████▌| 1880/1954 [19:24<00:45,  1.64it/s]100%|██████████| 1954/1954 [19:52<00:00,  1.64it/s]
06/24/2024 09:30:03 - INFO - mingpt.trainer_atari -   train loss: 0.673563
target return: 520, eval return: 49
2024-06-24 09:32:50.365559: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 09:32:51.099843: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 09:32:55.435706: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 16%|█▋        | 81653/500000 [01:00<05:07, 1360.88it/s] 20%|█▉        | 98101/500000 [01:10<04:55, 1360.88it/s] 34%|███▍      | 171596/500000 [02:06<04:03, 1349.81it/s] 41%|████      | 203023/500000 [02:20<03:40, 1349.81it/s] 53%|█████▎    | 267041/500000 [03:06<02:40, 1455.89it/s] 57%|█████▋    | 283581/500000 [03:20<02:28, 1455.89it/s] 72%|███████▏  | 358888/500000 [04:14<01:39, 1419.22it/s] 78%|███████▊  | 392456/500000 [04:30<01:15, 1419.22it/s] 91%|█████████ | 455008/500000 [05:14<00:30, 1482.32it/s] 97%|█████████▋| 485100/500000 [05:30<00:10, 1482.32it/s]100%|██████████| 500000/500000 [05:43<00:00, 1454.90it/s]
06/24/2024 09:39:35 - INFO - mingpt.model_atari -   number of parameters: 1873408
this buffer has 14899 loaded transitions and there are now 500000 transitions total divided into 341 trajectories
max rtg is 98
max timestep is 2936
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 128/1954 [01:00<14:20,  2.12it/s]  7%|▋         | 128/1954 [01:16<14:20,  2.12it/s] 13%|█▎        | 263/1954 [02:00<12:51,  2.19it/s] 13%|█▎        | 263/1954 [02:16<12:51,  2.19it/s] 20%|██        | 398/1954 [03:00<11:41,  2.22it/s] 20%|██        | 398/1954 [03:16<11:41,  2.22it/s] 27%|██▋       | 534/1954 [04:01<10:36,  2.23it/s] 27%|██▋       | 534/1954 [04:16<10:36,  2.23it/s] 34%|███▍      | 670/1954 [05:01<09:33,  2.24it/s] 34%|███▍      | 670/1954 [05:16<09:33,  2.24it/s] 41%|████      | 806/1954 [06:01<08:31,  2.24it/s] 41%|████      | 806/1954 [06:16<08:31,  2.24it/s] 48%|████▊     | 942/1954 [07:02<07:30,  2.25it/s] 48%|████▊     | 942/1954 [07:16<07:30,  2.25it/s] 55%|█████▌    | 1078/1954 [08:02<06:29,  2.25it/s] 55%|█████▌    | 1078/1954 [08:16<06:29,  2.25it/s] 62%|██████▏   | 1214/1954 [09:02<05:28,  2.25it/s] 62%|██████▏   | 1214/1954 [09:16<05:28,  2.25it/s] 69%|██████▉   | 1350/1954 [10:02<04:28,  2.25it/s] 69%|██████▉   | 1350/1954 [10:16<04:28,  2.25it/s] 76%|███████▌  | 1486/1954 [11:03<03:27,  2.25it/s] 76%|███████▌  | 1486/1954 [11:16<03:27,  2.25it/s] 83%|████████▎ | 1622/1954 [12:03<02:27,  2.26it/s] 83%|████████▎ | 1622/1954 [12:16<02:27,  2.26it/s] 90%|████████▉ | 1758/1954 [13:03<01:26,  2.26it/s] 90%|████████▉ | 1758/1954 [13:16<01:26,  2.26it/s] 97%|█████████▋| 1894/1954 [14:03<00:26,  2.26it/s] 97%|█████████▋| 1894/1954 [14:16<00:26,  2.26it/s]100%|██████████| 1954/1954 [14:30<00:00,  2.25it/s]
06/24/2024 09:54:07 - INFO - mingpt.trainer_atari -   train loss: 0.906627
target return: 520, eval return: 42
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 119/1954 [01:00<15:27,  1.98it/s]  6%|▌         | 119/1954 [01:19<15:27,  1.98it/s] 12%|█▏        | 238/1954 [02:00<14:27,  1.98it/s] 12%|█▏        | 238/1954 [02:19<14:27,  1.98it/s] 18%|█▊        | 358/1954 [03:00<13:25,  1.98it/s] 18%|█▊        | 358/1954 [03:19<13:25,  1.98it/s] 24%|██▍       | 477/1954 [04:00<12:25,  1.98it/s] 24%|██▍       | 477/1954 [04:19<12:25,  1.98it/s] 31%|███       | 597/1954 [05:01<11:23,  1.98it/s] 31%|███       | 597/1954 [05:19<11:23,  1.98it/s] 37%|███▋      | 717/1954 [06:01<10:23,  1.99it/s] 37%|███▋      | 717/1954 [06:19<10:23,  1.99it/s] 43%|████▎     | 836/1954 [07:01<09:23,  1.98it/s] 43%|████▎     | 836/1954 [07:19<09:23,  1.98it/s] 49%|████▉     | 956/1954 [08:01<08:22,  1.99it/s] 49%|████▉     | 956/1954 [08:19<08:22,  1.99it/s] 55%|█████▌    | 1076/1954 [09:02<07:21,  1.99it/s] 55%|█████▌    | 1076/1954 [09:19<07:21,  1.99it/s] 61%|██████    | 1196/1954 [10:02<06:21,  1.99it/s] 61%|██████    | 1196/1954 [10:19<06:21,  1.99it/s] 67%|██████▋   | 1316/1954 [11:02<05:20,  1.99it/s] 67%|██████▋   | 1316/1954 [11:19<05:20,  1.99it/s] 73%|███████▎  | 1436/1954 [12:03<04:20,  1.99it/s] 73%|███████▎  | 1436/1954 [12:19<04:20,  1.99it/s] 80%|███████▉  | 1556/1954 [13:03<03:20,  1.99it/s] 80%|███████▉  | 1556/1954 [13:19<03:20,  1.99it/s] 86%|████████▌ | 1676/1954 [14:03<02:19,  1.99it/s] 86%|████████▌ | 1676/1954 [14:19<02:19,  1.99it/s] 92%|█████████▏| 1795/1954 [15:03<01:20,  1.99it/s] 92%|█████████▏| 1795/1954 [15:19<01:20,  1.99it/s] 98%|█████████▊| 1915/1954 [16:03<00:19,  1.99it/s] 98%|█████████▊| 1915/1954 [16:19<00:19,  1.99it/s]100%|██████████| 1954/1954 [16:23<00:00,  1.99it/s]
06/24/2024 10:12:27 - INFO - mingpt.trainer_atari -   train loss: 0.820496
target return: 520, eval return: 64
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:39,  1.96it/s]  6%|▌         | 118/1954 [01:17<15:39,  1.96it/s] 12%|█▏        | 237/1954 [02:00<14:33,  1.96it/s] 12%|█▏        | 237/1954 [02:17<14:33,  1.96it/s] 18%|█▊        | 356/1954 [03:00<13:30,  1.97it/s] 18%|█▊        | 356/1954 [03:17<13:30,  1.97it/s] 24%|██▍       | 475/1954 [04:00<12:29,  1.97it/s] 24%|██▍       | 475/1954 [04:17<12:29,  1.97it/s] 30%|███       | 594/1954 [05:01<11:28,  1.98it/s] 30%|███       | 594/1954 [05:17<11:28,  1.98it/s] 36%|███▋      | 713/1954 [06:01<10:27,  1.98it/s] 36%|███▋      | 713/1954 [06:17<10:27,  1.98it/s] 43%|████▎     | 832/1954 [07:01<09:27,  1.98it/s] 43%|████▎     | 832/1954 [07:17<09:27,  1.98it/s] 49%|████▊     | 952/1954 [08:01<08:26,  1.98it/s] 49%|████▊     | 952/1954 [08:17<08:26,  1.98it/s] 55%|█████▍    | 1072/1954 [09:02<07:25,  1.98it/s] 55%|█████▍    | 1072/1954 [09:17<07:25,  1.98it/s] 61%|██████    | 1192/1954 [10:02<06:24,  1.98it/s] 61%|██████    | 1192/1954 [10:17<06:24,  1.98it/s] 67%|██████▋   | 1311/1954 [11:02<05:24,  1.98it/s] 67%|██████▋   | 1311/1954 [11:17<05:24,  1.98it/s] 73%|███████▎  | 1431/1954 [12:03<04:23,  1.98it/s] 73%|███████▎  | 1431/1954 [12:17<04:23,  1.98it/s] 79%|███████▉  | 1551/1954 [13:03<03:23,  1.98it/s] 79%|███████▉  | 1551/1954 [13:17<03:23,  1.98it/s] 85%|████████▌ | 1670/1954 [14:03<02:23,  1.98it/s] 85%|████████▌ | 1670/1954 [14:17<02:23,  1.98it/s] 92%|█████████▏| 1789/1954 [15:03<01:23,  1.98it/s] 92%|█████████▏| 1789/1954 [15:17<01:23,  1.98it/s] 98%|█████████▊| 1909/1954 [16:04<00:22,  1.98it/s] 98%|█████████▊| 1909/1954 [16:17<00:22,  1.98it/s]100%|██████████| 1954/1954 [16:26<00:00,  1.98it/s]
06/24/2024 10:31:03 - INFO - mingpt.trainer_atari -   train loss: 0.772464
target return: 520, eval return: 121
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:36,  1.96it/s]  6%|▌         | 118/1954 [01:10<15:36,  1.96it/s] 12%|█▏        | 237/1954 [02:00<14:32,  1.97it/s] 12%|█▏        | 237/1954 [02:20<14:32,  1.97it/s] 18%|█▊        | 356/1954 [03:00<13:30,  1.97it/s] 18%|█▊        | 356/1954 [03:20<13:30,  1.97it/s] 24%|██▍       | 475/1954 [04:00<12:28,  1.98it/s] 24%|██▍       | 475/1954 [04:20<12:28,  1.98it/s] 30%|███       | 595/1954 [05:00<11:25,  1.98it/s] 30%|███       | 595/1954 [05:20<11:25,  1.98it/s] 37%|███▋      | 715/1954 [06:00<10:23,  1.99it/s] 37%|███▋      | 715/1954 [06:20<10:23,  1.99it/s] 43%|████▎     | 835/1954 [07:01<09:22,  1.99it/s] 43%|████▎     | 835/1954 [07:20<09:22,  1.99it/s] 49%|████▉     | 955/1954 [08:01<08:22,  1.99it/s] 49%|████▉     | 955/1954 [08:20<08:22,  1.99it/s] 55%|█████▌    | 1075/1954 [09:01<07:21,  1.99it/s] 55%|█████▌    | 1075/1954 [09:20<07:21,  1.99it/s] 61%|██████    | 1195/1954 [10:02<06:21,  1.99it/s] 61%|██████    | 1195/1954 [10:20<06:21,  1.99it/s] 67%|██████▋   | 1315/1954 [11:02<05:21,  1.99it/s] 67%|██████▋   | 1315/1954 [11:20<05:21,  1.99it/s] 73%|███████▎  | 1434/1954 [12:02<04:21,  1.99it/s] 73%|███████▎  | 1434/1954 [12:20<04:21,  1.99it/s] 80%|███████▉  | 1554/1954 [13:02<03:21,  1.99it/s] 80%|███████▉  | 1554/1954 [13:20<03:21,  1.99it/s] 86%|████████▌ | 1674/1954 [14:02<02:20,  1.99it/s] 86%|████████▌ | 1674/1954 [14:20<02:20,  1.99it/s] 92%|█████████▏| 1794/1954 [15:03<01:20,  1.99it/s] 92%|█████████▏| 1794/1954 [15:20<01:20,  1.99it/s] 98%|█████████▊| 1916/1954 [16:03<00:18,  2.00it/s] 98%|█████████▊| 1916/1954 [16:20<00:18,  2.00it/s]100%|██████████| 1954/1954 [16:21<00:00,  1.99it/s]
06/24/2024 10:51:35 - INFO - mingpt.trainer_atari -   train loss: 0.721324
target return: 520, eval return: 79
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:38,  1.96it/s]  6%|▌         | 118/1954 [01:17<15:38,  1.96it/s] 12%|█▏        | 237/1954 [02:00<14:33,  1.97it/s] 12%|█▏        | 237/1954 [02:17<14:33,  1.97it/s] 18%|█▊        | 356/1954 [03:00<13:30,  1.97it/s] 18%|█▊        | 356/1954 [03:17<13:30,  1.97it/s] 24%|██▍       | 475/1954 [04:00<12:28,  1.98it/s] 24%|██▍       | 475/1954 [04:17<12:28,  1.98it/s] 30%|███       | 594/1954 [05:00<11:28,  1.98it/s] 30%|███       | 594/1954 [05:17<11:28,  1.98it/s] 36%|███▋      | 713/1954 [06:01<10:27,  1.98it/s] 36%|███▋      | 713/1954 [06:17<10:27,  1.98it/s] 43%|████▎     | 832/1954 [07:01<09:27,  1.98it/s] 43%|████▎     | 832/1954 [07:17<09:27,  1.98it/s] 49%|████▊     | 952/1954 [08:01<08:25,  1.98it/s] 49%|████▊     | 952/1954 [08:17<08:25,  1.98it/s] 55%|█████▍    | 1072/1954 [09:01<07:24,  1.98it/s] 55%|█████▍    | 1072/1954 [09:17<07:24,  1.98it/s] 61%|██████    | 1192/1954 [10:02<06:23,  1.99it/s] 61%|██████    | 1192/1954 [10:17<06:23,  1.99it/s] 67%|██████▋   | 1312/1954 [11:02<05:23,  1.99it/s] 67%|██████▋   | 1312/1954 [11:17<05:23,  1.99it/s] 73%|███████▎  | 1432/1954 [12:02<04:22,  1.99it/s] 73%|███████▎  | 1432/1954 [12:17<04:22,  1.99it/s] 79%|███████▉  | 1552/1954 [13:03<03:22,  1.99it/s] 79%|███████▉  | 1552/1954 [13:17<03:22,  1.99it/s] 86%|████████▌ | 1672/1954 [14:03<02:21,  1.99it/s] 86%|████████▌ | 1672/1954 [14:17<02:21,  1.99it/s] 92%|█████████▏| 1792/1954 [15:03<01:21,  1.99it/s] 92%|█████████▏| 1792/1954 [15:17<01:21,  1.99it/s] 98%|█████████▊| 1912/1954 [16:03<00:21,  1.99it/s] 98%|█████████▊| 1912/1954 [16:17<00:21,  1.99it/s]100%|██████████| 1954/1954 [16:24<00:00,  1.98it/s]
06/24/2024 11:10:31 - INFO - mingpt.trainer_atari -   train loss: 0.674494
target return: 520, eval return: 79
2024-06-24 11:14:09.557469: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 11:14:09.642987: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 11:14:15.236091: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 16%|█▌        | 79972/500000 [01:00<05:15, 1332.86it/s] 19%|█▉        | 95959/500000 [01:10<05:03, 1332.86it/s] 35%|███▍      | 174532/500000 [02:00<03:40, 1475.88it/s] 37%|███▋      | 185987/500000 [02:10<03:32, 1475.88it/s] 52%|█████▏    | 258486/500000 [03:06<02:55, 1375.51it/s] 57%|█████▋    | 285470/500000 [03:20<02:35, 1375.51it/s] 71%|███████   | 353884/500000 [04:06<01:40, 1457.81it/s] 74%|███████▍  | 369181/500000 [04:20<01:29, 1457.81it/s] 87%|████████▋ | 435609/500000 [05:12<00:46, 1375.91it/s] 90%|█████████ | 452491/500000 [05:30<00:34, 1375.91it/s]100%|██████████| 500000/500000 [06:07<00:00, 1359.38it/s]
06/24/2024 11:21:20 - INFO - mingpt.model_atari -   number of parameters: 1942528
this buffer has 7221 loaded transitions and there are now 500000 transitions total divided into 375 trajectories
max rtg is 89
max timestep is 3476
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 125/1954 [01:00<14:38,  2.08it/s]  6%|▋         | 125/1954 [01:13<14:38,  2.08it/s] 13%|█▎        | 260/1954 [02:00<12:59,  2.17it/s] 13%|█▎        | 260/1954 [02:13<12:59,  2.17it/s] 20%|██        | 395/1954 [03:00<11:46,  2.21it/s] 20%|██        | 395/1954 [03:13<11:46,  2.21it/s] 27%|██▋       | 530/1954 [04:00<10:40,  2.22it/s] 27%|██▋       | 530/1954 [04:13<10:40,  2.22it/s] 34%|███▍      | 666/1954 [05:01<09:37,  2.23it/s] 34%|███▍      | 666/1954 [05:13<09:37,  2.23it/s] 41%|████      | 802/1954 [06:01<08:34,  2.24it/s] 41%|████      | 802/1954 [06:13<08:34,  2.24it/s] 48%|████▊     | 938/1954 [07:01<07:32,  2.24it/s] 48%|████▊     | 938/1954 [07:13<07:32,  2.24it/s] 55%|█████▍    | 1074/1954 [08:01<06:30,  2.25it/s] 55%|█████▍    | 1074/1954 [08:13<06:30,  2.25it/s] 62%|██████▏   | 1210/1954 [09:01<05:30,  2.25it/s] 62%|██████▏   | 1210/1954 [09:13<05:30,  2.25it/s] 69%|██████▉   | 1346/1954 [10:02<04:29,  2.25it/s] 69%|██████▉   | 1346/1954 [10:13<04:29,  2.25it/s] 76%|███████▌  | 1482/1954 [11:02<03:29,  2.26it/s] 76%|███████▌  | 1482/1954 [11:13<03:29,  2.26it/s] 83%|████████▎ | 1618/1954 [12:02<02:28,  2.26it/s] 83%|████████▎ | 1618/1954 [12:13<02:28,  2.26it/s] 90%|████████▉ | 1752/1954 [13:02<01:29,  2.25it/s] 90%|████████▉ | 1752/1954 [13:13<01:29,  2.25it/s] 96%|█████████▋| 1885/1954 [14:02<00:30,  2.24it/s] 96%|█████████▋| 1885/1954 [14:13<00:30,  2.24it/s]100%|██████████| 1954/1954 [14:34<00:00,  2.24it/s]
06/24/2024 11:35:56 - INFO - mingpt.trainer_atari -   train loss: 0.922949
target return: 520, eval return: 16
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 117/1954 [01:00<15:46,  1.94it/s]  6%|▌         | 117/1954 [01:12<15:46,  1.94it/s] 12%|█▏        | 234/1954 [02:00<14:44,  1.94it/s] 12%|█▏        | 234/1954 [02:12<14:44,  1.94it/s] 18%|█▊        | 351/1954 [03:00<13:43,  1.95it/s] 18%|█▊        | 351/1954 [03:12<13:43,  1.95it/s] 24%|██▍       | 468/1954 [04:00<12:43,  1.95it/s] 24%|██▍       | 468/1954 [04:12<12:43,  1.95it/s] 30%|██▉       | 586/1954 [05:00<11:41,  1.95it/s] 30%|██▉       | 586/1954 [05:12<11:41,  1.95it/s] 36%|███▌      | 704/1954 [06:01<10:40,  1.95it/s] 36%|███▌      | 704/1954 [06:12<10:40,  1.95it/s] 42%|████▏     | 821/1954 [07:01<09:40,  1.95it/s] 42%|████▏     | 821/1954 [07:12<09:40,  1.95it/s] 48%|████▊     | 938/1954 [08:01<08:41,  1.95it/s] 48%|████▊     | 938/1954 [08:12<08:41,  1.95it/s] 54%|█████▍    | 1055/1954 [09:01<07:42,  1.95it/s] 54%|█████▍    | 1055/1954 [09:12<07:42,  1.95it/s] 60%|█████▉    | 1172/1954 [10:02<06:42,  1.94it/s] 60%|█████▉    | 1172/1954 [10:12<06:42,  1.94it/s] 66%|██████▌   | 1288/1954 [11:02<05:43,  1.94it/s] 66%|██████▌   | 1288/1954 [11:12<05:43,  1.94it/s] 72%|███████▏  | 1404/1954 [12:02<04:44,  1.93it/s] 72%|███████▏  | 1404/1954 [12:22<04:44,  1.93it/s] 78%|███████▊  | 1520/1954 [13:02<03:44,  1.93it/s] 78%|███████▊  | 1520/1954 [13:22<03:44,  1.93it/s] 84%|████████▎ | 1636/1954 [14:03<02:44,  1.93it/s] 84%|████████▎ | 1636/1954 [14:22<02:44,  1.93it/s] 90%|████████▉ | 1752/1954 [15:03<01:44,  1.93it/s] 90%|████████▉ | 1752/1954 [15:22<01:44,  1.93it/s] 96%|█████████▌| 1868/1954 [16:03<00:44,  1.93it/s] 96%|█████████▌| 1868/1954 [16:22<00:44,  1.93it/s]100%|██████████| 1954/1954 [16:47<00:00,  1.94it/s]
06/24/2024 11:54:00 - INFO - mingpt.trainer_atari -   train loss: 0.831533
target return: 520, eval return: 42
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 113/1954 [01:00<16:25,  1.87it/s]  6%|▌         | 113/1954 [01:18<16:25,  1.87it/s] 12%|█▏        | 226/1954 [02:00<15:21,  1.88it/s] 12%|█▏        | 226/1954 [02:18<15:21,  1.88it/s] 17%|█▋        | 340/1954 [03:00<14:18,  1.88it/s] 17%|█▋        | 340/1954 [03:18<14:18,  1.88it/s] 23%|██▎       | 454/1954 [04:01<13:16,  1.88it/s] 23%|██▎       | 454/1954 [04:18<13:16,  1.88it/s] 29%|██▉       | 568/1954 [05:01<12:16,  1.88it/s] 29%|██▉       | 568/1954 [05:18<12:16,  1.88it/s] 35%|███▍      | 681/1954 [06:02<11:16,  1.88it/s] 35%|███▍      | 681/1954 [06:18<11:16,  1.88it/s] 41%|████      | 794/1954 [07:02<10:16,  1.88it/s] 41%|████      | 794/1954 [07:18<10:16,  1.88it/s] 46%|████▋     | 907/1954 [08:02<09:16,  1.88it/s] 46%|████▋     | 907/1954 [08:18<09:16,  1.88it/s] 52%|█████▏    | 1021/1954 [09:02<08:15,  1.88it/s] 52%|█████▏    | 1021/1954 [09:18<08:15,  1.88it/s] 58%|█████▊    | 1135/1954 [10:02<07:14,  1.89it/s] 58%|█████▊    | 1135/1954 [10:18<07:14,  1.89it/s] 64%|██████▍   | 1249/1954 [11:03<06:14,  1.88it/s] 64%|██████▍   | 1249/1954 [11:18<06:14,  1.88it/s] 70%|██████▉   | 1362/1954 [12:03<05:14,  1.88it/s] 70%|██████▉   | 1362/1954 [12:18<05:14,  1.88it/s] 75%|███████▌  | 1475/1954 [13:03<04:14,  1.88it/s] 75%|███████▌  | 1475/1954 [13:18<04:14,  1.88it/s] 81%|████████▏ | 1588/1954 [14:03<03:14,  1.88it/s] 81%|████████▏ | 1588/1954 [14:18<03:14,  1.88it/s] 87%|████████▋ | 1701/1954 [15:04<02:14,  1.88it/s] 87%|████████▋ | 1701/1954 [15:18<02:14,  1.88it/s] 93%|█████████▎| 1814/1954 [16:04<01:14,  1.88it/s] 93%|█████████▎| 1814/1954 [16:18<01:14,  1.88it/s] 99%|█████████▊| 1927/1954 [17:04<00:14,  1.88it/s] 99%|█████████▊| 1927/1954 [17:18<00:14,  1.88it/s]100%|██████████| 1954/1954 [17:18<00:00,  1.88it/s]
06/24/2024 12:13:35 - INFO - mingpt.trainer_atari -   train loss: 0.776897
target return: 520, eval return: 69
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 114/1954 [01:00<16:14,  1.89it/s]  6%|▌         | 114/1954 [01:15<16:14,  1.89it/s] 12%|█▏        | 229/1954 [02:00<15:07,  1.90it/s] 12%|█▏        | 229/1954 [02:15<15:07,  1.90it/s] 18%|█▊        | 344/1954 [03:00<14:04,  1.91it/s] 18%|█▊        | 344/1954 [03:15<14:04,  1.91it/s] 24%|██▎       | 460/1954 [04:01<13:01,  1.91it/s] 24%|██▎       | 460/1954 [04:15<13:01,  1.91it/s] 30%|██▉       | 577/1954 [05:01<11:57,  1.92it/s] 30%|██▉       | 577/1954 [05:15<11:57,  1.92it/s] 36%|███▌      | 694/1954 [06:01<10:53,  1.93it/s] 36%|███▌      | 694/1954 [06:15<10:53,  1.93it/s] 42%|████▏     | 811/1954 [07:02<09:51,  1.93it/s] 42%|████▏     | 811/1954 [07:15<09:51,  1.93it/s] 47%|████▋     | 928/1954 [08:02<08:50,  1.93it/s] 47%|████▋     | 928/1954 [08:15<08:50,  1.93it/s] 53%|█████▎    | 1045/1954 [09:02<07:49,  1.94it/s] 53%|█████▎    | 1045/1954 [09:15<07:49,  1.94it/s] 59%|█████▉    | 1162/1954 [10:03<06:49,  1.94it/s] 59%|█████▉    | 1162/1954 [10:15<06:49,  1.94it/s] 65%|██████▌   | 1279/1954 [11:03<05:48,  1.94it/s] 65%|██████▌   | 1279/1954 [11:15<05:48,  1.94it/s] 71%|███████▏  | 1395/1954 [12:03<04:49,  1.93it/s] 71%|███████▏  | 1395/1954 [12:15<04:49,  1.93it/s] 77%|███████▋  | 1511/1954 [13:03<03:49,  1.93it/s] 77%|███████▋  | 1511/1954 [13:15<03:49,  1.93it/s] 83%|████████▎ | 1628/1954 [14:04<02:48,  1.93it/s] 83%|████████▎ | 1628/1954 [14:15<02:48,  1.93it/s] 89%|████████▉ | 1745/1954 [15:04<01:48,  1.94it/s] 89%|████████▉ | 1745/1954 [15:15<01:48,  1.94it/s] 95%|█████████▌| 1862/1954 [16:05<00:47,  1.94it/s] 95%|█████████▌| 1862/1954 [16:15<00:47,  1.94it/s]100%|██████████| 1954/1954 [16:52<00:00,  1.93it/s]
06/24/2024 12:32:42 - INFO - mingpt.trainer_atari -   train loss: 0.720139
target return: 520, eval return: 118
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 115/1954 [01:00<16:04,  1.91it/s]  6%|▌         | 115/1954 [01:18<16:04,  1.91it/s] 12%|█▏        | 231/1954 [02:00<14:58,  1.92it/s] 12%|█▏        | 231/1954 [02:18<14:58,  1.92it/s] 18%|█▊        | 347/1954 [03:00<13:55,  1.92it/s] 18%|█▊        | 347/1954 [03:18<13:55,  1.92it/s] 24%|██▎       | 464/1954 [04:00<12:52,  1.93it/s] 24%|██▎       | 464/1954 [04:18<12:52,  1.93it/s] 30%|██▉       | 581/1954 [05:01<11:50,  1.93it/s] 30%|██▉       | 581/1954 [05:18<11:50,  1.93it/s] 36%|███▌      | 698/1954 [06:01<10:49,  1.93it/s] 36%|███▌      | 698/1954 [06:18<10:49,  1.93it/s] 42%|████▏     | 814/1954 [07:01<09:49,  1.93it/s] 42%|████▏     | 814/1954 [07:18<09:49,  1.93it/s] 48%|████▊     | 931/1954 [08:02<08:48,  1.93it/s] 48%|████▊     | 931/1954 [08:18<08:48,  1.93it/s] 54%|█████▎    | 1048/1954 [09:02<07:47,  1.94it/s] 54%|█████▎    | 1048/1954 [09:18<07:47,  1.94it/s] 60%|█████▉    | 1165/1954 [10:02<06:46,  1.94it/s] 60%|█████▉    | 1165/1954 [10:18<06:46,  1.94it/s] 66%|██████▌   | 1282/1954 [11:02<05:46,  1.94it/s] 66%|██████▌   | 1282/1954 [11:18<05:46,  1.94it/s] 72%|███████▏  | 1399/1954 [12:03<04:45,  1.94it/s] 72%|███████▏  | 1399/1954 [12:18<04:45,  1.94it/s] 78%|███████▊  | 1516/1954 [13:03<03:45,  1.94it/s] 78%|███████▊  | 1516/1954 [13:18<03:45,  1.94it/s] 84%|████████▎ | 1633/1954 [14:03<02:45,  1.94it/s] 84%|████████▎ | 1633/1954 [14:18<02:45,  1.94it/s] 90%|████████▉ | 1750/1954 [15:03<01:44,  1.94it/s] 90%|████████▉ | 1750/1954 [15:18<01:44,  1.94it/s] 96%|█████████▌| 1867/1954 [16:03<00:44,  1.94it/s] 96%|█████████▌| 1867/1954 [16:18<00:44,  1.94it/s]100%|██████████| 1954/1954 [16:47<00:00,  1.94it/s]
06/24/2024 12:52:45 - INFO - mingpt.trainer_atari -   train loss: 0.669240
target return: 520, eval return: 97
