CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 1
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-06-24 15:11:50.818833: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 15:11:50.894293: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 15:11:55.234536: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 14%|█▍        | 70687/500000 [01:04<06:32, 1094.74it/s] 20%|█▉        | 98026/500000 [01:20<06:07, 1094.74it/s] 32%|███▏      | 160182/500000 [02:10<04:31, 1253.57it/s] 38%|███▊      | 192453/500000 [02:30<04:05, 1253.57it/s] 51%|█████     | 255331/500000 [03:16<03:03, 1334.03it/s] 56%|█████▌    | 279207/500000 [03:30<02:45, 1334.03it/s] 67%|██████▋   | 336637/500000 [04:20<02:04, 1310.67it/s] 73%|███████▎  | 365912/500000 [04:40<01:42, 1310.67it/s] 84%|████████▍ | 419468/500000 [05:25<01:01, 1301.29it/s] 87%|████████▋ | 436928/500000 [05:40<00:48, 1301.29it/s]100%|██████████| 500000/500000 [06:22<00:00, 1308.00it/s]
06/24/2024 15:18:59 - INFO - mingpt.model_atari -   number of parameters: 1694848
this buffer has 10340 loaded transitions and there are now 500000 transitions total divided into 410 trajectories
max rtg is 600
max timestep is 3901
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 124/1954 [01:00<14:50,  2.06it/s]  6%|▋         | 124/1954 [01:15<14:50,  2.06it/s] 13%|█▎        | 254/1954 [02:00<13:23,  2.12it/s] 13%|█▎        | 254/1954 [02:15<13:23,  2.12it/s] 20%|█▉        | 385/1954 [03:00<12:12,  2.14it/s] 20%|█▉        | 385/1954 [03:15<12:12,  2.14it/s] 26%|██▋       | 516/1954 [04:01<11:07,  2.15it/s] 26%|██▋       | 516/1954 [04:15<11:07,  2.15it/s] 33%|███▎      | 647/1954 [05:01<10:05,  2.16it/s] 33%|███▎      | 647/1954 [05:15<10:05,  2.16it/s] 40%|███▉      | 778/1954 [06:01<09:03,  2.16it/s] 40%|███▉      | 778/1954 [06:15<09:03,  2.16it/s] 47%|████▋     | 909/1954 [07:02<08:02,  2.16it/s] 47%|████▋     | 909/1954 [07:15<08:02,  2.16it/s] 53%|█████▎    | 1040/1954 [08:02<07:02,  2.17it/s] 53%|█████▎    | 1040/1954 [08:15<07:02,  2.17it/s] 60%|█████▉    | 1171/1954 [09:03<06:01,  2.17it/s] 60%|█████▉    | 1171/1954 [09:15<06:01,  2.17it/s] 67%|██████▋   | 1302/1954 [10:03<05:00,  2.17it/s] 67%|██████▋   | 1302/1954 [10:15<05:00,  2.17it/s] 73%|███████▎  | 1432/1954 [11:03<04:01,  2.17it/s] 73%|███████▎  | 1432/1954 [11:15<04:01,  2.17it/s] 80%|███████▉  | 1563/1954 [12:04<03:00,  2.17it/s] 80%|███████▉  | 1563/1954 [12:15<03:00,  2.17it/s] 87%|████████▋ | 1693/1954 [13:04<02:00,  2.17it/s] 87%|████████▋ | 1693/1954 [13:15<02:00,  2.17it/s] 93%|█████████▎| 1824/1954 [14:04<00:59,  2.17it/s] 93%|█████████▎| 1824/1954 [14:15<00:59,  2.17it/s]100%|██████████| 1954/1954 [15:03<00:00,  2.16it/s]
06/24/2024 15:34:12 - INFO - mingpt.trainer_atari -   train loss: 1.025246
target return: 3200, eval return: 2665
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 117/1954 [01:00<15:48,  1.94it/s]  6%|▌         | 117/1954 [01:15<15:48,  1.94it/s] 12%|█▏        | 234/1954 [02:00<14:46,  1.94it/s] 12%|█▏        | 234/1954 [02:15<14:46,  1.94it/s] 18%|█▊        | 351/1954 [03:00<13:44,  1.94it/s] 18%|█▊        | 351/1954 [03:15<13:44,  1.94it/s] 24%|██▍       | 469/1954 [04:01<12:42,  1.95it/s] 24%|██▍       | 469/1954 [04:15<12:42,  1.95it/s] 30%|███       | 587/1954 [05:01<11:41,  1.95it/s] 30%|███       | 587/1954 [05:15<11:41,  1.95it/s] 36%|███▌      | 705/1954 [06:01<10:40,  1.95it/s] 36%|███▌      | 705/1954 [06:15<10:40,  1.95it/s] 42%|████▏     | 823/1954 [07:02<09:39,  1.95it/s] 42%|████▏     | 823/1954 [07:15<09:39,  1.95it/s] 48%|████▊     | 940/1954 [08:02<08:40,  1.95it/s] 48%|████▊     | 940/1954 [08:15<08:40,  1.95it/s] 54%|█████▍    | 1058/1954 [09:02<07:39,  1.95it/s] 54%|█████▍    | 1058/1954 [09:15<07:39,  1.95it/s] 60%|██████    | 1175/1954 [10:02<06:39,  1.95it/s] 60%|██████    | 1175/1954 [10:15<06:39,  1.95it/s] 66%|██████▌   | 1292/1954 [11:03<05:39,  1.95it/s] 66%|██████▌   | 1292/1954 [11:15<05:39,  1.95it/s] 72%|███████▏  | 1409/1954 [12:03<04:39,  1.95it/s] 72%|███████▏  | 1409/1954 [12:15<04:39,  1.95it/s] 78%|███████▊  | 1526/1954 [13:03<03:39,  1.95it/s] 78%|███████▊  | 1526/1954 [13:15<03:39,  1.95it/s] 84%|████████▍ | 1644/1954 [14:03<02:39,  1.95it/s] 84%|████████▍ | 1644/1954 [14:15<02:39,  1.95it/s] 90%|█████████ | 1761/1954 [15:03<01:39,  1.95it/s] 90%|█████████ | 1761/1954 [15:15<01:39,  1.95it/s] 96%|█████████▌| 1876/1954 [16:04<00:40,  1.94it/s] 96%|█████████▌| 1876/1954 [16:15<00:40,  1.94it/s]100%|██████████| 1954/1954 [16:45<00:00,  1.94it/s]
06/24/2024 15:51:53 - INFO - mingpt.trainer_atari -   train loss: 0.946542
target return: 3200, eval return: 4612
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 115/1954 [01:00<16:05,  1.90it/s]  6%|▌         | 115/1954 [01:15<16:05,  1.90it/s] 12%|█▏        | 232/1954 [02:00<14:52,  1.93it/s] 12%|█▏        | 232/1954 [02:15<14:52,  1.93it/s] 18%|█▊        | 351/1954 [03:00<13:43,  1.95it/s] 18%|█▊        | 351/1954 [03:15<13:43,  1.95it/s] 24%|██▍       | 469/1954 [04:01<12:39,  1.95it/s] 24%|██▍       | 469/1954 [04:15<12:39,  1.95it/s] 30%|███       | 588/1954 [05:01<11:35,  1.96it/s] 30%|███       | 588/1954 [05:15<11:35,  1.96it/s] 36%|███▌      | 708/1954 [06:01<10:32,  1.97it/s] 36%|███▌      | 708/1954 [06:15<10:32,  1.97it/s] 42%|████▏     | 825/1954 [07:01<09:35,  1.96it/s] 42%|████▏     | 825/1954 [07:15<09:35,  1.96it/s] 48%|████▊     | 941/1954 [08:01<08:39,  1.95it/s] 48%|████▊     | 941/1954 [08:15<08:39,  1.95it/s] 54%|█████▍    | 1057/1954 [09:02<07:41,  1.94it/s] 54%|█████▍    | 1057/1954 [09:15<07:41,  1.94it/s] 60%|██████    | 1173/1954 [10:02<06:42,  1.94it/s] 60%|██████    | 1173/1954 [10:15<06:42,  1.94it/s] 66%|██████▌   | 1289/1954 [11:02<05:43,  1.94it/s] 66%|██████▌   | 1289/1954 [11:15<05:43,  1.94it/s] 72%|███████▏  | 1405/1954 [12:02<04:43,  1.93it/s] 72%|███████▏  | 1405/1954 [12:15<04:43,  1.93it/s] 78%|███████▊  | 1521/1954 [13:02<03:44,  1.93it/s] 78%|███████▊  | 1521/1954 [13:15<03:44,  1.93it/s] 84%|████████▎ | 1636/1954 [14:02<02:45,  1.93it/s] 84%|████████▎ | 1636/1954 [14:15<02:45,  1.93it/s] 90%|████████▉ | 1751/1954 [15:03<01:45,  1.92it/s] 90%|████████▉ | 1751/1954 [15:15<01:45,  1.92it/s] 95%|█████████▌| 1866/1954 [16:03<00:45,  1.92it/s] 95%|█████████▌| 1866/1954 [16:15<00:45,  1.92it/s]100%|██████████| 1954/1954 [16:49<00:00,  1.94it/s]
06/24/2024 16:09:47 - INFO - mingpt.trainer_atari -   train loss: 0.918603
target return: 3200, eval return: 6427
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 104/1954 [01:00<17:49,  1.73it/s]  5%|▌         | 104/1954 [01:11<17:49,  1.73it/s] 11%|█         | 208/1954 [02:00<16:53,  1.72it/s] 11%|█         | 208/1954 [02:11<16:53,  1.72it/s] 16%|█▌        | 312/1954 [03:01<15:52,  1.72it/s] 16%|█▌        | 312/1954 [03:11<15:52,  1.72it/s] 21%|██        | 411/1954 [04:01<15:13,  1.69it/s] 21%|██        | 411/1954 [04:21<15:13,  1.69it/s] 26%|██▋       | 514/1954 [05:01<14:08,  1.70it/s] 26%|██▋       | 514/1954 [05:21<14:08,  1.70it/s] 31%|███▏      | 613/1954 [06:01<13:19,  1.68it/s] 31%|███▏      | 613/1954 [06:21<13:19,  1.68it/s] 36%|███▋      | 712/1954 [07:02<12:25,  1.67it/s] 36%|███▋      | 712/1954 [07:21<12:25,  1.67it/s] 42%|████▏     | 816/1954 [08:02<11:16,  1.68it/s] 42%|████▏     | 816/1954 [08:21<11:16,  1.68it/s] 47%|████▋     | 914/1954 [09:02<10:24,  1.67it/s] 47%|████▋     | 914/1954 [09:21<10:24,  1.67it/s] 52%|█████▏    | 1013/1954 [10:03<09:27,  1.66it/s] 52%|█████▏    | 1013/1954 [10:21<09:27,  1.66it/s] 57%|█████▋    | 1111/1954 [11:03<08:31,  1.65it/s] 57%|█████▋    | 1111/1954 [11:21<08:31,  1.65it/s] 62%|██████▏   | 1209/1954 [12:03<07:33,  1.64it/s] 62%|██████▏   | 1209/1954 [12:21<07:33,  1.64it/s] 67%|██████▋   | 1307/1954 [13:03<06:34,  1.64it/s] 67%|██████▋   | 1307/1954 [13:21<06:34,  1.64it/s] 72%|███████▏  | 1405/1954 [14:03<05:35,  1.63it/s] 72%|███████▏  | 1405/1954 [14:21<05:35,  1.63it/s] 77%|███████▋  | 1504/1954 [15:04<04:35,  1.63it/s] 77%|███████▋  | 1504/1954 [15:21<04:35,  1.63it/s] 82%|████████▏ | 1603/1954 [16:05<03:34,  1.63it/s] 82%|████████▏ | 1603/1954 [16:21<03:34,  1.63it/s] 87%|████████▋ | 1702/1954 [17:05<02:34,  1.63it/s] 87%|████████▋ | 1702/1954 [17:21<02:34,  1.63it/s] 92%|█████████▏| 1800/1954 [18:05<01:34,  1.63it/s] 92%|█████████▏| 1800/1954 [18:21<01:34,  1.63it/s] 97%|█████████▋| 1898/1954 [19:05<00:34,  1.63it/s] 97%|█████████▋| 1898/1954 [19:21<00:34,  1.63it/s]100%|██████████| 1954/1954 [19:39<00:00,  1.66it/s]
06/24/2024 16:30:52 - INFO - mingpt.trainer_atari -   train loss: 0.894310
target return: 3200, eval return: 5805
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▍         | 96/1954 [01:00<19:28,  1.59it/s]  5%|▍         | 96/1954 [01:15<19:28,  1.59it/s] 10%|▉         | 191/1954 [02:00<18:33,  1.58it/s] 10%|▉         | 191/1954 [02:15<18:33,  1.58it/s] 15%|█▍        | 286/1954 [03:00<17:34,  1.58it/s] 15%|█▍        | 286/1954 [03:15<17:34,  1.58it/s] 20%|█▉        | 382/1954 [04:01<16:32,  1.58it/s] 20%|█▉        | 382/1954 [04:15<16:32,  1.58it/s] 24%|██▍       | 477/1954 [05:01<15:35,  1.58it/s] 24%|██▍       | 477/1954 [05:15<15:35,  1.58it/s] 29%|██▉       | 573/1954 [06:02<14:32,  1.58it/s] 29%|██▉       | 573/1954 [06:15<14:32,  1.58it/s] 34%|███▍      | 665/1954 [07:02<13:43,  1.57it/s] 34%|███▍      | 665/1954 [07:15<13:43,  1.57it/s] 39%|███▉      | 762/1954 [08:02<12:35,  1.58it/s] 39%|███▉      | 762/1954 [08:15<12:35,  1.58it/s] 44%|████▍     | 860/1954 [09:02<11:26,  1.59it/s] 44%|████▍     | 860/1954 [09:15<11:26,  1.59it/s] 49%|████▉     | 959/1954 [10:03<10:19,  1.61it/s] 49%|████▉     | 959/1954 [10:15<10:19,  1.61it/s] 54%|█████▍    | 1057/1954 [11:03<09:16,  1.61it/s] 54%|█████▍    | 1057/1954 [11:15<09:16,  1.61it/s] 59%|█████▉    | 1155/1954 [12:04<08:14,  1.61it/s] 59%|█████▉    | 1155/1954 [12:15<08:14,  1.61it/s] 64%|██████▍   | 1254/1954 [13:04<07:11,  1.62it/s] 64%|██████▍   | 1254/1954 [13:15<07:11,  1.62it/s] 69%|██████▉   | 1352/1954 [14:04<06:10,  1.62it/s] 69%|██████▉   | 1352/1954 [14:15<06:10,  1.62it/s] 74%|███████▍  | 1450/1954 [15:05<05:10,  1.62it/s] 74%|███████▍  | 1450/1954 [15:15<05:10,  1.62it/s] 79%|███████▉  | 1548/1954 [16:05<04:10,  1.62it/s] 79%|███████▉  | 1548/1954 [16:15<04:10,  1.62it/s] 84%|████████▍ | 1646/1954 [17:05<03:09,  1.62it/s] 84%|████████▍ | 1646/1954 [17:25<03:09,  1.62it/s] 89%|████████▉ | 1744/1954 [18:06<02:09,  1.62it/s] 89%|████████▉ | 1744/1954 [18:25<02:09,  1.62it/s] 94%|█████████▍| 1842/1954 [19:07<01:09,  1.62it/s] 94%|█████████▍| 1842/1954 [19:25<01:09,  1.62it/s] 99%|█████████▉| 1940/1954 [20:07<00:08,  1.62it/s]100%|██████████| 1954/1954 [20:15<00:00,  1.61it/s]
06/24/2024 16:52:23 - INFO - mingpt.trainer_atari -   train loss: 0.873657
target return: 3200, eval return: 6742
2024-06-24 16:54:01.536723: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 16:54:01.611422: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 16:54:06.154923: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▌        | 76700/500000 [01:06<06:04, 1159.86it/s] 21%|██        | 103006/500000 [01:20<05:42, 1159.86it/s] 32%|███▏      | 158314/500000 [02:10<04:40, 1217.77it/s] 37%|███▋      | 185639/500000 [02:30<04:18, 1217.77it/s] 48%|████▊     | 242412/500000 [03:16<03:25, 1251.58it/s] 54%|█████▎    | 268441/500000 [03:30<03:05, 1251.58it/s] 65%|██████▍   | 324566/500000 [04:20<02:19, 1258.03it/s] 71%|███████   | 353073/500000 [04:40<01:56, 1258.03it/s] 83%|████████▎ | 416584/500000 [05:26<01:03, 1306.51it/s] 87%|████████▋ | 432773/500000 [05:40<00:51, 1306.51it/s] 98%|█████████▊| 491873/500000 [06:30<00:06, 1267.15it/s]100%|██████████| 500000/500000 [06:31<00:00, 1277.20it/s]
06/24/2024 17:01:17 - INFO - mingpt.model_atari -   number of parameters: 1685632
this buffer has 8127 loaded transitions and there are now 500000 transitions total divided into 418 trajectories
max rtg is 590
max timestep is 3829
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 125/1954 [01:00<14:38,  2.08it/s]  6%|▋         | 125/1954 [01:15<14:38,  2.08it/s] 13%|█▎        | 257/1954 [02:00<13:11,  2.14it/s] 13%|█▎        | 257/1954 [02:15<13:11,  2.14it/s] 20%|█▉        | 389/1954 [03:00<12:02,  2.17it/s] 20%|█▉        | 389/1954 [03:15<12:02,  2.17it/s] 27%|██▋       | 521/1954 [04:00<10:57,  2.18it/s] 27%|██▋       | 521/1954 [04:15<10:57,  2.18it/s] 33%|███▎      | 653/1954 [05:00<09:55,  2.19it/s] 33%|███▎      | 653/1954 [05:15<09:55,  2.19it/s] 40%|████      | 786/1954 [06:01<08:53,  2.19it/s] 40%|████      | 786/1954 [06:15<08:53,  2.19it/s] 47%|████▋     | 918/1954 [07:01<07:52,  2.19it/s] 47%|████▋     | 918/1954 [07:15<07:52,  2.19it/s] 54%|█████▎    | 1050/1954 [08:01<06:52,  2.19it/s] 54%|█████▎    | 1050/1954 [08:15<06:52,  2.19it/s] 61%|██████    | 1183/1954 [09:01<05:51,  2.20it/s] 61%|██████    | 1183/1954 [09:15<05:51,  2.20it/s] 67%|██████▋   | 1315/1954 [10:01<04:50,  2.20it/s] 67%|██████▋   | 1315/1954 [10:15<04:50,  2.20it/s] 74%|███████▍  | 1447/1954 [11:02<03:50,  2.20it/s] 74%|███████▍  | 1447/1954 [11:15<03:50,  2.20it/s] 81%|████████  | 1580/1954 [12:02<02:50,  2.20it/s] 81%|████████  | 1580/1954 [12:15<02:50,  2.20it/s] 88%|████████▊ | 1712/1954 [13:02<01:50,  2.20it/s] 88%|████████▊ | 1712/1954 [13:15<01:50,  2.20it/s] 94%|█████████▍| 1843/1954 [14:02<00:50,  2.19it/s] 94%|█████████▍| 1843/1954 [14:15<00:50,  2.19it/s]100%|██████████| 1954/1954 [14:54<00:00,  2.19it/s]
06/24/2024 17:16:22 - INFO - mingpt.trainer_atari -   train loss: 1.013564
target return: 3200, eval return: 2725
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 128/1954 [01:00<14:22,  2.12it/s]  7%|▋         | 128/1954 [01:18<14:22,  2.12it/s] 13%|█▎        | 257/1954 [02:00<13:16,  2.13it/s] 13%|█▎        | 257/1954 [02:18<13:16,  2.13it/s] 20%|█▉        | 386/1954 [03:00<12:13,  2.14it/s] 20%|█▉        | 386/1954 [03:18<12:13,  2.14it/s] 26%|██▋       | 515/1954 [04:01<11:12,  2.14it/s] 26%|██▋       | 515/1954 [04:18<11:12,  2.14it/s] 33%|███▎      | 645/1954 [05:01<10:10,  2.14it/s] 33%|███▎      | 645/1954 [05:18<10:10,  2.14it/s] 40%|███▉      | 775/1954 [06:01<09:08,  2.15it/s] 40%|███▉      | 775/1954 [06:18<09:08,  2.15it/s] 46%|████▋     | 905/1954 [07:02<08:07,  2.15it/s] 46%|████▋     | 905/1954 [07:18<08:07,  2.15it/s] 53%|█████▎    | 1035/1954 [08:02<07:07,  2.15it/s] 53%|█████▎    | 1035/1954 [08:18<07:07,  2.15it/s] 60%|█████▉    | 1165/1954 [09:02<06:06,  2.15it/s] 60%|█████▉    | 1165/1954 [09:18<06:06,  2.15it/s] 66%|██████▋   | 1295/1954 [10:03<05:06,  2.15it/s] 66%|██████▋   | 1295/1954 [10:18<05:06,  2.15it/s] 73%|███████▎  | 1424/1954 [11:03<04:06,  2.15it/s] 73%|███████▎  | 1424/1954 [11:18<04:06,  2.15it/s] 80%|███████▉  | 1554/1954 [12:03<03:06,  2.15it/s] 80%|███████▉  | 1554/1954 [12:18<03:06,  2.15it/s] 86%|████████▌ | 1684/1954 [13:04<02:05,  2.15it/s] 86%|████████▌ | 1684/1954 [13:18<02:05,  2.15it/s] 93%|█████████▎| 1814/1954 [14:04<01:05,  2.15it/s] 93%|█████████▎| 1814/1954 [14:18<01:05,  2.15it/s] 99%|█████████▉| 1943/1954 [15:04<00:05,  2.15it/s]100%|██████████| 1954/1954 [15:09<00:00,  2.15it/s]
06/24/2024 17:32:25 - INFO - mingpt.trainer_atari -   train loss: 0.937104
target return: 3200, eval return: 1650
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 129/1954 [01:00<14:13,  2.14it/s]  7%|▋         | 129/1954 [01:16<14:13,  2.14it/s] 13%|█▎        | 259/1954 [02:00<13:09,  2.15it/s] 13%|█▎        | 259/1954 [02:16<13:09,  2.15it/s] 20%|█▉        | 389/1954 [03:00<12:06,  2.15it/s] 20%|█▉        | 389/1954 [03:16<12:06,  2.15it/s] 27%|██▋       | 519/1954 [04:01<11:05,  2.16it/s] 27%|██▋       | 519/1954 [04:16<11:05,  2.16it/s] 33%|███▎      | 649/1954 [05:01<10:05,  2.16it/s] 33%|███▎      | 649/1954 [05:16<10:05,  2.16it/s] 40%|███▉      | 779/1954 [06:01<09:05,  2.15it/s] 40%|███▉      | 779/1954 [06:16<09:05,  2.15it/s] 46%|████▌     | 903/1954 [07:01<08:14,  2.13it/s] 46%|████▌     | 903/1954 [07:16<08:14,  2.13it/s] 53%|█████▎    | 1033/1954 [08:02<07:11,  2.14it/s] 53%|█████▎    | 1033/1954 [08:16<07:11,  2.14it/s] 60%|█████▉    | 1167/1954 [09:02<06:03,  2.16it/s] 60%|█████▉    | 1167/1954 [09:16<06:03,  2.16it/s] 67%|██████▋   | 1301/1954 [10:02<04:59,  2.18it/s] 67%|██████▋   | 1301/1954 [10:16<04:59,  2.18it/s] 73%|███████▎  | 1435/1954 [11:02<03:56,  2.20it/s] 73%|███████▎  | 1435/1954 [11:16<03:56,  2.20it/s] 80%|████████  | 1571/1954 [12:02<02:52,  2.21it/s] 80%|████████  | 1571/1954 [12:16<02:52,  2.21it/s] 87%|████████▋ | 1707/1954 [13:03<01:50,  2.23it/s] 87%|████████▋ | 1707/1954 [13:16<01:50,  2.23it/s] 94%|█████████▍| 1840/1954 [14:03<00:51,  2.22it/s] 94%|█████████▍| 1840/1954 [14:16<00:51,  2.22it/s]100%|██████████| 1954/1954 [14:55<00:00,  2.18it/s]
06/24/2024 17:48:03 - INFO - mingpt.trainer_atari -   train loss: 0.911577
target return: 3200, eval return: 2340
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▍         | 96/1954 [01:00<19:25,  1.59it/s]  5%|▍         | 96/1954 [01:14<19:25,  1.59it/s] 10%|▉         | 193/1954 [02:00<18:20,  1.60it/s] 10%|▉         | 193/1954 [02:14<18:20,  1.60it/s] 15%|█▍        | 290/1954 [03:01<17:18,  1.60it/s] 15%|█▍        | 290/1954 [03:14<17:18,  1.60it/s] 20%|█▉        | 388/1954 [04:01<16:11,  1.61it/s] 20%|█▉        | 388/1954 [04:14<16:11,  1.61it/s] 25%|██▌       | 490/1954 [05:01<14:53,  1.64it/s] 25%|██▌       | 490/1954 [05:14<14:53,  1.64it/s] 30%|███       | 587/1954 [06:02<13:58,  1.63it/s] 30%|███       | 587/1954 [06:14<13:58,  1.63it/s] 35%|███▌      | 689/1954 [07:02<12:45,  1.65it/s] 35%|███▌      | 689/1954 [07:14<12:45,  1.65it/s] 40%|████      | 787/1954 [08:02<11:49,  1.64it/s] 40%|████      | 787/1954 [08:14<11:49,  1.64it/s] 46%|████▌     | 895/1954 [09:02<10:25,  1.69it/s] 46%|████▌     | 895/1954 [09:14<10:25,  1.69it/s] 52%|█████▏    | 1012/1954 [10:02<08:52,  1.77it/s] 52%|█████▏    | 1012/1954 [10:14<08:52,  1.77it/s] 58%|█████▊    | 1128/1954 [11:02<07:34,  1.82it/s] 58%|█████▊    | 1128/1954 [11:14<07:34,  1.82it/s] 64%|██████▎   | 1244/1954 [12:02<06:23,  1.85it/s] 64%|██████▎   | 1244/1954 [12:14<06:23,  1.85it/s] 70%|██████▉   | 1360/1954 [13:02<05:16,  1.88it/s] 70%|██████▉   | 1360/1954 [13:14<05:16,  1.88it/s] 76%|███████▌  | 1476/1954 [14:03<04:12,  1.89it/s] 76%|███████▌  | 1476/1954 [14:14<04:12,  1.89it/s] 81%|████████▏ | 1592/1954 [15:03<03:10,  1.90it/s] 81%|████████▏ | 1592/1954 [15:14<03:10,  1.90it/s] 87%|████████▋ | 1708/1954 [16:03<02:08,  1.91it/s] 87%|████████▋ | 1708/1954 [16:14<02:08,  1.91it/s] 93%|█████████▎| 1813/1954 [17:03<01:15,  1.86it/s] 93%|█████████▎| 1813/1954 [17:14<01:15,  1.86it/s] 98%|█████████▊| 1909/1954 [18:04<00:25,  1.78it/s] 98%|█████████▊| 1909/1954 [18:14<00:25,  1.78it/s]100%|██████████| 1954/1954 [18:31<00:00,  1.76it/s]
06/24/2024 18:07:21 - INFO - mingpt.trainer_atari -   train loss: 0.889654
target return: 3200, eval return: 4710
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 99/1954 [01:00<18:54,  1.63it/s]  5%|▌         | 99/1954 [01:11<18:54,  1.63it/s] 10%|█         | 199/1954 [02:00<17:45,  1.65it/s] 10%|█         | 199/1954 [02:11<17:45,  1.65it/s] 15%|█▌        | 299/1954 [03:01<16:40,  1.65it/s] 15%|█▌        | 299/1954 [03:11<16:40,  1.65it/s] 20%|██        | 400/1954 [04:01<15:34,  1.66it/s] 20%|██        | 400/1954 [04:21<15:34,  1.66it/s] 26%|██▌       | 499/1954 [05:01<14:39,  1.65it/s] 26%|██▌       | 499/1954 [05:21<14:39,  1.65it/s] 31%|███       | 597/1954 [06:01<13:43,  1.65it/s] 31%|███       | 597/1954 [06:21<13:43,  1.65it/s] 36%|███▌      | 695/1954 [07:01<12:46,  1.64it/s] 36%|███▌      | 695/1954 [07:21<12:46,  1.64it/s] 41%|████      | 793/1954 [08:01<11:48,  1.64it/s] 41%|████      | 793/1954 [08:21<11:48,  1.64it/s] 46%|████▌     | 891/1954 [09:02<10:49,  1.64it/s] 46%|████▌     | 891/1954 [09:21<10:49,  1.64it/s] 51%|█████     | 989/1954 [10:02<09:51,  1.63it/s] 51%|█████     | 989/1954 [10:21<09:51,  1.63it/s] 56%|█████▌    | 1087/1954 [11:02<08:52,  1.63it/s] 56%|█████▌    | 1087/1954 [11:21<08:52,  1.63it/s] 61%|██████    | 1184/1954 [12:02<07:54,  1.62it/s] 61%|██████    | 1184/1954 [12:21<07:54,  1.62it/s] 66%|██████▌   | 1280/1954 [13:03<06:57,  1.61it/s] 66%|██████▌   | 1280/1954 [13:21<06:57,  1.61it/s] 70%|███████   | 1375/1954 [14:03<06:01,  1.60it/s] 70%|███████   | 1375/1954 [14:21<06:01,  1.60it/s] 75%|███████▌  | 1470/1954 [15:03<05:03,  1.59it/s] 75%|███████▌  | 1470/1954 [15:21<05:03,  1.59it/s] 80%|████████  | 1565/1954 [16:04<04:04,  1.59it/s] 80%|████████  | 1565/1954 [16:21<04:04,  1.59it/s] 85%|████████▍ | 1660/1954 [17:04<03:05,  1.59it/s] 85%|████████▍ | 1660/1954 [17:21<03:05,  1.59it/s] 90%|████████▉ | 1755/1954 [18:04<02:05,  1.58it/s] 90%|████████▉ | 1755/1954 [18:21<02:05,  1.58it/s] 95%|█████████▍| 1850/1954 [19:04<01:05,  1.58it/s] 95%|█████████▍| 1850/1954 [19:21<01:05,  1.58it/s]100%|█████████▉| 1945/1954 [20:04<00:05,  1.58it/s]100%|██████████| 1954/1954 [20:10<00:00,  1.61it/s]
06/24/2024 18:28:33 - INFO - mingpt.trainer_atari -   train loss: 0.871225
target return: 3200, eval return: 3437
2024-06-24 18:29:43.749782: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-24 18:29:43.825651: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-24 18:29:47.864370: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 14%|█▍        | 69712/500000 [01:05<06:42, 1069.51it/s] 19%|█▊        | 93111/500000 [01:20<06:20, 1069.51it/s] 30%|███       | 150424/500000 [02:09<04:57, 1176.25it/s] 34%|███▍      | 169772/500000 [02:20<04:40, 1176.25it/s] 46%|████▌     | 230997/500000 [03:14<03:42, 1208.02it/s] 51%|█████     | 252952/500000 [03:30<03:24, 1208.02it/s] 62%|██████▏   | 308742/500000 [04:18<02:38, 1210.10it/s] 67%|██████▋   | 333606/500000 [04:30<02:17, 1210.10it/s] 75%|███████▌  | 376365/500000 [05:20<01:46, 1166.30it/s] 81%|████████▏ | 406871/500000 [05:40<01:19, 1166.30it/s] 92%|█████████▏| 457862/500000 [06:25<00:35, 1200.79it/s] 97%|█████████▋| 482893/500000 [06:40<00:14, 1200.79it/s]100%|██████████| 500000/500000 [06:53<00:00, 1208.15it/s]
06/24/2024 18:37:19 - INFO - mingpt.model_atari -   number of parameters: 1617280
this buffer has 15668 loaded transitions and there are now 500000 transitions total divided into 444 trajectories
max rtg is 494
max timestep is 3295
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 122/1954 [01:00<15:06,  2.02it/s]  6%|▌         | 122/1954 [01:14<15:06,  2.02it/s] 13%|█▎        | 250/1954 [02:00<13:37,  2.08it/s] 13%|█▎        | 250/1954 [02:14<13:37,  2.08it/s] 19%|█▉        | 379/1954 [03:00<12:27,  2.11it/s] 19%|█▉        | 379/1954 [03:14<12:27,  2.11it/s] 26%|██▌       | 507/1954 [04:01<11:24,  2.12it/s] 26%|██▌       | 507/1954 [04:14<11:24,  2.12it/s] 32%|███▏      | 635/1954 [05:01<10:21,  2.12it/s] 32%|███▏      | 635/1954 [05:14<10:21,  2.12it/s] 39%|███▉      | 763/1954 [06:01<09:21,  2.12it/s] 39%|███▉      | 763/1954 [06:14<09:21,  2.12it/s] 46%|████▌     | 890/1954 [07:01<08:23,  2.11it/s] 46%|████▌     | 890/1954 [07:14<08:23,  2.11it/s] 52%|█████▏    | 1016/1954 [08:02<07:24,  2.11it/s] 52%|█████▏    | 1016/1954 [08:14<07:24,  2.11it/s] 58%|█████▊    | 1142/1954 [09:02<06:25,  2.10it/s] 58%|█████▊    | 1142/1954 [09:14<06:25,  2.10it/s] 65%|██████▍   | 1268/1954 [10:02<05:26,  2.10it/s] 65%|██████▍   | 1268/1954 [10:14<05:26,  2.10it/s] 71%|███████▏  | 1395/1954 [11:02<04:25,  2.10it/s] 71%|███████▏  | 1395/1954 [11:14<04:25,  2.10it/s] 78%|███████▊  | 1522/1954 [12:03<03:25,  2.10it/s] 78%|███████▊  | 1522/1954 [12:14<03:25,  2.10it/s] 84%|████████▍ | 1649/1954 [13:03<02:25,  2.10it/s] 84%|████████▍ | 1649/1954 [13:14<02:25,  2.10it/s] 91%|█████████ | 1776/1954 [14:03<01:24,  2.10it/s] 91%|█████████ | 1776/1954 [14:14<01:24,  2.10it/s] 97%|█████████▋| 1903/1954 [15:04<00:24,  2.10it/s] 97%|█████████▋| 1903/1954 [15:14<00:24,  2.10it/s]100%|██████████| 1954/1954 [15:28<00:00,  2.11it/s]
06/24/2024 18:52:59 - INFO - mingpt.trainer_atari -   train loss: 1.036224
target return: 3200, eval return: 1207
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 126/1954 [01:00<14:33,  2.09it/s]  6%|▋         | 126/1954 [01:16<14:33,  2.09it/s] 13%|█▎        | 254/1954 [02:00<13:24,  2.11it/s] 13%|█▎        | 254/1954 [02:16<13:24,  2.11it/s] 20%|█▉        | 382/1954 [03:00<12:20,  2.12it/s] 20%|█▉        | 382/1954 [03:16<12:20,  2.12it/s] 26%|██▌       | 511/1954 [04:00<11:18,  2.13it/s] 26%|██▌       | 511/1954 [04:16<11:18,  2.13it/s] 33%|███▎      | 640/1954 [05:01<10:16,  2.13it/s] 33%|███▎      | 640/1954 [05:16<10:16,  2.13it/s] 39%|███▉      | 769/1954 [06:01<09:15,  2.13it/s] 39%|███▉      | 769/1954 [06:16<09:15,  2.13it/s] 46%|████▌     | 897/1954 [07:01<08:15,  2.13it/s] 46%|████▌     | 897/1954 [07:16<08:15,  2.13it/s] 53%|█████▎    | 1026/1954 [08:02<07:14,  2.13it/s] 53%|█████▎    | 1026/1954 [08:16<07:14,  2.13it/s] 59%|█████▉    | 1155/1954 [09:02<06:14,  2.13it/s] 59%|█████▉    | 1155/1954 [09:16<06:14,  2.13it/s] 66%|██████▌   | 1282/1954 [10:02<05:15,  2.13it/s] 66%|██████▌   | 1282/1954 [10:16<05:15,  2.13it/s] 72%|███████▏  | 1410/1954 [11:02<04:15,  2.13it/s] 72%|███████▏  | 1410/1954 [11:16<04:15,  2.13it/s] 79%|███████▉  | 1539/1954 [12:02<03:14,  2.13it/s] 79%|███████▉  | 1539/1954 [12:16<03:14,  2.13it/s] 85%|████████▌ | 1668/1954 [13:03<02:14,  2.13it/s] 85%|████████▌ | 1668/1954 [13:16<02:14,  2.13it/s] 92%|█████████▏| 1796/1954 [14:03<01:14,  2.13it/s] 92%|█████████▏| 1796/1954 [14:16<01:14,  2.13it/s] 98%|█████████▊| 1924/1954 [15:03<00:14,  2.13it/s] 98%|█████████▊| 1924/1954 [15:16<00:14,  2.13it/s]100%|██████████| 1954/1954 [15:17<00:00,  2.13it/s]
06/24/2024 19:08:56 - INFO - mingpt.trainer_atari -   train loss: 0.950952
target return: 3200, eval return: 2297
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:24,  2.11it/s]  6%|▋         | 127/1954 [01:13<14:24,  2.11it/s] 13%|█▎        | 255/1954 [02:00<13:21,  2.12it/s] 13%|█▎        | 255/1954 [02:13<13:21,  2.12it/s] 20%|█▉        | 383/1954 [03:00<12:19,  2.12it/s] 20%|█▉        | 383/1954 [03:13<12:19,  2.12it/s] 26%|██▌       | 511/1954 [04:00<11:19,  2.12it/s] 26%|██▌       | 511/1954 [04:13<11:19,  2.12it/s] 33%|███▎      | 640/1954 [05:00<10:16,  2.13it/s] 33%|███▎      | 640/1954 [05:13<10:16,  2.13it/s] 39%|███▉      | 769/1954 [06:01<09:15,  2.14it/s] 39%|███▉      | 769/1954 [06:13<09:15,  2.14it/s] 46%|████▌     | 898/1954 [07:01<08:14,  2.14it/s] 46%|████▌     | 898/1954 [07:13<08:14,  2.14it/s] 53%|█████▎    | 1027/1954 [08:01<07:14,  2.13it/s] 53%|█████▎    | 1027/1954 [08:13<07:14,  2.13it/s] 59%|█████▉    | 1156/1954 [09:02<06:13,  2.14it/s] 59%|█████▉    | 1156/1954 [09:13<06:13,  2.14it/s] 66%|██████▌   | 1285/1954 [10:02<05:12,  2.14it/s] 66%|██████▌   | 1285/1954 [10:13<05:12,  2.14it/s] 72%|███████▏  | 1414/1954 [11:02<04:12,  2.14it/s] 72%|███████▏  | 1414/1954 [11:13<04:12,  2.14it/s] 79%|███████▉  | 1544/1954 [12:03<03:11,  2.14it/s] 79%|███████▉  | 1544/1954 [12:13<03:11,  2.14it/s] 86%|████████▌ | 1674/1954 [13:03<02:10,  2.15it/s] 86%|████████▌ | 1674/1954 [13:23<02:10,  2.15it/s] 92%|█████████▏| 1803/1954 [14:03<01:10,  2.15it/s] 92%|█████████▏| 1803/1954 [14:23<01:10,  2.15it/s] 99%|█████████▉| 1932/1954 [15:03<00:10,  2.14it/s]100%|██████████| 1954/1954 [15:13<00:00,  2.14it/s]
06/24/2024 19:24:56 - INFO - mingpt.trainer_atari -   train loss: 0.921591
target return: 3200, eval return: 2670
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 126/1954 [01:00<14:33,  2.09it/s]  6%|▋         | 126/1954 [01:18<14:33,  2.09it/s] 13%|█▎        | 251/1954 [02:00<13:37,  2.08it/s] 13%|█▎        | 251/1954 [02:18<13:37,  2.08it/s] 19%|█▉        | 381/1954 [03:00<12:22,  2.12it/s] 19%|█▉        | 381/1954 [03:18<12:22,  2.12it/s] 26%|██▋       | 514/1954 [04:00<11:08,  2.15it/s] 26%|██▋       | 514/1954 [04:18<11:08,  2.15it/s] 33%|███▎      | 649/1954 [05:01<09:57,  2.19it/s] 33%|███▎      | 649/1954 [05:18<09:57,  2.19it/s] 40%|████      | 783/1954 [06:01<08:52,  2.20it/s] 40%|████      | 783/1954 [06:18<08:52,  2.20it/s] 47%|████▋     | 918/1954 [07:01<07:47,  2.22it/s] 47%|████▋     | 918/1954 [07:18<07:47,  2.22it/s] 53%|█████▎    | 1045/1954 [08:01<06:56,  2.18it/s] 53%|█████▎    | 1045/1954 [08:18<06:56,  2.18it/s] 60%|██████    | 1176/1954 [09:01<05:57,  2.18it/s] 60%|██████    | 1176/1954 [09:18<05:57,  2.18it/s] 67%|██████▋   | 1308/1954 [10:02<04:56,  2.18it/s] 67%|██████▋   | 1308/1954 [10:18<04:56,  2.18it/s] 74%|███████▎  | 1441/1954 [11:02<03:54,  2.19it/s] 74%|███████▎  | 1441/1954 [11:18<03:54,  2.19it/s] 81%|████████  | 1574/1954 [12:02<02:53,  2.20it/s] 81%|████████  | 1574/1954 [12:18<02:53,  2.20it/s] 87%|████████▋ | 1707/1954 [13:02<01:52,  2.20it/s] 87%|████████▋ | 1707/1954 [13:18<01:52,  2.20it/s] 94%|█████████▍| 1840/1954 [14:03<00:51,  2.20it/s] 94%|█████████▍| 1840/1954 [14:18<00:51,  2.20it/s]100%|██████████| 1954/1954 [14:54<00:00,  2.19it/s]
06/24/2024 19:40:41 - INFO - mingpt.trainer_atari -   train loss: 0.896990
target return: 3200, eval return: 2247
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 98/1954 [01:00<19:08,  1.62it/s]  5%|▌         | 98/1954 [01:11<19:08,  1.62it/s] 10%|▉         | 192/1954 [02:01<18:34,  1.58it/s] 10%|▉         | 192/1954 [02:11<18:34,  1.58it/s] 15%|█▍        | 286/1954 [03:01<17:40,  1.57it/s] 15%|█▍        | 286/1954 [03:11<17:40,  1.57it/s] 19%|█▉        | 380/1954 [04:01<16:43,  1.57it/s] 19%|█▉        | 380/1954 [04:21<16:43,  1.57it/s] 24%|██▍       | 474/1954 [05:01<15:45,  1.57it/s] 24%|██▍       | 474/1954 [05:21<15:45,  1.57it/s] 29%|██▉       | 568/1954 [06:01<14:45,  1.57it/s] 29%|██▉       | 568/1954 [06:21<14:45,  1.57it/s] 34%|███▍      | 663/1954 [07:02<13:43,  1.57it/s] 34%|███▍      | 663/1954 [07:21<13:43,  1.57it/s] 39%|███▉      | 758/1954 [08:02<12:41,  1.57it/s] 39%|███▉      | 758/1954 [08:21<12:41,  1.57it/s] 44%|████▎     | 854/1954 [09:02<11:37,  1.58it/s] 44%|████▎     | 854/1954 [09:21<11:37,  1.58it/s] 49%|████▊     | 949/1954 [10:02<10:37,  1.58it/s] 49%|████▊     | 949/1954 [10:21<10:37,  1.58it/s] 53%|█████▎    | 1044/1954 [11:03<09:37,  1.58it/s] 53%|█████▎    | 1044/1954 [11:21<09:37,  1.58it/s] 58%|█████▊    | 1139/1954 [12:03<08:36,  1.58it/s] 58%|█████▊    | 1139/1954 [12:21<08:36,  1.58it/s] 63%|██████▎   | 1234/1954 [13:03<07:36,  1.58it/s] 63%|██████▎   | 1234/1954 [13:21<07:36,  1.58it/s] 68%|██████▊   | 1329/1954 [14:03<06:35,  1.58it/s] 68%|██████▊   | 1329/1954 [14:21<06:35,  1.58it/s] 73%|███████▎  | 1425/1954 [15:04<05:34,  1.58it/s] 73%|███████▎  | 1425/1954 [15:21<05:34,  1.58it/s] 78%|███████▊  | 1520/1954 [16:04<04:34,  1.58it/s] 78%|███████▊  | 1520/1954 [16:21<04:34,  1.58it/s] 83%|████████▎ | 1615/1954 [17:04<03:34,  1.58it/s] 83%|████████▎ | 1615/1954 [17:21<03:34,  1.58it/s] 88%|████████▊ | 1710/1954 [18:04<02:34,  1.58it/s] 88%|████████▊ | 1710/1954 [18:21<02:34,  1.58it/s] 92%|█████████▏| 1805/1954 [19:04<01:34,  1.58it/s] 92%|█████████▏| 1805/1954 [19:21<01:34,  1.58it/s] 97%|█████████▋| 1900/1954 [20:04<00:34,  1.58it/s] 97%|█████████▋| 1900/1954 [20:21<00:34,  1.58it/s]100%|██████████| 1954/1954 [20:38<00:00,  1.58it/s]
06/24/2024 20:02:13 - INFO - mingpt.trainer_atari -   train loss: 0.876671
target return: 3200, eval return: 3785
