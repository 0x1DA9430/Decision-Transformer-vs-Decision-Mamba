CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 0
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-16 07:02:15.173330: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-16 07:02:15.923054: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-16 07:02:19.905330: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 20%|█▉        | 98389/500000 [01:01<04:12, 1587.93it/s] 32%|███▏      | 157636/500000 [01:19<03:35, 1587.93it/s] 53%|█████▎    | 262646/500000 [02:01<01:45, 2255.24it/s] 61%|██████    | 305772/500000 [02:19<01:26, 2255.24it/s] 82%|████████▏ | 408967/500000 [03:08<00:40, 2229.88it/s] 85%|████████▌ | 426618/500000 [03:19<00:32, 2229.88it/s]100%|██████████| 500000/500000 [03:57<00:00, 2102.93it/s]
07/16/2024 07:10:26 - INFO - mingpt.model_atari - number of parameters: 4654848
this buffer has 59023 loaded transitions and there are now 500000 transitions total divided into 174 trajectories
max rtg is 32
max timestep is 27002
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 122/1954 [01:00<15:05,  2.02it/s]  6%|▌         | 122/1954 [01:11<15:05,  2.02it/s] 13%|█▎        | 253/1954 [02:00<13:26,  2.11it/s] 13%|█▎        | 253/1954 [02:11<13:26,  2.11it/s] 20%|█▉        | 384/1954 [03:00<12:13,  2.14it/s] 20%|█▉        | 384/1954 [03:11<12:13,  2.14it/s] 26%|██▋       | 516/1954 [04:01<11:06,  2.16it/s] 26%|██▋       | 516/1954 [04:21<11:06,  2.16it/s] 33%|███▎      | 648/1954 [05:01<10:01,  2.17it/s] 33%|███▎      | 648/1954 [05:21<10:01,  2.17it/s] 40%|███▉      | 780/1954 [06:01<08:58,  2.18it/s] 40%|███▉      | 780/1954 [06:21<08:58,  2.18it/s] 47%|████▋     | 912/1954 [07:01<07:57,  2.18it/s] 47%|████▋     | 912/1954 [07:21<07:57,  2.18it/s] 53%|█████▎    | 1044/1954 [08:01<06:56,  2.19it/s] 53%|█████▎    | 1044/1954 [08:21<06:56,  2.19it/s] 60%|██████    | 1176/1954 [09:02<05:55,  2.19it/s] 60%|██████    | 1176/1954 [09:21<05:55,  2.19it/s] 67%|██████▋   | 1308/1954 [10:02<04:55,  2.19it/s] 67%|██████▋   | 1308/1954 [10:21<04:55,  2.19it/s] 74%|███████▎  | 1440/1954 [11:02<03:54,  2.19it/s] 74%|███████▎  | 1440/1954 [11:21<03:54,  2.19it/s] 80%|████████  | 1572/1954 [12:02<02:54,  2.19it/s] 80%|████████  | 1572/1954 [12:21<02:54,  2.19it/s] 87%|████████▋ | 1704/1954 [13:03<01:54,  2.19it/s] 87%|████████▋ | 1704/1954 [13:21<01:54,  2.19it/s] 94%|█████████▍| 1836/1954 [14:03<00:53,  2.19it/s] 94%|█████████▍| 1836/1954 [14:21<00:53,  2.19it/s]100%|██████████| 1954/1954 [14:57<00:00,  2.18it/s]
07/16/2024 07:25:34 - INFO - mingpt.trainer_atari - train loss: 1.314694
target return: 160, eval return: 1600
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 146/1954 [01:00<12:24,  2.43it/s]  7%|▋         | 146/1954 [01:15<12:24,  2.43it/s] 15%|█▌        | 294/1954 [02:00<11:19,  2.44it/s] 15%|█▌        | 294/1954 [02:15<11:19,  2.44it/s] 23%|██▎       | 442/1954 [03:00<10:17,  2.45it/s] 23%|██▎       | 442/1954 [03:15<10:17,  2.45it/s] 30%|███       | 590/1954 [04:00<09:15,  2.45it/s] 30%|███       | 590/1954 [04:15<09:15,  2.45it/s] 38%|███▊      | 738/1954 [05:01<08:15,  2.45it/s] 38%|███▊      | 738/1954 [05:15<08:15,  2.45it/s] 45%|████▌     | 887/1954 [06:01<07:13,  2.46it/s] 45%|████▌     | 887/1954 [06:15<07:13,  2.46it/s] 53%|█████▎    | 1036/1954 [07:01<06:11,  2.47it/s] 53%|█████▎    | 1036/1954 [07:15<06:11,  2.47it/s] 61%|██████    | 1185/1954 [08:01<05:11,  2.47it/s] 61%|██████    | 1185/1954 [08:15<05:11,  2.47it/s] 68%|██████▊   | 1334/1954 [09:01<04:11,  2.47it/s] 68%|██████▊   | 1334/1954 [09:15<04:11,  2.47it/s] 76%|███████▌  | 1483/1954 [10:02<03:10,  2.47it/s] 76%|███████▌  | 1483/1954 [10:15<03:10,  2.47it/s] 84%|████████▎ | 1632/1954 [11:02<02:10,  2.47it/s] 84%|████████▎ | 1632/1954 [11:15<02:10,  2.47it/s] 91%|█████████ | 1781/1954 [12:02<01:10,  2.47it/s] 91%|█████████ | 1781/1954 [12:15<01:10,  2.47it/s] 99%|█████████▉| 1930/1954 [13:03<00:09,  2.47it/s]100%|██████████| 1954/1954 [13:12<00:00,  2.47it/s]
07/16/2024 07:41:55 - INFO - mingpt.trainer_atari - train loss: 1.199826
target return: 160, eval return: 2800
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 143/1954 [01:00<12:42,  2.38it/s]  7%|▋         | 143/1954 [01:12<12:42,  2.38it/s] 15%|█▍        | 288/1954 [02:00<11:36,  2.39it/s] 15%|█▍        | 288/1954 [02:12<11:36,  2.39it/s] 22%|██▏       | 433/1954 [03:00<10:33,  2.40it/s] 22%|██▏       | 433/1954 [03:12<10:33,  2.40it/s] 30%|██▉       | 578/1954 [04:00<09:32,  2.41it/s] 30%|██▉       | 578/1954 [04:12<09:32,  2.41it/s] 37%|███▋      | 723/1954 [05:01<08:31,  2.41it/s] 37%|███▋      | 723/1954 [05:12<08:31,  2.41it/s] 44%|████▍     | 869/1954 [06:01<07:29,  2.41it/s] 44%|████▍     | 869/1954 [06:12<07:29,  2.41it/s] 52%|█████▏    | 1015/1954 [07:01<06:28,  2.42it/s] 52%|█████▏    | 1015/1954 [07:12<06:28,  2.42it/s] 59%|█████▉    | 1161/1954 [08:01<05:28,  2.42it/s] 59%|█████▉    | 1161/1954 [08:12<05:28,  2.42it/s] 67%|██████▋   | 1306/1954 [09:01<04:28,  2.42it/s] 67%|██████▋   | 1306/1954 [09:12<04:28,  2.42it/s] 74%|███████▍  | 1452/1954 [10:02<03:27,  2.42it/s] 74%|███████▍  | 1452/1954 [10:12<03:27,  2.42it/s] 82%|████████▏ | 1598/1954 [11:02<02:27,  2.42it/s] 82%|████████▏ | 1598/1954 [11:12<02:27,  2.42it/s] 89%|████████▉ | 1744/1954 [12:02<01:26,  2.42it/s] 89%|████████▉ | 1744/1954 [12:22<01:26,  2.42it/s] 97%|█████████▋| 1890/1954 [13:03<00:26,  2.42it/s] 97%|█████████▋| 1890/1954 [13:22<00:26,  2.42it/s]100%|██████████| 1954/1954 [13:29<00:00,  2.41it/s]
07/16/2024 07:59:05 - INFO - mingpt.trainer_atari - train loss: 1.156911
target return: 160, eval return: 5000
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 108/1954 [01:00<17:13,  1.79it/s]  6%|▌         | 108/1954 [01:18<17:13,  1.79it/s] 11%|█         | 216/1954 [02:00<16:12,  1.79it/s] 11%|█         | 216/1954 [02:18<16:12,  1.79it/s] 17%|█▋        | 324/1954 [03:01<15:11,  1.79it/s] 17%|█▋        | 324/1954 [03:18<15:11,  1.79it/s] 22%|██▏       | 432/1954 [04:01<14:10,  1.79it/s] 22%|██▏       | 432/1954 [04:18<14:10,  1.79it/s] 28%|██▊       | 540/1954 [05:01<13:10,  1.79it/s] 28%|██▊       | 540/1954 [05:18<13:10,  1.79it/s] 33%|███▎      | 648/1954 [06:02<12:10,  1.79it/s] 33%|███▎      | 648/1954 [06:18<12:10,  1.79it/s] 39%|███▊      | 755/1954 [07:02<11:11,  1.79it/s] 39%|███▊      | 755/1954 [07:18<11:11,  1.79it/s] 44%|████▍     | 863/1954 [08:02<10:10,  1.79it/s] 44%|████▍     | 863/1954 [08:18<10:10,  1.79it/s] 50%|████▉     | 971/1954 [09:03<09:09,  1.79it/s] 50%|████▉     | 971/1954 [09:18<09:09,  1.79it/s] 55%|█████▌    | 1079/1954 [10:03<08:09,  1.79it/s] 55%|█████▌    | 1079/1954 [10:18<08:09,  1.79it/s] 61%|██████    | 1187/1954 [11:03<07:08,  1.79it/s] 61%|██████    | 1187/1954 [11:18<07:08,  1.79it/s] 66%|██████▋   | 1295/1954 [12:04<06:08,  1.79it/s] 66%|██████▋   | 1295/1954 [12:18<06:08,  1.79it/s] 72%|███████▏  | 1403/1954 [13:04<05:08,  1.79it/s] 72%|███████▏  | 1403/1954 [13:18<05:08,  1.79it/s] 77%|███████▋  | 1511/1954 [14:04<04:07,  1.79it/s] 77%|███████▋  | 1511/1954 [14:18<04:07,  1.79it/s] 83%|████████▎ | 1619/1954 [15:05<03:07,  1.79it/s] 83%|████████▎ | 1619/1954 [15:18<03:07,  1.79it/s] 88%|████████▊ | 1727/1954 [16:05<02:07,  1.79it/s] 88%|████████▊ | 1727/1954 [16:18<02:07,  1.79it/s] 94%|█████████▍| 1834/1954 [17:06<01:07,  1.78it/s] 94%|█████████▍| 1834/1954 [17:18<01:07,  1.78it/s] 99%|█████████▉| 1941/1954 [18:06<00:07,  1.78it/s]100%|██████████| 1954/1954 [18:13<00:00,  1.79it/s]
07/16/2024 08:21:33 - INFO - mingpt.trainer_atari - train loss: 1.124889
target return: 160, eval return: 5000
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 107/1954 [01:00<17:22,  1.77it/s]  5%|▌         | 107/1954 [01:10<17:22,  1.77it/s] 11%|█         | 214/1954 [02:00<16:18,  1.78it/s] 11%|█         | 214/1954 [02:10<16:18,  1.78it/s] 16%|█▋        | 322/1954 [03:00<15:16,  1.78it/s] 16%|█▋        | 322/1954 [03:20<15:16,  1.78it/s] 22%|██▏       | 430/1954 [04:01<14:14,  1.78it/s] 22%|██▏       | 430/1954 [04:20<14:14,  1.78it/s] 27%|██▋       | 535/1954 [05:01<13:23,  1.77it/s] 27%|██▋       | 535/1954 [05:20<13:23,  1.77it/s] 33%|███▎      | 641/1954 [06:02<12:25,  1.76it/s] 33%|███▎      | 641/1954 [06:20<12:25,  1.76it/s] 38%|███▊      | 746/1954 [07:02<11:27,  1.76it/s] 38%|███▊      | 746/1954 [07:20<11:27,  1.76it/s] 44%|████▎     | 852/1954 [08:02<10:27,  1.76it/s] 44%|████▎     | 852/1954 [08:20<10:27,  1.76it/s] 49%|████▉     | 955/1954 [09:03<09:33,  1.74it/s] 49%|████▉     | 955/1954 [09:20<09:33,  1.74it/s] 54%|█████▍    | 1060/1954 [10:03<08:33,  1.74it/s] 54%|█████▍    | 1060/1954 [10:20<08:33,  1.74it/s] 60%|█████▉    | 1164/1954 [11:03<07:35,  1.74it/s] 60%|█████▉    | 1164/1954 [11:20<07:35,  1.74it/s] 65%|██████▍   | 1264/1954 [12:04<06:43,  1.71it/s] 65%|██████▍   | 1264/1954 [12:20<06:43,  1.71it/s] 70%|██████▉   | 1364/1954 [13:04<05:47,  1.70it/s] 70%|██████▉   | 1364/1954 [13:20<05:47,  1.70it/s] 75%|███████▍  | 1464/1954 [14:05<04:51,  1.68it/s] 75%|███████▍  | 1464/1954 [14:20<04:51,  1.68it/s] 80%|███████▉  | 1563/1954 [15:05<03:53,  1.67it/s] 80%|███████▉  | 1563/1954 [15:20<03:53,  1.67it/s] 85%|████████▌ | 1662/1954 [16:05<02:55,  1.66it/s] 85%|████████▌ | 1662/1954 [16:20<02:55,  1.66it/s] 90%|█████████ | 1767/1954 [17:06<01:50,  1.69it/s] 90%|█████████ | 1767/1954 [17:20<01:50,  1.69it/s] 96%|█████████▌| 1873/1954 [18:06<00:47,  1.71it/s] 96%|█████████▌| 1873/1954 [18:20<00:47,  1.71it/s]100%|██████████| 1954/1954 [18:52<00:00,  1.73it/s]
07/16/2024 08:44:10 - INFO - mingpt.trainer_atari - train loss: 1.105044
target return: 160, eval return: 7700
2024-07-16 08:48:11.485724: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-16 08:48:12.204678: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-16 08:48:16.037006: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 24%|██▍       | 118972/500000 [01:04<03:27, 1840.39it/s] 31%|███▏      | 156470/500000 [01:20<03:06, 1840.39it/s] 44%|████▍     | 220586/500000 [02:04<02:39, 1756.69it/s] 50%|█████     | 251523/500000 [02:20<02:21, 1756.69it/s] 67%|██████▋   | 336314/500000 [03:06<01:30, 1802.59it/s] 73%|███████▎  | 364803/500000 [03:20<01:15, 1802.59it/s] 98%|█████████▊| 489435/500000 [04:14<00:05, 1997.67it/s]100%|██████████| 500000/500000 [04:15<00:00, 1954.72it/s]
07/16/2024 08:55:39 - INFO - mingpt.model_atari - number of parameters: 4654848
this buffer has 10565 loaded transitions and there are now 500000 transitions total divided into 196 trajectories
max rtg is 28
max timestep is 27002
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 123/1954 [01:00<14:54,  2.05it/s]  6%|▋         | 123/1954 [01:15<14:54,  2.05it/s] 13%|█▎        | 251/1954 [02:00<13:32,  2.10it/s] 13%|█▎        | 251/1954 [02:15<13:32,  2.10it/s] 19%|█▉        | 380/1954 [03:00<12:23,  2.12it/s] 19%|█▉        | 380/1954 [03:15<12:23,  2.12it/s] 26%|██▌       | 510/1954 [04:00<11:16,  2.13it/s] 26%|██▌       | 510/1954 [04:15<11:16,  2.13it/s] 33%|███▎      | 639/1954 [05:00<10:14,  2.14it/s] 33%|███▎      | 639/1954 [05:15<10:14,  2.14it/s] 39%|███▉      | 766/1954 [06:00<09:17,  2.13it/s] 39%|███▉      | 766/1954 [06:15<09:17,  2.13it/s] 46%|████▌     | 892/1954 [07:00<08:21,  2.12it/s] 46%|████▌     | 892/1954 [07:15<08:21,  2.12it/s] 52%|█████▏    | 1017/1954 [08:00<07:24,  2.11it/s] 52%|█████▏    | 1017/1954 [08:15<07:24,  2.11it/s] 58%|█████▊    | 1140/1954 [09:01<06:30,  2.08it/s] 58%|█████▊    | 1140/1954 [09:15<06:30,  2.08it/s] 65%|██████▍   | 1262/1954 [10:01<05:34,  2.07it/s] 65%|██████▍   | 1262/1954 [10:15<05:34,  2.07it/s] 71%|███████   | 1383/1954 [11:01<04:38,  2.05it/s] 71%|███████   | 1383/1954 [11:15<04:38,  2.05it/s] 77%|███████▋  | 1499/1954 [12:01<03:46,  2.01it/s] 77%|███████▋  | 1499/1954 [12:15<03:46,  2.01it/s] 83%|████████▎ | 1616/1954 [13:02<02:50,  1.99it/s] 83%|████████▎ | 1616/1954 [13:15<02:50,  1.99it/s] 89%|████████▊ | 1730/1954 [14:02<01:54,  1.96it/s] 89%|████████▊ | 1730/1954 [14:15<01:54,  1.96it/s] 94%|█████████▍| 1845/1954 [15:02<00:56,  1.94it/s] 94%|█████████▍| 1845/1954 [15:15<00:56,  1.94it/s]100%|██████████| 1954/1954 [15:57<00:00,  2.04it/s]
07/16/2024 09:11:46 - INFO - mingpt.trainer_atari - train loss: 1.362428
target return: 160, eval return: 3700
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 138/1954 [01:00<13:11,  2.30it/s]  7%|▋         | 138/1954 [01:17<13:11,  2.30it/s] 14%|█▍        | 279/1954 [02:00<12:02,  2.32it/s] 14%|█▍        | 279/1954 [02:17<12:02,  2.32it/s] 21%|██▏       | 420/1954 [03:00<10:58,  2.33it/s] 21%|██▏       | 420/1954 [03:17<10:58,  2.33it/s] 29%|██▊       | 561/1954 [04:00<09:56,  2.34it/s] 29%|██▊       | 561/1954 [04:17<09:56,  2.34it/s] 36%|███▌      | 702/1954 [05:01<08:55,  2.34it/s] 36%|███▌      | 702/1954 [05:17<08:55,  2.34it/s] 43%|████▎     | 845/1954 [06:01<07:51,  2.35it/s] 43%|████▎     | 845/1954 [06:17<07:51,  2.35it/s] 51%|█████     | 989/1954 [07:01<06:48,  2.36it/s] 51%|█████     | 989/1954 [07:17<06:48,  2.36it/s] 58%|█████▊    | 1133/1954 [08:01<05:46,  2.37it/s] 58%|█████▊    | 1133/1954 [08:17<05:46,  2.37it/s] 65%|██████▌   | 1276/1954 [09:01<04:45,  2.37it/s] 65%|██████▌   | 1276/1954 [09:17<04:45,  2.37it/s] 73%|███████▎  | 1420/1954 [10:02<03:44,  2.38it/s] 73%|███████▎  | 1420/1954 [10:17<03:44,  2.38it/s] 80%|████████  | 1564/1954 [11:02<02:43,  2.38it/s] 80%|████████  | 1564/1954 [11:17<02:43,  2.38it/s] 87%|████████▋ | 1708/1954 [12:02<01:43,  2.38it/s] 87%|████████▋ | 1708/1954 [12:17<01:43,  2.38it/s] 95%|█████████▍| 1851/1954 [13:02<00:43,  2.38it/s] 95%|█████████▍| 1851/1954 [13:17<00:43,  2.38it/s]100%|██████████| 1954/1954 [13:45<00:00,  2.37it/s]
07/16/2024 09:28:22 - INFO - mingpt.trainer_atari - train loss: 1.262939
target return: 160, eval return: 2400
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 101/1954 [01:00<18:24,  1.68it/s]  5%|▌         | 101/1954 [01:14<18:24,  1.68it/s] 10%|█         | 203/1954 [02:00<17:17,  1.69it/s] 10%|█         | 203/1954 [02:14<17:17,  1.69it/s] 16%|█▌        | 306/1954 [03:00<16:12,  1.69it/s] 16%|█▌        | 306/1954 [03:14<16:12,  1.69it/s] 21%|██        | 409/1954 [04:01<15:09,  1.70it/s] 21%|██        | 409/1954 [04:14<15:09,  1.70it/s] 26%|██▌       | 512/1954 [05:01<14:08,  1.70it/s] 26%|██▌       | 512/1954 [05:14<14:08,  1.70it/s] 31%|███▏      | 615/1954 [06:02<13:07,  1.70it/s] 31%|███▏      | 615/1954 [06:14<13:07,  1.70it/s] 37%|███▋      | 717/1954 [07:02<12:07,  1.70it/s] 37%|███▋      | 717/1954 [07:14<12:07,  1.70it/s] 42%|████▏     | 820/1954 [08:02<11:05,  1.70it/s] 42%|████▏     | 820/1954 [08:14<11:05,  1.70it/s] 47%|████▋     | 923/1954 [09:02<10:03,  1.71it/s] 47%|████▋     | 923/1954 [09:14<10:03,  1.71it/s] 53%|█████▎    | 1026/1954 [10:02<09:03,  1.71it/s] 53%|█████▎    | 1026/1954 [10:14<09:03,  1.71it/s] 58%|█████▊    | 1129/1954 [11:02<08:02,  1.71it/s] 58%|█████▊    | 1129/1954 [11:14<08:02,  1.71it/s] 63%|██████▎   | 1232/1954 [12:03<07:02,  1.71it/s] 63%|██████▎   | 1232/1954 [12:14<07:02,  1.71it/s] 68%|██████▊   | 1335/1954 [13:03<06:02,  1.71it/s] 68%|██████▊   | 1335/1954 [13:14<06:02,  1.71it/s] 74%|███████▎  | 1438/1954 [14:03<05:01,  1.71it/s] 74%|███████▎  | 1438/1954 [14:14<05:01,  1.71it/s] 79%|███████▉  | 1541/1954 [15:03<04:01,  1.71it/s] 79%|███████▉  | 1541/1954 [15:14<04:01,  1.71it/s] 84%|████████▍ | 1644/1954 [16:03<03:01,  1.71it/s] 84%|████████▍ | 1644/1954 [16:14<03:01,  1.71it/s] 89%|████████▉ | 1747/1954 [17:04<02:00,  1.71it/s] 89%|████████▉ | 1747/1954 [17:14<02:00,  1.71it/s] 95%|█████████▍| 1850/1954 [18:04<01:00,  1.71it/s] 95%|█████████▍| 1850/1954 [18:14<01:00,  1.71it/s]100%|█████████▉| 1953/1954 [19:04<00:00,  1.71it/s]100%|██████████| 1954/1954 [19:04<00:00,  1.71it/s]
07/16/2024 09:50:24 - INFO - mingpt.trainer_atari - train loss: 1.201645
target return: 160, eval return: 3900
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 99/1954 [01:00<18:49,  1.64it/s]  5%|▌         | 99/1954 [01:16<18:49,  1.64it/s] 10%|█         | 199/1954 [02:00<17:43,  1.65it/s] 10%|█         | 199/1954 [02:16<17:43,  1.65it/s] 15%|█▌        | 301/1954 [03:01<16:31,  1.67it/s] 15%|█▌        | 301/1954 [03:16<16:31,  1.67it/s] 21%|██        | 403/1954 [04:01<15:24,  1.68it/s] 21%|██        | 403/1954 [04:16<15:24,  1.68it/s] 26%|██▌       | 505/1954 [05:01<14:20,  1.68it/s] 26%|██▌       | 505/1954 [05:16<14:20,  1.68it/s] 31%|███       | 607/1954 [06:01<13:18,  1.69it/s] 31%|███       | 607/1954 [06:16<13:18,  1.69it/s] 36%|███▋      | 709/1954 [07:02<12:18,  1.69it/s] 36%|███▋      | 709/1954 [07:16<12:18,  1.69it/s] 42%|████▏     | 811/1954 [08:02<11:16,  1.69it/s] 42%|████▏     | 811/1954 [08:16<11:16,  1.69it/s] 47%|████▋     | 913/1954 [09:02<10:15,  1.69it/s] 47%|████▋     | 913/1954 [09:16<10:15,  1.69it/s] 52%|█████▏    | 1015/1954 [10:02<09:14,  1.69it/s] 52%|█████▏    | 1015/1954 [10:16<09:14,  1.69it/s] 57%|█████▋    | 1117/1954 [11:02<08:13,  1.70it/s] 57%|█████▋    | 1117/1954 [11:16<08:13,  1.70it/s] 62%|██████▏   | 1219/1954 [12:02<07:13,  1.69it/s] 62%|██████▏   | 1219/1954 [12:16<07:13,  1.69it/s] 68%|██████▊   | 1321/1954 [13:02<06:13,  1.70it/s] 68%|██████▊   | 1321/1954 [13:16<06:13,  1.70it/s] 73%|███████▎  | 1423/1954 [14:03<05:13,  1.70it/s] 73%|███████▎  | 1423/1954 [14:16<05:13,  1.70it/s] 78%|███████▊  | 1525/1954 [15:03<04:12,  1.70it/s] 78%|███████▊  | 1525/1954 [15:16<04:12,  1.70it/s] 83%|████████▎ | 1627/1954 [16:03<03:12,  1.70it/s] 83%|████████▎ | 1627/1954 [16:16<03:12,  1.70it/s] 88%|████████▊ | 1729/1954 [17:03<02:12,  1.70it/s] 88%|████████▊ | 1729/1954 [17:16<02:12,  1.70it/s] 94%|█████████▎| 1831/1954 [18:03<01:12,  1.70it/s] 94%|█████████▎| 1831/1954 [18:16<01:12,  1.70it/s] 99%|█████████▉| 1933/1954 [19:03<00:12,  1.70it/s]100%|██████████| 1954/1954 [19:15<00:00,  1.69it/s]
07/16/2024 10:12:23 - INFO - mingpt.trainer_atari - train loss: 1.169813
target return: 160, eval return: 2800
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 100/1954 [01:00<18:36,  1.66it/s]  5%|▌         | 100/1954 [01:13<18:36,  1.66it/s] 10%|█         | 201/1954 [02:00<17:29,  1.67it/s] 10%|█         | 201/1954 [02:13<17:29,  1.67it/s] 15%|█▌        | 302/1954 [03:00<16:26,  1.67it/s] 15%|█▌        | 302/1954 [03:13<16:26,  1.67it/s] 21%|██        | 403/1954 [04:00<15:26,  1.67it/s] 21%|██        | 403/1954 [04:13<15:26,  1.67it/s] 26%|██▌       | 503/1954 [05:01<14:28,  1.67it/s] 26%|██▌       | 503/1954 [05:13<14:28,  1.67it/s] 31%|███       | 603/1954 [06:01<13:31,  1.66it/s] 31%|███       | 603/1954 [06:13<13:31,  1.66it/s] 36%|███▌      | 702/1954 [07:01<12:34,  1.66it/s] 36%|███▌      | 702/1954 [07:13<12:34,  1.66it/s] 41%|████      | 802/1954 [08:01<11:33,  1.66it/s] 41%|████      | 802/1954 [08:13<11:33,  1.66it/s] 46%|████▌     | 903/1954 [09:02<10:31,  1.66it/s] 46%|████▌     | 903/1954 [09:13<10:31,  1.66it/s] 51%|█████▏    | 1003/1954 [10:02<09:31,  1.66it/s] 51%|█████▏    | 1003/1954 [10:13<09:31,  1.66it/s] 56%|█████▋    | 1104/1954 [11:02<08:30,  1.67it/s] 56%|█████▋    | 1104/1954 [11:13<08:30,  1.67it/s] 62%|██████▏   | 1204/1954 [12:02<07:30,  1.67it/s] 62%|██████▏   | 1204/1954 [12:13<07:30,  1.67it/s] 67%|██████▋   | 1305/1954 [13:03<06:29,  1.67it/s] 67%|██████▋   | 1305/1954 [13:13<06:29,  1.67it/s] 72%|███████▏  | 1406/1954 [14:03<05:28,  1.67it/s] 72%|███████▏  | 1406/1954 [14:23<05:28,  1.67it/s] 77%|███████▋  | 1506/1954 [15:03<04:28,  1.67it/s] 77%|███████▋  | 1506/1954 [15:23<04:28,  1.67it/s] 82%|████████▏ | 1607/1954 [16:04<03:28,  1.67it/s] 82%|████████▏ | 1607/1954 [16:23<03:28,  1.67it/s] 87%|████████▋ | 1708/1954 [17:04<02:27,  1.67it/s] 87%|████████▋ | 1708/1954 [17:23<02:27,  1.67it/s] 93%|█████████▎| 1809/1954 [18:05<01:26,  1.67it/s] 93%|█████████▎| 1809/1954 [18:23<01:26,  1.67it/s] 98%|█████████▊| 1910/1954 [19:05<00:26,  1.67it/s] 98%|█████████▊| 1910/1954 [19:23<00:26,  1.67it/s]100%|██████████| 1954/1954 [19:31<00:00,  1.67it/s]
07/16/2024 10:33:52 - INFO - mingpt.trainer_atari - train loss: 1.147004
target return: 160, eval return: 4000
2024-07-16 10:36:23.083472: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-16 10:36:24.033168: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-16 10:36:29.165329: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 19%|█▊        | 93015/500000 [01:01<04:27, 1519.89it/s] 31%|███       | 152863/500000 [01:20<03:48, 1519.89it/s] 42%|████▏     | 211850/500000 [02:04<02:46, 1735.05it/s] 52%|█████▏    | 257663/500000 [02:20<02:19, 1735.05it/s] 74%|███████▎  | 367777/500000 [03:04<01:02, 2121.18it/s] 83%|████████▎ | 412589/500000 [03:20<00:41, 2121.18it/s] 96%|█████████▌| 480495/500000 [04:06<00:09, 1997.35it/s]100%|██████████| 500000/500000 [04:18<00:00, 1932.93it/s]
07/16/2024 10:44:10 - INFO - mingpt.model_atari - number of parameters: 4654848
this buffer has 23041 loaded transitions and there are now 500000 transitions total divided into 192 trajectories
max rtg is 27
max timestep is 27002
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 129/1954 [01:00<14:10,  2.15it/s]  7%|▋         | 129/1954 [01:15<14:10,  2.15it/s] 14%|█▎        | 268/1954 [02:00<12:31,  2.24it/s] 14%|█▎        | 268/1954 [02:15<12:31,  2.24it/s] 21%|██        | 407/1954 [03:00<11:19,  2.28it/s] 21%|██        | 407/1954 [03:15<11:19,  2.28it/s] 28%|██▊       | 548/1954 [04:00<10:09,  2.30it/s] 28%|██▊       | 548/1954 [04:15<10:09,  2.30it/s] 35%|███▌      | 689/1954 [05:00<09:05,  2.32it/s] 35%|███▌      | 689/1954 [05:15<09:05,  2.32it/s] 42%|████▏     | 830/1954 [06:00<08:02,  2.33it/s] 42%|████▏     | 830/1954 [06:15<08:02,  2.33it/s] 50%|████▉     | 971/1954 [07:00<07:01,  2.33it/s] 50%|████▉     | 971/1954 [07:15<07:01,  2.33it/s] 57%|█████▋    | 1112/1954 [08:01<06:00,  2.33it/s] 57%|█████▋    | 1112/1954 [08:15<06:00,  2.33it/s] 64%|██████▍   | 1253/1954 [09:01<05:00,  2.34it/s] 64%|██████▍   | 1253/1954 [09:15<05:00,  2.34it/s] 71%|███████▏  | 1394/1954 [10:01<03:59,  2.34it/s] 71%|███████▏  | 1394/1954 [10:15<03:59,  2.34it/s] 79%|███████▊  | 1535/1954 [11:02<02:59,  2.34it/s] 79%|███████▊  | 1535/1954 [11:15<02:59,  2.34it/s] 86%|████████▌ | 1676/1954 [12:02<01:58,  2.34it/s] 86%|████████▌ | 1676/1954 [12:15<01:58,  2.34it/s] 93%|█████████▎| 1816/1954 [13:02<00:59,  2.34it/s] 93%|█████████▎| 1816/1954 [13:15<00:59,  2.34it/s]100%|██████████| 1954/1954 [14:01<00:00,  2.32it/s]
07/16/2024 10:58:24 - INFO - mingpt.trainer_atari - train loss: 1.332823
target return: 160, eval return: 3700
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 141/1954 [01:00<12:54,  2.34it/s]  7%|▋         | 141/1954 [01:12<12:54,  2.34it/s] 14%|█▍        | 283/1954 [02:00<11:49,  2.35it/s] 14%|█▍        | 283/1954 [02:12<11:49,  2.35it/s] 22%|██▏       | 426/1954 [03:00<10:46,  2.36it/s] 22%|██▏       | 426/1954 [03:12<10:46,  2.36it/s] 29%|██▉       | 570/1954 [04:00<09:43,  2.37it/s] 29%|██▉       | 570/1954 [04:12<09:43,  2.37it/s] 37%|███▋      | 714/1954 [05:01<08:41,  2.38it/s] 37%|███▋      | 714/1954 [05:12<08:41,  2.38it/s] 44%|████▍     | 858/1954 [06:01<07:39,  2.38it/s] 44%|████▍     | 858/1954 [06:12<07:39,  2.38it/s] 51%|█████▏    | 1002/1954 [07:01<06:39,  2.39it/s] 51%|█████▏    | 1002/1954 [07:12<06:39,  2.39it/s] 59%|█████▊    | 1146/1954 [08:01<05:38,  2.39it/s] 59%|█████▊    | 1146/1954 [08:12<05:38,  2.39it/s] 66%|██████▌   | 1290/1954 [09:02<04:38,  2.39it/s] 66%|██████▌   | 1290/1954 [09:12<04:38,  2.39it/s] 73%|███████▎  | 1433/1954 [10:02<03:38,  2.38it/s] 73%|███████▎  | 1433/1954 [10:12<03:38,  2.38it/s] 81%|████████  | 1577/1954 [11:02<02:38,  2.38it/s] 81%|████████  | 1577/1954 [11:22<02:38,  2.38it/s] 88%|████████▊ | 1720/1954 [12:02<01:38,  2.38it/s] 88%|████████▊ | 1720/1954 [12:22<01:38,  2.38it/s] 95%|█████████▌| 1863/1954 [13:02<00:38,  2.38it/s] 95%|█████████▌| 1863/1954 [13:22<00:38,  2.38it/s]100%|██████████| 1954/1954 [13:40<00:00,  2.38it/s]
07/16/2024 11:15:16 - INFO - mingpt.trainer_atari - train loss: 1.221907
target return: 160, eval return: 3700
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 127/1954 [01:00<14:28,  2.10it/s]  6%|▋         | 127/1954 [01:11<14:28,  2.10it/s] 13%|█▎        | 254/1954 [02:00<13:25,  2.11it/s] 13%|█▎        | 254/1954 [02:11<13:25,  2.11it/s] 19%|█▉        | 381/1954 [03:00<12:26,  2.11it/s] 19%|█▉        | 381/1954 [03:11<12:26,  2.11it/s] 26%|██▌       | 509/1954 [04:00<11:23,  2.11it/s] 26%|██▌       | 509/1954 [04:11<11:23,  2.11it/s] 33%|███▎      | 637/1954 [05:01<10:21,  2.12it/s] 33%|███▎      | 637/1954 [05:11<10:21,  2.12it/s] 39%|███▉      | 765/1954 [06:01<09:21,  2.12it/s] 39%|███▉      | 765/1954 [06:11<09:21,  2.12it/s] 46%|████▌     | 890/1954 [07:01<08:25,  2.11it/s] 46%|████▌     | 890/1954 [07:21<08:25,  2.11it/s] 52%|█████▏    | 1015/1954 [08:01<07:27,  2.10it/s] 52%|█████▏    | 1015/1954 [08:21<07:27,  2.10it/s] 58%|█████▊    | 1142/1954 [09:02<06:26,  2.10it/s] 58%|█████▊    | 1142/1954 [09:21<06:26,  2.10it/s] 65%|██████▍   | 1262/1954 [10:02<05:35,  2.07it/s] 65%|██████▍   | 1262/1954 [10:21<05:35,  2.07it/s] 71%|███████   | 1383/1954 [11:02<04:38,  2.05it/s] 71%|███████   | 1383/1954 [11:21<04:38,  2.05it/s] 77%|███████▋  | 1504/1954 [12:02<03:40,  2.04it/s] 77%|███████▋  | 1504/1954 [12:21<03:40,  2.04it/s] 83%|████████▎ | 1625/1954 [13:02<02:42,  2.03it/s] 83%|████████▎ | 1625/1954 [13:21<02:42,  2.03it/s] 89%|████████▉ | 1746/1954 [14:03<01:42,  2.02it/s] 89%|████████▉ | 1746/1954 [14:21<01:42,  2.02it/s] 96%|█████████▌| 1867/1954 [15:03<00:43,  2.02it/s] 96%|█████████▌| 1867/1954 [15:21<00:43,  2.02it/s]100%|██████████| 1954/1954 [15:46<00:00,  2.06it/s]
07/16/2024 11:33:02 - INFO - mingpt.trainer_atari - train loss: 1.186869
target return: 160, eval return: 3300
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 101/1954 [01:00<18:21,  1.68it/s]  5%|▌         | 101/1954 [01:13<18:21,  1.68it/s] 10%|█         | 203/1954 [02:00<17:18,  1.69it/s] 10%|█         | 203/1954 [02:13<17:18,  1.69it/s] 16%|█▌        | 305/1954 [03:00<16:16,  1.69it/s] 16%|█▌        | 305/1954 [03:13<16:16,  1.69it/s] 21%|██        | 407/1954 [04:01<15:16,  1.69it/s] 21%|██        | 407/1954 [04:13<15:16,  1.69it/s] 26%|██▌       | 510/1954 [05:01<14:13,  1.69it/s] 26%|██▌       | 510/1954 [05:13<14:13,  1.69it/s] 31%|███▏      | 613/1954 [06:02<13:10,  1.70it/s] 31%|███▏      | 613/1954 [06:13<13:10,  1.70it/s] 37%|███▋      | 716/1954 [07:02<12:08,  1.70it/s] 37%|███▋      | 716/1954 [07:13<12:08,  1.70it/s] 42%|████▏     | 819/1954 [08:03<11:07,  1.70it/s] 42%|████▏     | 819/1954 [08:23<11:07,  1.70it/s] 47%|████▋     | 922/1954 [09:03<10:06,  1.70it/s] 47%|████▋     | 922/1954 [09:23<10:06,  1.70it/s] 52%|█████▏    | 1025/1954 [10:04<09:05,  1.70it/s] 52%|█████▏    | 1025/1954 [10:23<09:05,  1.70it/s] 58%|█████▊    | 1128/1954 [11:04<08:05,  1.70it/s] 58%|█████▊    | 1128/1954 [11:23<08:05,  1.70it/s] 63%|██████▎   | 1231/1954 [12:05<07:04,  1.70it/s] 63%|██████▎   | 1231/1954 [12:23<07:04,  1.70it/s] 68%|██████▊   | 1334/1954 [13:05<06:04,  1.70it/s] 68%|██████▊   | 1334/1954 [13:23<06:04,  1.70it/s] 73%|███████▎  | 1436/1954 [14:05<05:04,  1.70it/s] 73%|███████▎  | 1436/1954 [14:23<05:04,  1.70it/s] 79%|███████▉  | 1539/1954 [15:06<04:03,  1.70it/s] 79%|███████▉  | 1539/1954 [15:23<04:03,  1.70it/s] 84%|████████▍ | 1642/1954 [16:06<03:03,  1.70it/s] 84%|████████▍ | 1642/1954 [16:23<03:03,  1.70it/s] 89%|████████▉ | 1745/1954 [17:07<02:02,  1.70it/s] 89%|████████▉ | 1745/1954 [17:23<02:02,  1.70it/s] 95%|█████████▍| 1848/1954 [18:07<01:02,  1.70it/s] 95%|█████████▍| 1848/1954 [18:23<01:02,  1.70it/s]100%|█████████▉| 1950/1954 [19:07<00:02,  1.70it/s]100%|██████████| 1954/1954 [19:09<00:00,  1.70it/s]
07/16/2024 11:54:44 - INFO - mingpt.trainer_atari - train loss: 1.161679
target return: 160, eval return: 4700
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 102/1954 [01:00<18:18,  1.69it/s]  5%|▌         | 102/1954 [01:18<18:18,  1.69it/s] 10%|█         | 205/1954 [02:01<17:12,  1.69it/s] 10%|█         | 205/1954 [02:18<17:12,  1.69it/s] 16%|█▌        | 308/1954 [03:01<16:09,  1.70it/s] 16%|█▌        | 308/1954 [03:18<16:09,  1.70it/s] 21%|██        | 411/1954 [04:01<15:06,  1.70it/s] 21%|██        | 411/1954 [04:18<15:06,  1.70it/s] 26%|██▋       | 515/1954 [05:02<14:02,  1.71it/s] 26%|██▋       | 515/1954 [05:18<14:02,  1.71it/s] 32%|███▏      | 619/1954 [06:02<12:59,  1.71it/s] 32%|███▏      | 619/1954 [06:18<12:59,  1.71it/s] 37%|███▋      | 723/1954 [07:03<11:58,  1.71it/s] 37%|███▋      | 723/1954 [07:18<11:58,  1.71it/s] 42%|████▏     | 827/1954 [08:03<10:57,  1.71it/s] 42%|████▏     | 827/1954 [08:18<10:57,  1.71it/s] 48%|████▊     | 931/1954 [09:04<09:55,  1.72it/s] 48%|████▊     | 931/1954 [09:18<09:55,  1.72it/s] 53%|█████▎    | 1035/1954 [10:04<08:55,  1.72it/s] 53%|█████▎    | 1035/1954 [10:18<08:55,  1.72it/s] 58%|█████▊    | 1139/1954 [11:05<07:54,  1.72it/s] 58%|█████▊    | 1139/1954 [11:18<07:54,  1.72it/s] 64%|██████▎   | 1243/1954 [12:05<06:53,  1.72it/s] 64%|██████▎   | 1243/1954 [12:18<06:53,  1.72it/s] 69%|██████▉   | 1346/1954 [13:06<05:54,  1.72it/s] 69%|██████▉   | 1346/1954 [13:18<05:54,  1.72it/s] 74%|███████▍  | 1450/1954 [14:06<04:53,  1.72it/s] 74%|███████▍  | 1450/1954 [14:18<04:53,  1.72it/s] 80%|███████▉  | 1554/1954 [15:07<03:52,  1.72it/s] 80%|███████▉  | 1554/1954 [15:18<03:52,  1.72it/s] 85%|████████▍ | 1657/1954 [16:07<02:52,  1.72it/s] 85%|████████▍ | 1657/1954 [16:18<02:52,  1.72it/s] 90%|█████████ | 1761/1954 [17:07<01:52,  1.72it/s] 90%|█████████ | 1761/1954 [17:18<01:52,  1.72it/s] 95%|█████████▌| 1864/1954 [18:08<00:52,  1.71it/s] 95%|█████████▌| 1864/1954 [18:18<00:52,  1.71it/s]100%|██████████| 1954/1954 [19:00<00:00,  1.71it/s]
07/16/2024 12:16:39 - INFO - mingpt.trainer_atari - train loss: 1.142834
target return: 160, eval return: 5300
