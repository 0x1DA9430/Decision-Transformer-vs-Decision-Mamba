CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 3
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-18 16:11:16.215649: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 16:11:16.789064: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 16:11:20.538417: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▌        | 75667/500000 [01:03<05:56, 1189.88it/s] 23%|██▎       | 114000/500000 [01:19<05:24, 1189.88it/s] 34%|███▍      | 168938/500000 [02:07<04:05, 1348.36it/s] 38%|███▊      | 187715/500000 [02:19<03:51, 1348.36it/s] 53%|█████▎    | 264170/500000 [03:11<02:47, 1409.40it/s] 61%|██████    | 302946/500000 [03:30<02:19, 1409.40it/s] 72%|███████▏  | 357722/500000 [04:15<01:39, 1430.13it/s] 77%|███████▋  | 386139/500000 [04:30<01:19, 1430.13it/s] 91%|█████████ | 452627/500000 [05:20<00:32, 1447.36it/s] 98%|█████████▊| 491010/500000 [05:40<00:06, 1447.36it/s]100%|██████████| 500000/500000 [05:47<00:00, 1440.88it/s]
07/18/2024 16:17:57 - INFO - mingpt.model_atari - number of parameters: 1510528
this buffer has 8989 loaded transitions and there are now 500000 transitions total divided into 265 trajectories
max rtg is 51
max timestep is 2437
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 112/1954 [01:00<16:31,  1.86it/s]  6%|▌         | 112/1954 [01:10<16:31,  1.86it/s] 12%|█▏        | 232/1954 [02:00<14:49,  1.94it/s] 12%|█▏        | 232/1954 [02:10<14:49,  1.94it/s] 18%|█▊        | 351/1954 [03:00<13:39,  1.96it/s] 18%|█▊        | 351/1954 [03:10<13:39,  1.96it/s] 24%|██▍       | 470/1954 [04:00<12:35,  1.97it/s] 24%|██▍       | 470/1954 [04:10<12:35,  1.97it/s] 30%|███       | 589/1954 [05:00<11:32,  1.97it/s] 30%|███       | 589/1954 [05:20<11:32,  1.97it/s] 36%|███▋      | 709/1954 [06:01<10:29,  1.98it/s] 36%|███▋      | 709/1954 [06:20<10:29,  1.98it/s] 42%|████▏     | 828/1954 [07:01<09:29,  1.98it/s] 42%|████▏     | 828/1954 [07:20<09:29,  1.98it/s] 48%|████▊     | 947/1954 [08:01<08:28,  1.98it/s] 48%|████▊     | 947/1954 [08:20<08:28,  1.98it/s] 55%|█████▍    | 1067/1954 [09:01<07:27,  1.98it/s] 55%|█████▍    | 1067/1954 [09:20<07:27,  1.98it/s] 61%|██████    | 1187/1954 [10:02<06:26,  1.98it/s] 61%|██████    | 1187/1954 [10:20<06:26,  1.98it/s] 67%|██████▋   | 1307/1954 [11:02<05:26,  1.98it/s] 67%|██████▋   | 1307/1954 [11:20<05:26,  1.98it/s] 73%|███████▎  | 1425/1954 [12:02<04:27,  1.98it/s] 73%|███████▎  | 1425/1954 [12:20<04:27,  1.98it/s] 79%|███████▉  | 1541/1954 [13:02<03:30,  1.96it/s] 79%|███████▉  | 1541/1954 [13:20<03:30,  1.96it/s] 85%|████████▍ | 1659/1954 [14:03<02:30,  1.96it/s] 85%|████████▍ | 1659/1954 [14:20<02:30,  1.96it/s] 91%|█████████ | 1777/1954 [15:03<01:30,  1.96it/s] 91%|█████████ | 1777/1954 [15:20<01:30,  1.96it/s] 97%|█████████▋| 1894/1954 [16:03<00:30,  1.96it/s] 97%|█████████▋| 1894/1954 [16:20<00:30,  1.96it/s]100%|██████████| 1954/1954 [16:33<00:00,  1.97it/s]
07/18/2024 16:34:41 - INFO - mingpt.trainer_atari - train loss: 1.904191
target return: 305, eval return: -47
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 141/1954 [01:00<12:56,  2.33it/s]  7%|▋         | 141/1954 [01:13<12:56,  2.33it/s] 14%|█▍        | 282/1954 [02:00<11:55,  2.34it/s] 14%|█▍        | 282/1954 [02:13<11:55,  2.34it/s] 22%|██▏       | 422/1954 [03:00<10:56,  2.33it/s] 22%|██▏       | 422/1954 [03:13<10:56,  2.33it/s] 29%|██▉       | 563/1954 [04:00<09:55,  2.34it/s] 29%|██▉       | 563/1954 [04:13<09:55,  2.34it/s] 36%|███▌      | 704/1954 [05:01<08:54,  2.34it/s] 36%|███▌      | 704/1954 [05:13<08:54,  2.34it/s] 43%|████▎     | 844/1954 [06:01<07:55,  2.33it/s] 43%|████▎     | 844/1954 [06:13<07:55,  2.33it/s] 50%|█████     | 984/1954 [07:01<06:55,  2.33it/s] 50%|█████     | 984/1954 [07:13<06:55,  2.33it/s] 58%|█████▊    | 1125/1954 [08:01<05:55,  2.33it/s] 58%|█████▊    | 1125/1954 [08:13<05:55,  2.33it/s] 65%|██████▍   | 1265/1954 [09:02<04:55,  2.33it/s] 65%|██████▍   | 1265/1954 [09:13<04:55,  2.33it/s] 72%|███████▏  | 1405/1954 [10:02<03:55,  2.33it/s] 72%|███████▏  | 1405/1954 [10:13<03:55,  2.33it/s] 79%|███████▉  | 1546/1954 [11:02<02:55,  2.33it/s] 79%|███████▉  | 1546/1954 [11:13<02:55,  2.33it/s] 86%|████████▋ | 1686/1954 [12:03<01:55,  2.33it/s] 86%|████████▋ | 1686/1954 [12:13<01:55,  2.33it/s] 93%|█████████▎| 1826/1954 [13:03<00:54,  2.33it/s] 93%|█████████▎| 1826/1954 [13:13<00:54,  2.33it/s]100%|██████████| 1954/1954 [13:58<00:00,  2.33it/s]
07/18/2024 16:53:43 - INFO - mingpt.trainer_atari - train loss: 1.814893
target return: 305, eval return: -47
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 104/1954 [01:00<17:54,  1.72it/s]  5%|▌         | 104/1954 [01:11<17:54,  1.72it/s] 11%|█         | 208/1954 [02:00<16:54,  1.72it/s] 11%|█         | 208/1954 [02:11<16:54,  1.72it/s] 16%|█▌        | 312/1954 [03:01<15:54,  1.72it/s] 16%|█▌        | 312/1954 [03:21<15:54,  1.72it/s] 21%|██        | 415/1954 [04:01<14:55,  1.72it/s] 21%|██        | 415/1954 [04:21<14:55,  1.72it/s] 27%|██▋       | 519/1954 [05:01<13:54,  1.72it/s] 27%|██▋       | 519/1954 [05:21<13:54,  1.72it/s] 32%|███▏      | 623/1954 [06:02<12:54,  1.72it/s] 32%|███▏      | 623/1954 [06:21<12:54,  1.72it/s] 37%|███▋      | 727/1954 [07:02<11:53,  1.72it/s] 37%|███▋      | 727/1954 [07:21<11:53,  1.72it/s] 42%|████▏     | 830/1954 [08:02<10:54,  1.72it/s] 42%|████▏     | 830/1954 [08:21<10:54,  1.72it/s] 48%|████▊     | 934/1954 [09:02<09:52,  1.72it/s] 48%|████▊     | 934/1954 [09:21<09:52,  1.72it/s] 53%|█████▎    | 1038/1954 [10:03<08:52,  1.72it/s] 53%|█████▎    | 1038/1954 [10:21<08:52,  1.72it/s] 58%|█████▊    | 1141/1954 [11:03<07:53,  1.72it/s] 58%|█████▊    | 1141/1954 [11:21<07:53,  1.72it/s] 64%|██████▎   | 1244/1954 [12:03<06:54,  1.71it/s] 64%|██████▎   | 1244/1954 [12:21<06:54,  1.71it/s] 69%|██████▉   | 1348/1954 [13:04<05:53,  1.72it/s] 69%|██████▉   | 1348/1954 [13:21<05:53,  1.72it/s] 74%|███████▍  | 1451/1954 [14:04<04:53,  1.71it/s] 74%|███████▍  | 1451/1954 [14:21<04:53,  1.71it/s] 80%|███████▉  | 1555/1954 [15:05<03:52,  1.72it/s] 80%|███████▉  | 1555/1954 [15:21<03:52,  1.72it/s] 85%|████████▍ | 1658/1954 [16:05<02:52,  1.72it/s] 85%|████████▍ | 1658/1954 [16:21<02:52,  1.72it/s] 90%|█████████ | 1761/1954 [17:05<01:52,  1.72it/s] 90%|█████████ | 1761/1954 [17:21<01:52,  1.72it/s] 95%|█████████▌| 1865/1954 [18:05<00:51,  1.72it/s] 95%|█████████▌| 1865/1954 [18:21<00:51,  1.72it/s]100%|██████████| 1954/1954 [18:56<00:00,  1.72it/s]
07/18/2024 17:17:54 - INFO - mingpt.trainer_atari - train loss: 1.767363
target return: 305, eval return: -29
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 103/1954 [01:00<18:06,  1.70it/s]  5%|▌         | 103/1954 [01:14<18:06,  1.70it/s] 11%|█         | 206/1954 [02:00<17:05,  1.70it/s] 11%|█         | 206/1954 [02:14<17:05,  1.70it/s] 16%|█▌        | 309/1954 [03:01<16:05,  1.70it/s] 16%|█▌        | 309/1954 [03:14<16:05,  1.70it/s] 21%|██        | 411/1954 [04:01<15:06,  1.70it/s] 21%|██        | 411/1954 [04:14<15:06,  1.70it/s] 26%|██▋       | 514/1954 [05:01<14:05,  1.70it/s] 26%|██▋       | 514/1954 [05:14<14:05,  1.70it/s] 32%|███▏      | 617/1954 [06:02<13:04,  1.70it/s] 32%|███▏      | 617/1954 [06:14<13:04,  1.70it/s] 37%|███▋      | 720/1954 [07:02<12:03,  1.70it/s] 37%|███▋      | 720/1954 [07:14<12:03,  1.70it/s] 42%|████▏     | 823/1954 [08:02<11:03,  1.70it/s] 42%|████▏     | 823/1954 [08:14<11:03,  1.70it/s] 47%|████▋     | 926/1954 [09:03<10:03,  1.70it/s] 47%|████▋     | 926/1954 [09:14<10:03,  1.70it/s] 53%|█████▎    | 1029/1954 [10:04<09:03,  1.70it/s] 53%|█████▎    | 1029/1954 [10:14<09:03,  1.70it/s] 58%|█████▊    | 1132/1954 [11:04<08:02,  1.70it/s] 58%|█████▊    | 1132/1954 [11:24<08:02,  1.70it/s] 63%|██████▎   | 1234/1954 [12:04<07:03,  1.70it/s] 63%|██████▎   | 1234/1954 [12:24<07:03,  1.70it/s] 68%|██████▊   | 1337/1954 [13:05<06:02,  1.70it/s] 68%|██████▊   | 1337/1954 [13:24<06:02,  1.70it/s] 74%|███████▎  | 1439/1954 [14:05<05:02,  1.70it/s] 74%|███████▎  | 1439/1954 [14:24<05:02,  1.70it/s] 79%|███████▉  | 1542/1954 [15:05<04:02,  1.70it/s] 79%|███████▉  | 1542/1954 [15:24<04:02,  1.70it/s] 84%|████████▍ | 1645/1954 [16:06<03:01,  1.70it/s] 84%|████████▍ | 1645/1954 [16:24<03:01,  1.70it/s] 89%|████████▉ | 1747/1954 [17:06<02:01,  1.70it/s] 89%|████████▉ | 1747/1954 [17:24<02:01,  1.70it/s] 95%|█████████▍| 1850/1954 [18:06<01:01,  1.70it/s] 95%|█████████▍| 1850/1954 [18:24<01:01,  1.70it/s]100%|█████████▉| 1953/1954 [19:07<00:00,  1.70it/s]100%|██████████| 1954/1954 [19:07<00:00,  1.70it/s]
07/18/2024 17:41:31 - INFO - mingpt.trainer_atari - train loss: 1.721128
target return: 305, eval return: -21
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 123/1954 [01:00<14:57,  2.04it/s]  6%|▋         | 123/1954 [01:16<14:57,  2.04it/s] 13%|█▎        | 246/1954 [02:00<13:55,  2.04it/s] 13%|█▎        | 246/1954 [02:16<13:55,  2.04it/s] 19%|█▉        | 369/1954 [03:00<12:55,  2.04it/s] 19%|█▉        | 369/1954 [03:16<12:55,  2.04it/s] 25%|██▌       | 493/1954 [04:00<11:53,  2.05it/s] 25%|██▌       | 493/1954 [04:16<11:53,  2.05it/s] 32%|███▏      | 617/1954 [05:01<10:51,  2.05it/s] 32%|███▏      | 617/1954 [05:16<10:51,  2.05it/s] 38%|███▊      | 741/1954 [06:01<09:50,  2.05it/s] 38%|███▊      | 741/1954 [06:16<09:50,  2.05it/s] 44%|████▍     | 865/1954 [07:01<08:50,  2.05it/s] 44%|████▍     | 865/1954 [07:16<08:50,  2.05it/s] 51%|█████     | 988/1954 [08:01<07:50,  2.05it/s] 51%|█████     | 988/1954 [08:16<07:50,  2.05it/s] 57%|█████▋    | 1111/1954 [09:01<06:51,  2.05it/s] 57%|█████▋    | 1111/1954 [09:16<06:51,  2.05it/s] 63%|██████▎   | 1235/1954 [10:02<05:50,  2.05it/s] 63%|██████▎   | 1235/1954 [10:16<05:50,  2.05it/s] 69%|██████▉   | 1358/1954 [11:02<04:50,  2.05it/s] 69%|██████▉   | 1358/1954 [11:16<04:50,  2.05it/s] 76%|███████▌  | 1482/1954 [12:02<03:50,  2.05it/s] 76%|███████▌  | 1482/1954 [12:16<03:50,  2.05it/s] 82%|████████▏ | 1605/1954 [13:03<02:50,  2.05it/s] 82%|████████▏ | 1605/1954 [13:16<02:50,  2.05it/s] 88%|████████▊ | 1729/1954 [14:03<01:49,  2.05it/s] 88%|████████▊ | 1729/1954 [14:16<01:49,  2.05it/s] 95%|█████████▍| 1852/1954 [15:03<00:49,  2.05it/s] 95%|█████████▍| 1852/1954 [15:16<00:49,  2.05it/s]100%|██████████| 1954/1954 [15:52<00:00,  2.05it/s]
07/18/2024 18:01:54 - INFO - mingpt.trainer_atari - train loss: 1.681244
target return: 305, eval return: -21
2024-07-18 18:06:43.608168: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 18:06:44.438778: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 18:06:48.631910: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▌        | 75328/500000 [01:03<05:56, 1192.64it/s] 22%|██▏       | 112484/500000 [01:20<05:24, 1192.64it/s] 34%|███▍      | 169372/500000 [02:07<04:03, 1358.21it/s] 38%|███▊      | 190236/500000 [02:20<03:48, 1358.21it/s] 52%|█████▏    | 260438/500000 [03:10<02:51, 1394.59it/s] 60%|█████▉    | 298247/500000 [03:30<02:24, 1394.59it/s] 71%|███████   | 355727/500000 [04:14<01:40, 1432.91it/s] 79%|███████▊  | 393357/500000 [04:30<01:14, 1432.91it/s] 90%|█████████ | 450849/500000 [05:18<00:33, 1453.51it/s] 94%|█████████▍| 470605/500000 [05:30<00:20, 1453.51it/s]100%|██████████| 500000/500000 [05:45<00:00, 1446.56it/s]
07/18/2024 18:13:25 - INFO - mingpt.model_atari - number of parameters: 1492096
this buffer has 11697 loaded transitions and there are now 500000 transitions total divided into 267 trajectories
max rtg is 49
max timestep is 2293
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 135/1954 [01:00<13:31,  2.24it/s]  7%|▋         | 135/1954 [01:13<13:31,  2.24it/s] 14%|█▍        | 276/1954 [02:00<12:08,  2.30it/s] 14%|█▍        | 276/1954 [02:13<12:08,  2.30it/s] 21%|██▏       | 417/1954 [03:00<11:02,  2.32it/s] 21%|██▏       | 417/1954 [03:13<11:02,  2.32it/s] 28%|██▊       | 556/1954 [04:00<10:03,  2.31it/s] 28%|██▊       | 556/1954 [04:13<10:03,  2.31it/s] 35%|███▌      | 688/1954 [05:01<09:17,  2.27it/s] 35%|███▌      | 688/1954 [05:13<09:17,  2.27it/s] 42%|████▏     | 827/1954 [06:01<08:13,  2.28it/s] 42%|████▏     | 827/1954 [06:13<08:13,  2.28it/s] 50%|████▉     | 969/1954 [07:01<07:06,  2.31it/s] 50%|████▉     | 969/1954 [07:13<07:06,  2.31it/s] 57%|█████▋    | 1108/1954 [08:01<06:06,  2.31it/s] 57%|█████▋    | 1108/1954 [08:13<06:06,  2.31it/s] 64%|██████▍   | 1249/1954 [09:01<05:04,  2.32it/s] 64%|██████▍   | 1249/1954 [09:13<05:04,  2.32it/s] 71%|███████   | 1389/1954 [10:02<04:03,  2.32it/s] 71%|███████   | 1389/1954 [10:13<04:03,  2.32it/s] 78%|███████▊  | 1529/1954 [11:02<03:02,  2.32it/s] 78%|███████▊  | 1529/1954 [11:13<03:02,  2.32it/s] 85%|████████▌ | 1669/1954 [12:02<02:02,  2.32it/s] 85%|████████▌ | 1669/1954 [12:13<02:02,  2.32it/s] 93%|█████████▎| 1809/1954 [13:02<01:02,  2.32it/s] 93%|█████████▎| 1809/1954 [13:13<01:02,  2.32it/s]100%|█████████▉| 1948/1954 [14:02<00:02,  2.32it/s]100%|██████████| 1954/1954 [14:05<00:00,  2.31it/s]
07/18/2024 18:27:40 - INFO - mingpt.trainer_atari - train loss: 1.874746
target return: 305, eval return: -63
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 123/1954 [01:00<14:56,  2.04it/s]  6%|▋         | 123/1954 [01:15<14:56,  2.04it/s] 13%|█▎        | 246/1954 [02:00<13:56,  2.04it/s] 13%|█▎        | 246/1954 [02:15<13:56,  2.04it/s] 19%|█▉        | 369/1954 [03:00<12:55,  2.04it/s] 19%|█▉        | 369/1954 [03:15<12:55,  2.04it/s] 25%|██▌       | 492/1954 [04:01<11:56,  2.04it/s] 25%|██▌       | 492/1954 [04:15<11:56,  2.04it/s] 31%|███▏      | 615/1954 [05:01<10:57,  2.04it/s] 31%|███▏      | 615/1954 [05:15<10:57,  2.04it/s] 38%|███▊      | 737/1954 [06:01<09:57,  2.04it/s] 38%|███▊      | 737/1954 [06:15<09:57,  2.04it/s] 44%|████▍     | 860/1954 [07:01<08:56,  2.04it/s] 44%|████▍     | 860/1954 [07:15<08:56,  2.04it/s] 50%|█████     | 982/1954 [08:01<07:57,  2.04it/s] 50%|█████     | 982/1954 [08:15<07:57,  2.04it/s] 57%|█████▋    | 1105/1954 [09:02<06:56,  2.04it/s] 57%|█████▋    | 1105/1954 [09:15<06:56,  2.04it/s] 63%|██████▎   | 1227/1954 [10:02<05:57,  2.03it/s] 63%|██████▎   | 1227/1954 [10:15<05:57,  2.03it/s] 69%|██████▉   | 1349/1954 [11:02<04:57,  2.03it/s] 69%|██████▉   | 1349/1954 [11:15<04:57,  2.03it/s] 75%|███████▌  | 1471/1954 [12:02<03:58,  2.03it/s] 75%|███████▌  | 1471/1954 [12:15<03:58,  2.03it/s] 82%|████████▏ | 1593/1954 [13:02<02:57,  2.03it/s] 82%|████████▏ | 1593/1954 [13:15<02:57,  2.03it/s] 88%|████████▊ | 1715/1954 [14:02<01:57,  2.03it/s] 88%|████████▊ | 1715/1954 [14:15<01:57,  2.03it/s] 94%|█████████▍| 1837/1954 [15:02<00:57,  2.03it/s] 94%|█████████▍| 1837/1954 [15:15<00:57,  2.03it/s]100%|██████████| 1954/1954 [16:00<00:00,  2.03it/s]
07/18/2024 18:48:22 - INFO - mingpt.trainer_atari - train loss: 1.781667
target return: 305, eval return: -13
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 122/1954 [01:00<15:06,  2.02it/s]  6%|▌         | 122/1954 [01:12<15:06,  2.02it/s] 12%|█▏        | 244/1954 [02:00<14:04,  2.02it/s] 12%|█▏        | 244/1954 [02:12<14:04,  2.02it/s] 19%|█▊        | 366/1954 [03:00<13:04,  2.02it/s] 19%|█▊        | 366/1954 [03:12<13:04,  2.02it/s] 25%|██▍       | 488/1954 [04:00<12:03,  2.03it/s] 25%|██▍       | 488/1954 [04:12<12:03,  2.03it/s] 31%|███       | 610/1954 [05:01<11:03,  2.03it/s] 31%|███       | 610/1954 [05:12<11:03,  2.03it/s] 37%|███▋      | 732/1954 [06:01<10:03,  2.03it/s] 37%|███▋      | 732/1954 [06:12<10:03,  2.03it/s] 44%|████▍     | 855/1954 [07:01<09:01,  2.03it/s] 44%|████▍     | 855/1954 [07:12<09:01,  2.03it/s] 50%|█████     | 977/1954 [08:01<08:01,  2.03it/s] 50%|█████     | 977/1954 [08:12<08:01,  2.03it/s] 56%|█████▌    | 1099/1954 [09:02<07:01,  2.03it/s] 56%|█████▌    | 1099/1954 [09:12<07:01,  2.03it/s] 62%|██████▏   | 1221/1954 [10:02<06:01,  2.03it/s] 62%|██████▏   | 1221/1954 [10:22<06:01,  2.03it/s] 69%|██████▊   | 1343/1954 [11:02<05:01,  2.03it/s] 69%|██████▊   | 1343/1954 [11:22<05:01,  2.03it/s] 75%|███████▌  | 1466/1954 [12:02<04:00,  2.03it/s] 75%|███████▌  | 1466/1954 [12:22<04:00,  2.03it/s] 81%|████████▏ | 1588/1954 [13:02<03:00,  2.03it/s] 81%|████████▏ | 1588/1954 [13:22<03:00,  2.03it/s] 88%|████████▊ | 1710/1954 [14:02<02:00,  2.03it/s] 88%|████████▊ | 1710/1954 [14:22<02:00,  2.03it/s] 94%|█████████▍| 1832/1954 [15:03<01:00,  2.03it/s] 94%|█████████▍| 1832/1954 [15:22<01:00,  2.03it/s]100%|██████████| 1954/1954 [16:03<00:00,  2.03it/s]
07/18/2024 19:08:59 - INFO - mingpt.trainer_atari - train loss: 1.733054
target return: 305, eval return: -11
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 102/1954 [01:00<18:16,  1.69it/s]  5%|▌         | 102/1954 [01:15<18:16,  1.69it/s] 10%|█         | 204/1954 [02:00<17:17,  1.69it/s] 10%|█         | 204/1954 [02:15<17:17,  1.69it/s] 16%|█▌        | 306/1954 [03:01<16:16,  1.69it/s] 16%|█▌        | 306/1954 [03:15<16:16,  1.69it/s] 21%|██        | 408/1954 [04:01<15:16,  1.69it/s] 21%|██        | 408/1954 [04:15<15:16,  1.69it/s] 26%|██▌       | 509/1954 [05:02<14:18,  1.68it/s] 26%|██▌       | 509/1954 [05:15<14:18,  1.68it/s] 31%|███       | 610/1954 [06:02<13:20,  1.68it/s] 31%|███       | 610/1954 [06:15<13:20,  1.68it/s] 36%|███▋      | 711/1954 [07:02<12:20,  1.68it/s] 36%|███▋      | 711/1954 [07:15<12:20,  1.68it/s] 42%|████▏     | 813/1954 [08:03<11:18,  1.68it/s] 42%|████▏     | 813/1954 [08:15<11:18,  1.68it/s] 47%|████▋     | 914/1954 [09:03<10:18,  1.68it/s] 47%|████▋     | 914/1954 [09:15<10:18,  1.68it/s] 52%|█████▏    | 1015/1954 [10:03<09:18,  1.68it/s] 52%|█████▏    | 1015/1954 [10:15<09:18,  1.68it/s] 57%|█████▋    | 1116/1954 [11:03<08:18,  1.68it/s] 57%|█████▋    | 1116/1954 [11:15<08:18,  1.68it/s] 62%|██████▏   | 1217/1954 [12:03<07:18,  1.68it/s] 62%|██████▏   | 1217/1954 [12:15<07:18,  1.68it/s] 68%|██████▊   | 1319/1954 [13:04<06:17,  1.68it/s] 68%|██████▊   | 1319/1954 [13:15<06:17,  1.68it/s] 73%|███████▎  | 1421/1954 [14:04<05:16,  1.68it/s] 73%|███████▎  | 1421/1954 [14:15<05:16,  1.68it/s] 78%|███████▊  | 1522/1954 [15:04<04:16,  1.68it/s] 78%|███████▊  | 1522/1954 [15:15<04:16,  1.68it/s] 83%|████████▎ | 1623/1954 [16:04<03:16,  1.68it/s] 83%|████████▎ | 1623/1954 [16:15<03:16,  1.68it/s] 88%|████████▊ | 1724/1954 [17:05<02:16,  1.68it/s] 88%|████████▊ | 1724/1954 [17:15<02:16,  1.68it/s] 93%|█████████▎| 1825/1954 [18:05<01:16,  1.68it/s] 93%|█████████▎| 1825/1954 [18:15<01:16,  1.68it/s] 99%|█████████▊| 1926/1954 [19:05<00:16,  1.68it/s] 99%|█████████▊| 1926/1954 [19:15<00:16,  1.68it/s]100%|██████████| 1954/1954 [19:21<00:00,  1.68it/s]
07/18/2024 19:32:44 - INFO - mingpt.trainer_atari - train loss: 1.686858
target return: 305, eval return: -7
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 102/1954 [01:00<18:12,  1.69it/s]  5%|▌         | 102/1954 [01:11<18:12,  1.69it/s] 10%|█         | 205/1954 [02:00<17:09,  1.70it/s] 10%|█         | 205/1954 [02:11<17:09,  1.70it/s] 16%|█▌        | 308/1954 [03:01<16:08,  1.70it/s] 16%|█▌        | 308/1954 [03:11<16:08,  1.70it/s] 21%|██        | 411/1954 [04:01<15:07,  1.70it/s] 21%|██        | 411/1954 [04:21<15:07,  1.70it/s] 26%|██▋       | 513/1954 [05:01<14:07,  1.70it/s] 26%|██▋       | 513/1954 [05:21<14:07,  1.70it/s] 31%|███▏      | 615/1954 [06:01<13:08,  1.70it/s] 31%|███▏      | 615/1954 [06:21<13:08,  1.70it/s] 37%|███▋      | 717/1954 [07:02<12:08,  1.70it/s] 37%|███▋      | 717/1954 [07:21<12:08,  1.70it/s] 42%|████▏     | 819/1954 [08:02<11:08,  1.70it/s] 42%|████▏     | 819/1954 [08:21<11:08,  1.70it/s] 47%|████▋     | 921/1954 [09:02<10:08,  1.70it/s] 47%|████▋     | 921/1954 [09:21<10:08,  1.70it/s] 52%|█████▏    | 1023/1954 [10:02<09:08,  1.70it/s] 52%|█████▏    | 1023/1954 [10:21<09:08,  1.70it/s] 58%|█████▊    | 1125/1954 [11:02<08:08,  1.70it/s] 58%|█████▊    | 1125/1954 [11:21<08:08,  1.70it/s] 63%|██████▎   | 1227/1954 [12:02<07:08,  1.70it/s] 63%|██████▎   | 1227/1954 [12:21<07:08,  1.70it/s] 68%|██████▊   | 1329/1954 [13:03<06:08,  1.70it/s] 68%|██████▊   | 1329/1954 [13:21<06:08,  1.70it/s] 73%|███████▎  | 1431/1954 [14:03<05:08,  1.69it/s] 73%|███████▎  | 1431/1954 [14:21<05:08,  1.69it/s] 79%|███████▊  | 1534/1954 [15:03<04:07,  1.70it/s] 79%|███████▊  | 1534/1954 [15:21<04:07,  1.70it/s] 84%|████████▎ | 1636/1954 [16:03<03:07,  1.70it/s] 84%|████████▎ | 1636/1954 [16:21<03:07,  1.70it/s] 89%|████████▉ | 1738/1954 [17:04<02:07,  1.69it/s] 89%|████████▉ | 1738/1954 [17:21<02:07,  1.69it/s] 94%|█████████▍| 1840/1954 [18:04<01:07,  1.69it/s] 94%|█████████▍| 1840/1954 [18:21<01:07,  1.69it/s] 99%|█████████▉| 1942/1954 [19:04<00:07,  1.69it/s]100%|██████████| 1954/1954 [19:11<00:00,  1.70it/s]
07/18/2024 19:56:28 - INFO - mingpt.trainer_atari - train loss: 1.647599
target return: 305, eval return: -10
2024-07-18 20:01:08.220073: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-18 20:01:09.331223: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-18 20:01:14.920127: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 15%|█▌        | 75096/500000 [01:03<05:59, 1183.18it/s] 23%|██▎       | 114210/500000 [01:20<05:26, 1183.18it/s] 34%|███▍      | 169615/500000 [02:07<04:03, 1356.87it/s] 38%|███▊      | 189332/500000 [02:20<03:48, 1356.87it/s] 52%|█████▏    | 262348/500000 [03:11<02:49, 1399.98it/s] 60%|█████▉    | 299802/500000 [03:30<02:23, 1399.98it/s] 72%|███████▏  | 359627/500000 [04:15<01:37, 1444.73it/s] 78%|███████▊  | 389174/500000 [04:30<01:16, 1444.73it/s] 91%|█████████ | 453385/500000 [05:19<00:32, 1452.41it/s] 94%|█████████▍| 469956/500000 [05:30<00:20, 1452.41it/s]100%|██████████| 500000/500000 [05:46<00:00, 1443.05it/s]
07/18/2024 20:07:53 - INFO - mingpt.model_atari - number of parameters: 1494784
this buffer has 11446 loaded transitions and there are now 500000 transitions total divided into 266 trajectories
max rtg is 49
max timestep is 2314
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 116/1954 [01:00<15:58,  1.92it/s]  6%|▌         | 116/1954 [01:11<15:58,  1.92it/s] 12%|█▏        | 238/1954 [02:00<14:26,  1.98it/s] 12%|█▏        | 238/1954 [02:11<14:26,  1.98it/s] 18%|█▊        | 360/1954 [03:01<13:17,  2.00it/s] 18%|█▊        | 360/1954 [03:11<13:17,  2.00it/s] 25%|██▍       | 482/1954 [04:01<12:13,  2.01it/s] 25%|██▍       | 482/1954 [04:11<12:13,  2.01it/s] 31%|███       | 603/1954 [05:01<11:12,  2.01it/s] 31%|███       | 603/1954 [05:11<11:12,  2.01it/s] 37%|███▋      | 724/1954 [06:02<10:12,  2.01it/s] 37%|███▋      | 724/1954 [06:21<10:12,  2.01it/s] 43%|████▎     | 845/1954 [07:02<09:11,  2.01it/s] 43%|████▎     | 845/1954 [07:21<09:11,  2.01it/s] 49%|████▉     | 966/1954 [08:02<08:11,  2.01it/s] 49%|████▉     | 966/1954 [08:21<08:11,  2.01it/s] 56%|█████▌    | 1087/1954 [09:02<07:11,  2.01it/s] 56%|█████▌    | 1087/1954 [09:21<07:11,  2.01it/s] 62%|██████▏   | 1208/1954 [10:02<06:11,  2.01it/s] 62%|██████▏   | 1208/1954 [10:21<06:11,  2.01it/s] 68%|██████▊   | 1329/1954 [11:02<05:11,  2.01it/s] 68%|██████▊   | 1329/1954 [11:21<05:11,  2.01it/s] 74%|███████▍  | 1450/1954 [12:03<04:10,  2.01it/s] 74%|███████▍  | 1450/1954 [12:21<04:10,  2.01it/s] 80%|████████  | 1571/1954 [13:03<03:10,  2.01it/s] 80%|████████  | 1571/1954 [13:21<03:10,  2.01it/s] 87%|████████▋ | 1692/1954 [14:03<02:10,  2.01it/s] 87%|████████▋ | 1692/1954 [14:21<02:10,  2.01it/s] 93%|█████████▎| 1813/1954 [15:04<01:10,  2.01it/s] 93%|█████████▎| 1813/1954 [15:21<01:10,  2.01it/s] 99%|█████████▉| 1934/1954 [16:04<00:09,  2.01it/s]100%|██████████| 1954/1954 [16:14<00:00,  2.01it/s]
07/18/2024 20:24:17 - INFO - mingpt.trainer_atari - train loss: 1.897781
target return: 305, eval return: -49
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 141/1954 [01:00<12:54,  2.34it/s]  7%|▋         | 141/1954 [01:10<12:54,  2.34it/s] 14%|█▍        | 282/1954 [02:00<11:53,  2.34it/s] 14%|█▍        | 282/1954 [02:10<11:53,  2.34it/s] 22%|██▏       | 423/1954 [03:00<10:52,  2.35it/s] 22%|██▏       | 423/1954 [03:10<10:52,  2.35it/s] 29%|██▉       | 564/1954 [04:00<09:52,  2.35it/s] 29%|██▉       | 564/1954 [04:10<09:52,  2.35it/s] 36%|███▌      | 705/1954 [05:00<08:52,  2.34it/s] 36%|███▌      | 705/1954 [05:20<08:52,  2.34it/s] 43%|████▎     | 847/1954 [06:00<07:51,  2.35it/s] 43%|████▎     | 847/1954 [06:20<07:51,  2.35it/s] 51%|█████     | 989/1954 [07:01<06:50,  2.35it/s] 51%|█████     | 989/1954 [07:20<06:50,  2.35it/s] 58%|█████▊    | 1130/1954 [08:01<05:50,  2.35it/s] 58%|█████▊    | 1130/1954 [08:20<05:50,  2.35it/s] 65%|██████▌   | 1271/1954 [09:01<04:51,  2.35it/s] 65%|██████▌   | 1271/1954 [09:20<04:51,  2.35it/s] 72%|███████▏  | 1412/1954 [10:01<03:51,  2.35it/s] 72%|███████▏  | 1412/1954 [10:20<03:51,  2.35it/s] 79%|███████▉  | 1553/1954 [11:02<02:51,  2.34it/s] 79%|███████▉  | 1553/1954 [11:20<02:51,  2.34it/s] 87%|████████▋ | 1693/1954 [12:02<01:51,  2.34it/s] 87%|████████▋ | 1693/1954 [12:20<01:51,  2.34it/s] 94%|█████████▍| 1833/1954 [13:02<00:51,  2.34it/s] 94%|█████████▍| 1833/1954 [13:20<00:51,  2.34it/s]100%|██████████| 1954/1954 [13:53<00:00,  2.34it/s]
07/18/2024 20:42:48 - INFO - mingpt.trainer_atari - train loss: 1.808597
target return: 305, eval return: -8
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 100/1954 [01:00<18:34,  1.66it/s]  5%|▌         | 100/1954 [01:15<18:34,  1.66it/s] 10%|█         | 200/1954 [02:00<17:33,  1.67it/s] 10%|█         | 200/1954 [02:15<17:33,  1.67it/s] 15%|█▌        | 300/1954 [03:00<16:35,  1.66it/s] 15%|█▌        | 300/1954 [03:15<16:35,  1.66it/s] 20%|██        | 400/1954 [04:00<15:34,  1.66it/s] 20%|██        | 400/1954 [04:15<15:34,  1.66it/s] 26%|██▌       | 501/1954 [05:00<14:32,  1.67it/s] 26%|██▌       | 501/1954 [05:15<14:32,  1.67it/s] 31%|███       | 602/1954 [06:01<13:31,  1.67it/s] 31%|███       | 602/1954 [06:15<13:31,  1.67it/s] 36%|███▌      | 702/1954 [07:01<12:32,  1.66it/s] 36%|███▌      | 702/1954 [07:15<12:32,  1.66it/s] 41%|████      | 802/1954 [08:01<11:31,  1.66it/s] 41%|████      | 802/1954 [08:15<11:31,  1.66it/s] 46%|████▌     | 902/1954 [09:01<10:32,  1.66it/s] 46%|████▌     | 902/1954 [09:15<10:32,  1.66it/s] 51%|█████▏    | 1003/1954 [10:02<09:31,  1.66it/s] 51%|█████▏    | 1003/1954 [10:15<09:31,  1.66it/s] 56%|█████▋    | 1103/1954 [11:02<08:31,  1.66it/s] 56%|█████▋    | 1103/1954 [11:15<08:31,  1.66it/s] 62%|██████▏   | 1203/1954 [12:02<07:31,  1.66it/s] 62%|██████▏   | 1203/1954 [12:15<07:31,  1.66it/s] 67%|██████▋   | 1303/1954 [13:03<06:31,  1.66it/s] 67%|██████▋   | 1303/1954 [13:15<06:31,  1.66it/s] 72%|███████▏  | 1404/1954 [14:03<05:30,  1.66it/s] 72%|███████▏  | 1404/1954 [14:15<05:30,  1.66it/s] 77%|███████▋  | 1504/1954 [15:03<04:30,  1.66it/s] 77%|███████▋  | 1504/1954 [15:15<04:30,  1.66it/s] 82%|████████▏ | 1604/1954 [16:04<03:30,  1.66it/s] 82%|████████▏ | 1604/1954 [16:15<03:30,  1.66it/s] 87%|████████▋ | 1703/1954 [17:04<02:31,  1.66it/s] 87%|████████▋ | 1703/1954 [17:15<02:31,  1.66it/s] 92%|█████████▏| 1803/1954 [18:04<01:31,  1.66it/s] 92%|█████████▏| 1803/1954 [18:15<01:31,  1.66it/s] 97%|█████████▋| 1903/1954 [19:04<00:30,  1.66it/s] 97%|█████████▋| 1903/1954 [19:15<00:30,  1.66it/s]100%|██████████| 1954/1954 [19:35<00:00,  1.66it/s]
07/18/2024 21:06:44 - INFO - mingpt.trainer_atari - train loss: 1.763001
target return: 305, eval return: -7
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 103/1954 [01:00<18:04,  1.71it/s]  5%|▌         | 103/1954 [01:12<18:04,  1.71it/s] 11%|█         | 206/1954 [02:00<17:01,  1.71it/s] 11%|█         | 206/1954 [02:12<17:01,  1.71it/s] 16%|█▌        | 309/1954 [03:00<16:00,  1.71it/s] 16%|█▌        | 309/1954 [03:12<16:00,  1.71it/s] 21%|██        | 412/1954 [04:00<15:01,  1.71it/s] 21%|██        | 412/1954 [04:12<15:01,  1.71it/s] 26%|██▋       | 515/1954 [05:01<14:01,  1.71it/s] 26%|██▋       | 515/1954 [05:12<14:01,  1.71it/s] 32%|███▏      | 618/1954 [06:01<13:00,  1.71it/s] 32%|███▏      | 618/1954 [06:12<13:00,  1.71it/s] 37%|███▋      | 721/1954 [07:01<12:00,  1.71it/s] 37%|███▋      | 721/1954 [07:12<12:00,  1.71it/s] 42%|████▏     | 824/1954 [08:01<11:01,  1.71it/s] 42%|████▏     | 824/1954 [08:12<11:01,  1.71it/s] 47%|████▋     | 927/1954 [09:02<10:01,  1.71it/s] 47%|████▋     | 927/1954 [09:22<10:01,  1.71it/s] 53%|█████▎    | 1030/1954 [10:02<09:01,  1.71it/s] 53%|█████▎    | 1030/1954 [10:22<09:01,  1.71it/s] 58%|█████▊    | 1133/1954 [11:03<08:00,  1.71it/s] 58%|█████▊    | 1133/1954 [11:22<08:00,  1.71it/s] 63%|██████▎   | 1236/1954 [12:03<07:00,  1.71it/s] 63%|██████▎   | 1236/1954 [12:22<07:00,  1.71it/s] 69%|██████▊   | 1339/1954 [13:03<06:00,  1.71it/s] 69%|██████▊   | 1339/1954 [13:22<06:00,  1.71it/s] 74%|███████▍  | 1442/1954 [14:04<04:59,  1.71it/s] 74%|███████▍  | 1442/1954 [14:22<04:59,  1.71it/s] 79%|███████▉  | 1545/1954 [15:04<03:59,  1.71it/s] 79%|███████▉  | 1545/1954 [15:22<03:59,  1.71it/s] 84%|████████▍ | 1648/1954 [16:04<02:59,  1.71it/s] 84%|████████▍ | 1648/1954 [16:22<02:59,  1.71it/s] 90%|████████▉ | 1751/1954 [17:05<01:59,  1.71it/s] 90%|████████▉ | 1751/1954 [17:22<01:59,  1.71it/s] 95%|█████████▍| 1853/1954 [18:05<00:59,  1.70it/s] 95%|█████████▍| 1853/1954 [18:22<00:59,  1.70it/s]100%|██████████| 1954/1954 [19:04<00:00,  1.71it/s]
07/18/2024 21:29:48 - INFO - mingpt.trainer_atari - train loss: 1.718729
target return: 305, eval return: -3
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 120/1954 [01:00<15:21,  1.99it/s]  6%|▌         | 120/1954 [01:13<15:21,  1.99it/s] 12%|█▏        | 240/1954 [02:00<14:20,  1.99it/s] 12%|█▏        | 240/1954 [02:13<14:20,  1.99it/s] 18%|█▊        | 360/1954 [03:00<13:19,  1.99it/s] 18%|█▊        | 360/1954 [03:13<13:19,  1.99it/s] 25%|██▍       | 480/1954 [04:00<12:18,  2.00it/s] 25%|██▍       | 480/1954 [04:13<12:18,  2.00it/s] 31%|███       | 601/1954 [05:01<11:17,  2.00it/s] 31%|███       | 601/1954 [05:13<11:17,  2.00it/s] 37%|███▋      | 721/1954 [06:01<10:16,  2.00it/s] 37%|███▋      | 721/1954 [06:13<10:16,  2.00it/s] 43%|████▎     | 842/1954 [07:01<09:15,  2.00it/s] 43%|████▎     | 842/1954 [07:13<09:15,  2.00it/s] 49%|████▉     | 962/1954 [08:01<08:15,  2.00it/s] 49%|████▉     | 962/1954 [08:13<08:15,  2.00it/s] 55%|█████▌    | 1083/1954 [09:01<07:15,  2.00it/s] 55%|█████▌    | 1083/1954 [09:13<07:15,  2.00it/s] 62%|██████▏   | 1203/1954 [10:02<06:15,  2.00it/s] 62%|██████▏   | 1203/1954 [10:13<06:15,  2.00it/s] 68%|██████▊   | 1324/1954 [11:02<05:14,  2.00it/s] 68%|██████▊   | 1324/1954 [11:13<05:14,  2.00it/s] 74%|███████▍  | 1445/1954 [12:02<04:14,  2.00it/s] 74%|███████▍  | 1445/1954 [12:13<04:14,  2.00it/s] 80%|████████  | 1566/1954 [13:03<03:13,  2.00it/s] 80%|████████  | 1566/1954 [13:13<03:13,  2.00it/s] 86%|████████▋ | 1686/1954 [14:03<02:14,  2.00it/s] 86%|████████▋ | 1686/1954 [14:13<02:14,  2.00it/s] 92%|█████████▏| 1806/1954 [15:03<01:14,  2.00it/s] 92%|█████████▏| 1806/1954 [15:13<01:14,  2.00it/s] 99%|█████████▊| 1926/1954 [16:03<00:14,  2.00it/s]100%|██████████| 1954/1954 [16:17<00:00,  2.00it/s]
07/18/2024 21:50:09 - INFO - mingpt.trainer_atari - train loss: 1.680360
target return: 305, eval return: 8
