CUDA_VISIBLE_DEVICES: 
CUDA_VISIBLE_DEVICES: 2
Warning: This module should only be used with the A100 GPU nodes.  If you are using the K80 or Titan-X GPUs please use an older cuda version.
WARNING: If you use conda to create environments, your home directory may fill up. Please see our documentation at 
 https://www.wiki.ed.ac.uk/display/ResearchServices/Anaconda for advice.
2024-07-17 16:36:59.121367: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 16:36:59.842071: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 16:37:04.034369: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 10%|▉         | 48374/500000 [01:11<11:07, 676.47it/s] 15%|█▍        | 73116/500000 [01:29<10:31, 676.47it/s] 22%|██▏       | 110817/500000 [02:22<08:10, 793.31it/s] 27%|██▋       | 137131/500000 [02:39<07:37, 793.31it/s] 35%|███▌      | 176054/500000 [03:34<06:22, 846.17it/s] 39%|███▉      | 195261/500000 [03:49<06:00, 846.17it/s] 47%|████▋     | 235101/500000 [04:34<04:55, 894.93it/s] 51%|█████     | 255464/500000 [04:49<04:33, 894.93it/s] 59%|█████▉    | 293860/500000 [05:45<03:56, 871.95it/s] 62%|██████▏   | 312395/500000 [05:59<03:35, 871.95it/s] 72%|███████▏  | 359185/500000 [06:55<02:38, 889.98it/s] 74%|███████▍  | 371541/500000 [07:09<02:24, 889.98it/s] 84%|████████▍ | 420460/500000 [08:06<01:30, 881.77it/s] 87%|████████▋ | 433077/500000 [08:19<01:15, 881.77it/s] 96%|█████████▋| 481650/500000 [09:17<00:20, 875.11it/s] 99%|█████████▉| 493820/500000 [09:29<00:07, 875.11it/s]100%|██████████| 500000/500000 [09:32<00:00, 872.84it/s]
07/17/2024 16:47:23 - INFO - mingpt.model_atari - number of parameters: 1712640
this buffer has 19859 loaded transitions and there are now 500000 transitions total divided into 394 trajectories
max rtg is 94
max timestep is 1652
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 133/1954 [01:00<13:41,  2.22it/s]  7%|▋         | 133/1954 [01:17<13:41,  2.22it/s] 14%|█▍        | 278/1954 [02:00<11:59,  2.33it/s] 14%|█▍        | 278/1954 [02:17<11:59,  2.33it/s] 22%|██▏       | 423/1954 [03:00<10:46,  2.37it/s] 22%|██▏       | 423/1954 [03:17<10:46,  2.37it/s] 29%|██▉       | 569/1954 [04:00<09:39,  2.39it/s] 29%|██▉       | 569/1954 [04:17<09:39,  2.39it/s] 37%|███▋      | 715/1954 [05:00<08:36,  2.40it/s] 37%|███▋      | 715/1954 [05:17<08:36,  2.40it/s] 44%|████▍     | 861/1954 [06:01<07:34,  2.41it/s] 44%|████▍     | 861/1954 [06:17<07:34,  2.41it/s] 52%|█████▏    | 1007/1954 [07:01<06:32,  2.41it/s] 52%|█████▏    | 1007/1954 [07:17<06:32,  2.41it/s] 59%|█████▉    | 1153/1954 [08:01<05:31,  2.42it/s] 59%|█████▉    | 1153/1954 [08:17<05:31,  2.42it/s] 66%|██████▋   | 1299/1954 [09:01<04:30,  2.42it/s] 66%|██████▋   | 1299/1954 [09:17<04:30,  2.42it/s] 74%|███████▍  | 1445/1954 [10:02<03:30,  2.42it/s] 74%|███████▍  | 1445/1954 [10:17<03:30,  2.42it/s] 81%|████████▏ | 1591/1954 [11:02<02:29,  2.42it/s] 81%|████████▏ | 1591/1954 [11:17<02:29,  2.42it/s] 89%|████████▉ | 1737/1954 [12:02<01:29,  2.42it/s] 89%|████████▉ | 1737/1954 [12:17<01:29,  2.42it/s] 96%|█████████▋| 1883/1954 [13:02<00:29,  2.42it/s] 96%|█████████▋| 1883/1954 [13:17<00:29,  2.42it/s]100%|██████████| 1954/1954 [13:31<00:00,  2.41it/s]
07/17/2024 17:00:57 - INFO - mingpt.trainer_atari - train loss: 1.469158
target return: 680, eval return: 10
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 142/1954 [01:00<12:50,  2.35it/s]  7%|▋         | 142/1954 [01:12<12:50,  2.35it/s] 15%|█▍        | 285/1954 [02:00<11:45,  2.37it/s] 15%|█▍        | 285/1954 [02:12<11:45,  2.37it/s] 22%|██▏       | 428/1954 [03:00<10:43,  2.37it/s] 22%|██▏       | 428/1954 [03:12<10:43,  2.37it/s] 29%|██▉       | 572/1954 [04:00<09:40,  2.38it/s] 29%|██▉       | 572/1954 [04:12<09:40,  2.38it/s] 37%|███▋      | 716/1954 [05:01<08:39,  2.38it/s] 37%|███▋      | 716/1954 [05:12<08:39,  2.38it/s] 44%|████▍     | 860/1954 [06:01<07:38,  2.39it/s] 44%|████▍     | 860/1954 [06:12<07:38,  2.39it/s] 51%|█████▏    | 1005/1954 [07:01<06:37,  2.39it/s] 51%|█████▏    | 1005/1954 [07:12<06:37,  2.39it/s] 59%|█████▉    | 1149/1954 [08:01<05:36,  2.39it/s] 59%|█████▉    | 1149/1954 [08:12<05:36,  2.39it/s] 66%|██████▌   | 1293/1954 [09:02<04:36,  2.39it/s] 66%|██████▌   | 1293/1954 [09:22<04:36,  2.39it/s] 74%|███████▎  | 1438/1954 [10:02<03:35,  2.40it/s] 74%|███████▎  | 1438/1954 [10:22<03:35,  2.40it/s] 81%|████████  | 1583/1954 [11:02<02:34,  2.40it/s] 81%|████████  | 1583/1954 [11:22<02:34,  2.40it/s] 88%|████████▊ | 1728/1954 [12:03<01:34,  2.40it/s] 88%|████████▊ | 1728/1954 [12:22<01:34,  2.40it/s] 96%|█████████▌| 1873/1954 [13:03<00:33,  2.40it/s] 96%|█████████▌| 1873/1954 [13:22<00:33,  2.40it/s]100%|██████████| 1954/1954 [13:36<00:00,  2.39it/s]
07/17/2024 17:16:07 - INFO - mingpt.trainer_atari - train loss: 1.304210
target return: 680, eval return: 4
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 105/1954 [01:00<17:45,  1.74it/s]  5%|▌         | 105/1954 [01:18<17:45,  1.74it/s] 11%|█         | 210/1954 [02:00<16:42,  1.74it/s] 11%|█         | 210/1954 [02:18<16:42,  1.74it/s] 16%|█▌        | 315/1954 [03:00<15:41,  1.74it/s] 16%|█▌        | 315/1954 [03:18<15:41,  1.74it/s] 21%|██▏       | 420/1954 [04:01<14:40,  1.74it/s] 21%|██▏       | 420/1954 [04:18<14:40,  1.74it/s] 27%|██▋       | 525/1954 [05:01<13:39,  1.74it/s] 27%|██▋       | 525/1954 [05:18<13:39,  1.74it/s] 32%|███▏      | 630/1954 [06:01<12:39,  1.74it/s] 32%|███▏      | 630/1954 [06:18<12:39,  1.74it/s] 38%|███▊      | 735/1954 [07:02<11:39,  1.74it/s] 38%|███▊      | 735/1954 [07:18<11:39,  1.74it/s] 43%|████▎     | 840/1954 [08:02<10:39,  1.74it/s] 43%|████▎     | 840/1954 [08:18<10:39,  1.74it/s] 48%|████▊     | 945/1954 [09:02<09:38,  1.74it/s] 48%|████▊     | 945/1954 [09:18<09:38,  1.74it/s] 54%|█████▎    | 1050/1954 [10:02<08:38,  1.74it/s] 54%|█████▎    | 1050/1954 [10:18<08:38,  1.74it/s] 59%|█████▉    | 1155/1954 [11:02<07:38,  1.74it/s] 59%|█████▉    | 1155/1954 [11:18<07:38,  1.74it/s] 64%|██████▍   | 1260/1954 [12:02<06:38,  1.74it/s] 64%|██████▍   | 1260/1954 [12:18<06:38,  1.74it/s] 70%|██████▉   | 1365/1954 [13:03<05:37,  1.74it/s] 70%|██████▉   | 1365/1954 [13:18<05:37,  1.74it/s] 75%|███████▌  | 1470/1954 [14:03<04:37,  1.74it/s] 75%|███████▌  | 1470/1954 [14:18<04:37,  1.74it/s] 81%|████████  | 1575/1954 [15:03<03:37,  1.74it/s] 81%|████████  | 1575/1954 [15:18<03:37,  1.74it/s] 86%|████████▌ | 1679/1954 [16:03<02:38,  1.74it/s] 86%|████████▌ | 1679/1954 [16:18<02:38,  1.74it/s] 91%|█████████ | 1779/1954 [17:04<01:42,  1.71it/s] 91%|█████████ | 1779/1954 [17:18<01:42,  1.71it/s] 96%|█████████▌| 1878/1954 [18:04<00:44,  1.69it/s] 96%|█████████▌| 1878/1954 [18:18<00:44,  1.69it/s]100%|██████████| 1954/1954 [18:50<00:00,  1.73it/s]
07/17/2024 17:36:25 - INFO - mingpt.trainer_atari - train loss: 1.233169
target return: 680, eval return: 6
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 104/1954 [01:00<17:57,  1.72it/s]  5%|▌         | 104/1954 [01:12<17:57,  1.72it/s] 11%|█         | 208/1954 [02:01<16:55,  1.72it/s] 11%|█         | 208/1954 [02:12<16:55,  1.72it/s] 16%|█▌        | 311/1954 [03:01<15:58,  1.71it/s] 16%|█▌        | 311/1954 [03:12<15:58,  1.71it/s] 21%|██        | 413/1954 [04:01<15:02,  1.71it/s] 21%|██        | 413/1954 [04:12<15:02,  1.71it/s] 26%|██▋       | 516/1954 [05:01<14:02,  1.71it/s] 26%|██▋       | 516/1954 [05:12<14:02,  1.71it/s] 32%|███▏      | 618/1954 [06:02<13:04,  1.70it/s] 32%|███▏      | 618/1954 [06:12<13:04,  1.70it/s] 37%|███▋      | 720/1954 [07:02<12:07,  1.70it/s] 37%|███▋      | 720/1954 [07:22<12:07,  1.70it/s] 42%|████▏     | 822/1954 [08:03<11:08,  1.69it/s] 42%|████▏     | 822/1954 [08:22<11:08,  1.69it/s] 47%|████▋     | 923/1954 [09:03<10:10,  1.69it/s] 47%|████▋     | 923/1954 [09:22<10:10,  1.69it/s] 52%|█████▏    | 1024/1954 [10:03<09:11,  1.69it/s] 52%|█████▏    | 1024/1954 [10:22<09:11,  1.69it/s] 58%|█████▊    | 1125/1954 [11:03<08:12,  1.68it/s] 58%|█████▊    | 1125/1954 [11:22<08:12,  1.68it/s] 63%|██████▎   | 1226/1954 [12:03<07:13,  1.68it/s] 63%|██████▎   | 1226/1954 [12:22<07:13,  1.68it/s] 68%|██████▊   | 1327/1954 [13:04<06:13,  1.68it/s] 68%|██████▊   | 1327/1954 [13:22<06:13,  1.68it/s] 73%|███████▎  | 1428/1954 [14:04<05:13,  1.68it/s] 73%|███████▎  | 1428/1954 [14:22<05:13,  1.68it/s] 78%|███████▊  | 1529/1954 [15:04<04:13,  1.68it/s] 78%|███████▊  | 1529/1954 [15:22<04:13,  1.68it/s] 83%|████████▎ | 1630/1954 [16:05<03:13,  1.68it/s] 83%|████████▎ | 1630/1954 [16:22<03:13,  1.68it/s] 89%|████████▊ | 1731/1954 [17:05<02:13,  1.68it/s] 89%|████████▊ | 1731/1954 [17:22<02:13,  1.68it/s] 94%|█████████▎| 1830/1954 [18:05<01:14,  1.67it/s] 94%|█████████▎| 1830/1954 [18:22<01:14,  1.67it/s] 99%|█████████▉| 1931/1954 [19:05<00:13,  1.67it/s]100%|██████████| 1954/1954 [19:19<00:00,  1.69it/s]
07/17/2024 17:57:20 - INFO - mingpt.trainer_atari - train loss: 1.148777
target return: 680, eval return: 7
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 101/1954 [01:00<18:22,  1.68it/s]  5%|▌         | 101/1954 [01:17<18:22,  1.68it/s] 10%|█         | 203/1954 [02:00<17:17,  1.69it/s] 10%|█         | 203/1954 [02:17<17:17,  1.69it/s] 16%|█▌        | 305/1954 [03:00<16:15,  1.69it/s] 16%|█▌        | 305/1954 [03:17<16:15,  1.69it/s] 21%|██        | 408/1954 [04:00<15:10,  1.70it/s] 21%|██        | 408/1954 [04:17<15:10,  1.70it/s] 26%|██▌       | 512/1954 [05:00<14:03,  1.71it/s] 26%|██▌       | 512/1954 [05:17<14:03,  1.71it/s] 32%|███▏      | 617/1954 [06:01<12:56,  1.72it/s] 32%|███▏      | 617/1954 [06:17<12:56,  1.72it/s] 37%|███▋      | 722/1954 [07:01<11:52,  1.73it/s] 37%|███▋      | 722/1954 [07:17<11:52,  1.73it/s] 42%|████▏     | 827/1954 [08:01<10:49,  1.74it/s] 42%|████▏     | 827/1954 [08:17<10:49,  1.74it/s] 48%|████▊     | 932/1954 [09:01<09:47,  1.74it/s] 48%|████▊     | 932/1954 [09:17<09:47,  1.74it/s] 53%|█████▎    | 1037/1954 [10:01<08:46,  1.74it/s] 53%|█████▎    | 1037/1954 [10:17<08:46,  1.74it/s] 58%|█████▊    | 1142/1954 [11:01<07:45,  1.74it/s] 58%|█████▊    | 1142/1954 [11:17<07:45,  1.74it/s] 64%|██████▍   | 1247/1954 [12:01<06:45,  1.75it/s] 64%|██████▍   | 1247/1954 [12:17<06:45,  1.75it/s] 69%|██████▉   | 1352/1954 [13:01<05:44,  1.75it/s] 69%|██████▉   | 1352/1954 [13:17<05:44,  1.75it/s] 75%|███████▍  | 1457/1954 [14:01<04:44,  1.74it/s] 75%|███████▍  | 1457/1954 [14:17<04:44,  1.74it/s] 80%|███████▉  | 1562/1954 [15:01<03:44,  1.75it/s] 80%|███████▉  | 1562/1954 [15:17<03:44,  1.75it/s] 85%|████████▌ | 1667/1954 [16:02<02:44,  1.75it/s] 85%|████████▌ | 1667/1954 [16:17<02:44,  1.75it/s] 91%|█████████ | 1772/1954 [17:02<01:44,  1.75it/s] 91%|█████████ | 1772/1954 [17:17<01:44,  1.75it/s] 96%|█████████▌| 1877/1954 [18:02<00:44,  1.75it/s] 96%|█████████▌| 1877/1954 [18:17<00:44,  1.75it/s]100%|██████████| 1954/1954 [18:46<00:00,  1.74it/s]
07/17/2024 18:17:52 - INFO - mingpt.trainer_atari - train loss: 1.074686
target return: 680, eval return: 10
2024-07-17 18:21:28.335544: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 18:21:29.069395: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 18:21:33.019727: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 10%|█         | 50558/500000 [01:11<10:37, 705.32it/s] 15%|█▌        | 76103/500000 [01:30<10:01, 705.32it/s] 23%|██▎       | 116055/500000 [02:23<07:43, 827.65it/s] 29%|██▉       | 145005/500000 [02:40<07:08, 827.65it/s] 36%|███▋      | 182092/500000 [03:34<06:05, 870.89it/s] 40%|███▉      | 199829/500000 [03:50<05:44, 870.89it/s] 50%|████▉     | 248052/500000 [04:46<04:43, 889.50it/s] 52%|█████▏    | 261061/500000 [05:00<04:28, 889.50it/s] 63%|██████▎   | 312792/500000 [05:58<03:29, 894.45it/s] 65%|██████▌   | 325906/500000 [06:10<03:14, 894.45it/s] 76%|███████▌  | 379516/500000 [07:10<02:12, 907.21it/s] 82%|████████▏ | 407627/500000 [07:30<01:41, 907.21it/s] 90%|████████▉ | 448273/500000 [08:22<00:56, 921.47it/s] 95%|█████████▌| 476519/500000 [08:40<00:25, 921.47it/s]100%|██████████| 500000/500000 [09:06<00:00, 914.81it/s]
07/17/2024 18:31:25 - INFO - mingpt.model_atari - number of parameters: 1724928
this buffer has 20294 loaded transitions and there are now 500000 transitions total divided into 377 trajectories
max rtg is 94
max timestep is 1748
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 136/1954 [01:00<13:26,  2.25it/s]  7%|▋         | 136/1954 [01:13<13:26,  2.25it/s] 14%|█▍        | 280/1954 [02:00<11:55,  2.34it/s] 14%|█▍        | 280/1954 [02:13<11:55,  2.34it/s] 22%|██▏       | 425/1954 [03:00<10:44,  2.37it/s] 22%|██▏       | 425/1954 [03:13<10:44,  2.37it/s] 29%|██▉       | 570/1954 [04:00<09:39,  2.39it/s] 29%|██▉       | 570/1954 [04:13<09:39,  2.39it/s] 37%|███▋      | 715/1954 [05:00<08:37,  2.40it/s] 37%|███▋      | 715/1954 [05:13<08:37,  2.40it/s] 44%|████▍     | 860/1954 [06:01<07:35,  2.40it/s] 44%|████▍     | 860/1954 [06:13<07:35,  2.40it/s] 51%|█████▏    | 1006/1954 [07:01<06:33,  2.41it/s] 51%|█████▏    | 1006/1954 [07:13<06:33,  2.41it/s] 59%|█████▉    | 1152/1954 [08:01<05:32,  2.41it/s] 59%|█████▉    | 1152/1954 [08:13<05:32,  2.41it/s] 66%|██████▋   | 1297/1954 [09:01<04:32,  2.41it/s] 66%|██████▋   | 1297/1954 [09:13<04:32,  2.41it/s] 74%|███████▍  | 1442/1954 [10:01<03:32,  2.41it/s] 74%|███████▍  | 1442/1954 [10:13<03:32,  2.41it/s] 81%|████████▏ | 1588/1954 [11:02<02:31,  2.41it/s] 81%|████████▏ | 1588/1954 [11:13<02:31,  2.41it/s] 89%|████████▊ | 1734/1954 [12:02<01:31,  2.42it/s] 89%|████████▊ | 1734/1954 [12:13<01:31,  2.42it/s] 96%|█████████▌| 1879/1954 [13:02<00:31,  2.42it/s] 96%|█████████▌| 1879/1954 [13:13<00:31,  2.42it/s]100%|██████████| 1954/1954 [13:33<00:00,  2.40it/s]
07/17/2024 18:45:00 - INFO - mingpt.trainer_atari - train loss: 1.452031
target return: 680, eval return: 5
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 138/1954 [01:00<13:13,  2.29it/s]  7%|▋         | 138/1954 [01:15<13:13,  2.29it/s] 14%|█▍        | 277/1954 [02:00<12:07,  2.30it/s] 14%|█▍        | 277/1954 [02:15<12:07,  2.30it/s] 21%|██▏       | 416/1954 [03:00<11:06,  2.31it/s] 21%|██▏       | 416/1954 [03:15<11:06,  2.31it/s] 29%|██▊       | 557/1954 [04:00<10:02,  2.32it/s] 29%|██▊       | 557/1954 [04:15<10:02,  2.32it/s] 36%|███▌      | 698/1954 [05:01<08:59,  2.33it/s] 36%|███▌      | 698/1954 [05:15<08:59,  2.33it/s] 43%|████▎     | 839/1954 [06:01<07:58,  2.33it/s] 43%|████▎     | 839/1954 [06:15<07:58,  2.33it/s] 50%|█████     | 980/1954 [07:01<06:57,  2.33it/s] 50%|█████     | 980/1954 [07:15<06:57,  2.33it/s] 57%|█████▋    | 1120/1954 [08:01<05:57,  2.33it/s] 57%|█████▋    | 1120/1954 [08:15<05:57,  2.33it/s] 64%|██████▍   | 1260/1954 [09:01<04:57,  2.33it/s] 64%|██████▍   | 1260/1954 [09:15<04:57,  2.33it/s] 72%|███████▏  | 1400/1954 [10:02<03:57,  2.33it/s] 72%|███████▏  | 1400/1954 [10:15<03:57,  2.33it/s] 79%|███████▉  | 1540/1954 [11:02<02:57,  2.33it/s] 79%|███████▉  | 1540/1954 [11:15<02:57,  2.33it/s] 86%|████████▌ | 1681/1954 [12:02<01:57,  2.33it/s] 86%|████████▌ | 1681/1954 [12:15<01:57,  2.33it/s] 93%|█████████▎| 1821/1954 [13:02<00:57,  2.33it/s] 93%|█████████▎| 1821/1954 [13:15<00:57,  2.33it/s]100%|██████████| 1954/1954 [13:59<00:00,  2.33it/s]
07/17/2024 19:00:24 - INFO - mingpt.trainer_atari - train loss: 1.283459
target return: 680, eval return: 18
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 141/1954 [01:00<12:52,  2.35it/s]  7%|▋         | 141/1954 [01:19<12:52,  2.35it/s] 15%|█▍        | 284/1954 [02:00<11:47,  2.36it/s] 15%|█▍        | 284/1954 [02:19<11:47,  2.36it/s] 22%|██▏       | 427/1954 [03:00<10:44,  2.37it/s] 22%|██▏       | 427/1954 [03:19<10:44,  2.37it/s] 29%|██▉       | 570/1954 [04:00<09:43,  2.37it/s] 29%|██▉       | 570/1954 [04:19<09:43,  2.37it/s] 36%|███▋      | 713/1954 [05:00<08:42,  2.38it/s] 36%|███▋      | 713/1954 [05:19<08:42,  2.38it/s] 44%|████▍     | 856/1954 [06:00<07:41,  2.38it/s] 44%|████▍     | 856/1954 [06:19<07:41,  2.38it/s] 51%|█████     | 1000/1954 [07:01<06:40,  2.38it/s] 51%|█████     | 1000/1954 [07:19<06:40,  2.38it/s] 58%|█████▊    | 1143/1954 [08:01<05:40,  2.38it/s] 58%|█████▊    | 1143/1954 [08:19<05:40,  2.38it/s] 66%|██████▌   | 1286/1954 [09:01<04:40,  2.38it/s] 66%|██████▌   | 1286/1954 [09:19<04:40,  2.38it/s] 73%|███████▎  | 1430/1954 [10:01<03:40,  2.38it/s] 73%|███████▎  | 1430/1954 [10:19<03:40,  2.38it/s] 81%|████████  | 1574/1954 [11:01<02:39,  2.38it/s] 81%|████████  | 1574/1954 [11:19<02:39,  2.38it/s] 88%|████████▊ | 1718/1954 [12:02<01:38,  2.38it/s] 88%|████████▊ | 1718/1954 [12:19<01:38,  2.38it/s] 95%|█████████▌| 1862/1954 [13:02<00:38,  2.39it/s] 95%|█████████▌| 1862/1954 [13:19<00:38,  2.39it/s]100%|██████████| 1954/1954 [13:40<00:00,  2.38it/s]
07/17/2024 19:15:12 - INFO - mingpt.trainer_atari - train loss: 1.215373
target return: 680, eval return: 8
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  7%|▋         | 139/1954 [01:00<13:04,  2.31it/s]  7%|▋         | 139/1954 [01:16<13:04,  2.31it/s] 14%|█▍        | 280/1954 [02:00<11:57,  2.33it/s] 14%|█▍        | 280/1954 [02:16<11:57,  2.33it/s] 22%|██▏       | 421/1954 [03:00<10:56,  2.33it/s] 22%|██▏       | 421/1954 [03:16<10:56,  2.33it/s] 29%|██▉       | 563/1954 [04:00<09:52,  2.35it/s] 29%|██▉       | 563/1954 [04:16<09:52,  2.35it/s] 36%|███▌      | 705/1954 [05:00<08:51,  2.35it/s] 36%|███▌      | 705/1954 [05:16<08:51,  2.35it/s] 43%|████▎     | 847/1954 [06:00<07:50,  2.36it/s] 43%|████▎     | 847/1954 [06:16<07:50,  2.36it/s] 51%|█████     | 989/1954 [07:01<06:49,  2.36it/s] 51%|█████     | 989/1954 [07:16<06:49,  2.36it/s] 58%|█████▊    | 1131/1954 [08:01<05:49,  2.36it/s] 58%|█████▊    | 1131/1954 [08:16<05:49,  2.36it/s] 65%|██████▌   | 1273/1954 [09:01<04:48,  2.36it/s] 65%|██████▌   | 1273/1954 [09:16<04:48,  2.36it/s] 72%|███████▏  | 1415/1954 [10:01<03:48,  2.36it/s] 72%|███████▏  | 1415/1954 [10:16<03:48,  2.36it/s] 79%|███████▉  | 1546/1954 [11:01<02:57,  2.30it/s] 79%|███████▉  | 1546/1954 [11:16<02:57,  2.30it/s] 86%|████████▌ | 1678/1954 [12:02<02:01,  2.27it/s] 86%|████████▌ | 1678/1954 [12:16<02:01,  2.27it/s] 93%|█████████▎| 1809/1954 [13:02<01:04,  2.24it/s] 93%|█████████▎| 1809/1954 [13:16<01:04,  2.24it/s] 99%|█████████▉| 1941/1954 [14:02<00:05,  2.22it/s]100%|██████████| 1954/1954 [14:08<00:00,  2.30it/s]
07/17/2024 19:31:12 - INFO - mingpt.trainer_atari - train loss: 1.133883
target return: 680, eval return: 8
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  5%|▌         | 103/1954 [01:00<18:06,  1.70it/s]  5%|▌         | 103/1954 [01:11<18:06,  1.70it/s] 11%|█         | 207/1954 [02:00<16:59,  1.71it/s] 11%|█         | 207/1954 [02:11<16:59,  1.71it/s] 16%|█▌        | 311/1954 [03:01<15:56,  1.72it/s] 16%|█▌        | 311/1954 [03:11<15:56,  1.72it/s] 21%|██▏       | 416/1954 [04:01<14:48,  1.73it/s] 21%|██▏       | 416/1954 [04:11<14:48,  1.73it/s] 27%|██▋       | 524/1954 [05:01<13:37,  1.75it/s] 27%|██▋       | 524/1954 [05:21<13:37,  1.75it/s] 32%|███▏      | 632/1954 [06:01<12:28,  1.77it/s] 32%|███▏      | 632/1954 [06:21<12:28,  1.77it/s] 38%|███▊      | 740/1954 [07:01<11:23,  1.78it/s] 38%|███▊      | 740/1954 [07:21<11:23,  1.78it/s] 43%|████▎     | 848/1954 [08:02<10:20,  1.78it/s] 43%|████▎     | 848/1954 [08:21<10:20,  1.78it/s] 49%|████▉     | 955/1954 [09:02<09:21,  1.78it/s] 49%|████▉     | 955/1954 [09:21<09:21,  1.78it/s] 54%|█████▍    | 1063/1954 [10:02<08:20,  1.78it/s] 54%|█████▍    | 1063/1954 [10:21<08:20,  1.78it/s] 60%|█████▉    | 1171/1954 [11:03<07:19,  1.78it/s] 60%|█████▉    | 1171/1954 [11:21<07:19,  1.78it/s] 65%|██████▌   | 1278/1954 [12:03<06:19,  1.78it/s] 65%|██████▌   | 1278/1954 [12:21<06:19,  1.78it/s] 71%|███████   | 1385/1954 [13:03<05:19,  1.78it/s] 71%|███████   | 1385/1954 [13:21<05:19,  1.78it/s] 76%|███████▋  | 1492/1954 [14:03<04:19,  1.78it/s] 76%|███████▋  | 1492/1954 [14:21<04:19,  1.78it/s] 82%|████████▏ | 1599/1954 [15:03<03:19,  1.78it/s] 82%|████████▏ | 1599/1954 [15:21<03:19,  1.78it/s] 87%|████████▋ | 1706/1954 [16:03<02:19,  1.78it/s] 87%|████████▋ | 1706/1954 [16:21<02:19,  1.78it/s] 93%|█████████▎| 1813/1954 [17:03<01:19,  1.78it/s] 93%|█████████▎| 1813/1954 [17:21<01:19,  1.78it/s] 98%|█████████▊| 1920/1954 [18:04<00:19,  1.78it/s] 98%|█████████▊| 1920/1954 [18:21<00:19,  1.78it/s]100%|██████████| 1954/1954 [18:22<00:00,  1.77it/s]
07/17/2024 19:51:32 - INFO - mingpt.trainer_atari - train loss: 1.061694
target return: 680, eval return: 13
2024-07-17 19:53:21.186848: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-17 19:53:21.882104: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-17 19:53:25.726505: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
loading trajectories from buffers
  0%|          | 0/500000 [00:00<?, ?it/s] 11%|█         | 53031/500000 [01:11<10:05, 737.71it/s] 16%|█▌        | 78044/500000 [01:30<09:31, 737.71it/s] 24%|██▍       | 119161/500000 [02:23<07:30, 845.31it/s] 29%|██▉       | 146267/500000 [02:40<06:58, 845.31it/s] 36%|███▌      | 180580/500000 [03:35<06:16, 847.57it/s] 39%|███▉      | 194213/500000 [03:50<06:00, 847.57it/s] 49%|████▉     | 245825/500000 [04:47<04:51, 872.39it/s] 52%|█████▏    | 258134/500000 [05:00<04:37, 872.39it/s] 62%|██████▏   | 311390/500000 [05:59<03:32, 888.63it/s] 65%|██████▌   | 325336/500000 [06:10<03:16, 888.63it/s] 76%|███████▌  | 379351/500000 [07:11<02:13, 905.99it/s] 81%|████████▏ | 406520/500000 [07:30<01:43, 905.99it/s] 87%|████████▋ | 435026/500000 [08:20<01:14, 875.75it/s] 92%|█████████▏| 460903/500000 [08:40<00:44, 875.75it/s]100%|██████████| 500000/500000 [09:19<00:00, 894.45it/s]
07/17/2024 20:03:30 - INFO - mingpt.model_atari - number of parameters: 1720832
this buffer has 38328 loaded transitions and there are now 500000 transitions total divided into 389 trajectories
max rtg is 98
max timestep is 1716
epoch 0
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 120/1954 [01:00<15:19,  1.99it/s]  6%|▌         | 120/1954 [01:11<15:19,  1.99it/s] 13%|█▎        | 247/1954 [02:00<13:46,  2.07it/s] 13%|█▎        | 247/1954 [02:11<13:46,  2.07it/s] 19%|█▉        | 374/1954 [03:00<12:38,  2.08it/s] 19%|█▉        | 374/1954 [03:11<12:38,  2.08it/s] 26%|██▌       | 501/1954 [04:00<11:34,  2.09it/s] 26%|██▌       | 501/1954 [04:11<11:34,  2.09it/s] 32%|███▏      | 628/1954 [05:01<10:32,  2.10it/s] 32%|███▏      | 628/1954 [05:11<10:32,  2.10it/s] 39%|███▊      | 755/1954 [06:01<09:31,  2.10it/s] 39%|███▊      | 755/1954 [06:21<09:31,  2.10it/s] 45%|████▌     | 881/1954 [07:01<08:31,  2.10it/s] 45%|████▌     | 881/1954 [07:21<08:31,  2.10it/s] 52%|█████▏    | 1008/1954 [08:01<07:29,  2.10it/s] 52%|█████▏    | 1008/1954 [08:21<07:29,  2.10it/s] 58%|█████▊    | 1135/1954 [09:01<06:28,  2.11it/s] 58%|█████▊    | 1135/1954 [09:21<06:28,  2.11it/s] 65%|██████▍   | 1262/1954 [10:01<05:28,  2.11it/s] 65%|██████▍   | 1262/1954 [10:21<05:28,  2.11it/s] 71%|███████   | 1389/1954 [11:02<04:28,  2.11it/s] 71%|███████   | 1389/1954 [11:21<04:28,  2.11it/s] 77%|███████▋  | 1514/1954 [12:02<03:29,  2.10it/s] 77%|███████▋  | 1514/1954 [12:21<03:29,  2.10it/s] 84%|████████▍ | 1640/1954 [13:03<02:30,  2.09it/s] 84%|████████▍ | 1640/1954 [13:21<02:30,  2.09it/s] 90%|█████████ | 1766/1954 [14:03<01:29,  2.09it/s] 90%|█████████ | 1766/1954 [14:21<01:29,  2.09it/s] 97%|█████████▋| 1891/1954 [15:03<00:30,  2.09it/s] 97%|█████████▋| 1891/1954 [15:21<00:30,  2.09it/s]100%|██████████| 1954/1954 [15:33<00:00,  2.09it/s]
07/17/2024 20:19:05 - INFO - mingpt.trainer_atari - train loss: 1.472760
target return: 680, eval return: 7
epoch 1
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▋         | 124/1954 [01:00<14:49,  2.06it/s]  6%|▋         | 124/1954 [01:12<14:49,  2.06it/s] 13%|█▎        | 250/1954 [02:00<13:41,  2.07it/s] 13%|█▎        | 250/1954 [02:12<13:41,  2.07it/s] 19%|█▉        | 376/1954 [03:00<12:37,  2.08it/s] 19%|█▉        | 376/1954 [03:12<12:37,  2.08it/s] 26%|██▌       | 501/1954 [04:01<11:38,  2.08it/s] 26%|██▌       | 501/1954 [04:12<11:38,  2.08it/s] 32%|███▏      | 626/1954 [05:01<10:38,  2.08it/s] 32%|███▏      | 626/1954 [05:12<10:38,  2.08it/s] 38%|███▊      | 751/1954 [06:01<09:38,  2.08it/s] 38%|███▊      | 751/1954 [06:12<09:38,  2.08it/s] 45%|████▍     | 875/1954 [07:01<08:40,  2.07it/s] 45%|████▍     | 875/1954 [07:12<08:40,  2.07it/s] 51%|█████     | 999/1954 [08:01<07:41,  2.07it/s] 51%|█████     | 999/1954 [08:12<07:41,  2.07it/s] 58%|█████▊    | 1124/1954 [09:01<06:40,  2.07it/s] 58%|█████▊    | 1124/1954 [09:12<06:40,  2.07it/s] 64%|██████▍   | 1248/1954 [10:01<05:41,  2.07it/s] 64%|██████▍   | 1248/1954 [10:12<05:41,  2.07it/s] 70%|███████   | 1371/1954 [11:02<04:43,  2.06it/s] 70%|███████   | 1371/1954 [11:22<04:43,  2.06it/s] 76%|███████▋  | 1493/1954 [12:02<03:44,  2.05it/s] 76%|███████▋  | 1493/1954 [12:22<03:44,  2.05it/s] 83%|████████▎ | 1614/1954 [13:02<02:46,  2.04it/s] 83%|████████▎ | 1614/1954 [13:22<02:46,  2.04it/s] 89%|████████▉ | 1735/1954 [14:02<01:47,  2.03it/s] 89%|████████▉ | 1735/1954 [14:22<01:47,  2.03it/s] 95%|█████████▍| 1855/1954 [15:02<00:49,  2.02it/s] 95%|█████████▍| 1855/1954 [15:22<00:49,  2.02it/s]100%|██████████| 1954/1954 [15:52<00:00,  2.05it/s]
07/17/2024 20:36:13 - INFO - mingpt.trainer_atari - train loss: 1.307487
target return: 680, eval return: 11
epoch 2
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:36,  1.96it/s]  6%|▌         | 118/1954 [01:11<15:36,  1.96it/s] 12%|█▏        | 238/1954 [02:00<14:27,  1.98it/s] 12%|█▏        | 238/1954 [02:11<14:27,  1.98it/s] 18%|█▊        | 359/1954 [03:00<13:22,  1.99it/s] 18%|█▊        | 359/1954 [03:11<13:22,  1.99it/s] 25%|██▍       | 480/1954 [04:01<12:18,  2.00it/s] 25%|██▍       | 480/1954 [04:11<12:18,  2.00it/s] 31%|███       | 601/1954 [05:01<11:15,  2.00it/s] 31%|███       | 601/1954 [05:11<11:15,  2.00it/s] 37%|███▋      | 722/1954 [06:01<10:13,  2.01it/s] 37%|███▋      | 722/1954 [06:11<10:13,  2.01it/s] 43%|████▎     | 844/1954 [07:01<09:12,  2.01it/s] 43%|████▎     | 844/1954 [07:21<09:12,  2.01it/s] 49%|████▉     | 966/1954 [08:02<08:10,  2.01it/s] 49%|████▉     | 966/1954 [08:21<08:10,  2.01it/s] 56%|█████▌    | 1087/1954 [09:02<07:10,  2.01it/s] 56%|█████▌    | 1087/1954 [09:21<07:10,  2.01it/s] 62%|██████▏   | 1208/1954 [10:02<06:11,  2.01it/s] 62%|██████▏   | 1208/1954 [10:21<06:11,  2.01it/s] 68%|██████▊   | 1328/1954 [11:02<05:11,  2.01it/s] 68%|██████▊   | 1328/1954 [11:21<05:11,  2.01it/s] 74%|███████▍  | 1448/1954 [12:02<04:12,  2.00it/s] 74%|███████▍  | 1448/1954 [12:21<04:12,  2.00it/s] 80%|████████  | 1568/1954 [13:02<03:12,  2.00it/s] 80%|████████  | 1568/1954 [13:21<03:12,  2.00it/s] 86%|████████▋ | 1688/1954 [14:02<02:12,  2.00it/s] 86%|████████▋ | 1688/1954 [14:21<02:12,  2.00it/s] 93%|█████████▎| 1809/1954 [15:03<01:12,  2.00it/s] 93%|█████████▎| 1809/1954 [15:21<01:12,  2.00it/s] 99%|█████████▉| 1930/1954 [16:03<00:11,  2.00it/s]100%|██████████| 1954/1954 [16:15<00:00,  2.00it/s]
07/17/2024 20:53:57 - INFO - mingpt.trainer_atari - train loss: 1.236524
target return: 680, eval return: 10
epoch 3
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:37,  1.96it/s]  6%|▌         | 118/1954 [01:14<15:37,  1.96it/s] 12%|█▏        | 238/1954 [02:00<14:28,  1.98it/s] 12%|█▏        | 238/1954 [02:14<14:28,  1.98it/s] 18%|█▊        | 359/1954 [03:01<13:22,  1.99it/s] 18%|█▊        | 359/1954 [03:14<13:22,  1.99it/s] 25%|██▍       | 480/1954 [04:01<12:17,  2.00it/s] 25%|██▍       | 480/1954 [04:14<12:17,  2.00it/s] 31%|███       | 602/1954 [05:01<11:14,  2.01it/s] 31%|███       | 602/1954 [05:14<11:14,  2.01it/s] 37%|███▋      | 724/1954 [06:02<10:12,  2.01it/s] 37%|███▋      | 724/1954 [06:14<10:12,  2.01it/s] 43%|████▎     | 846/1954 [07:02<09:10,  2.01it/s] 43%|████▎     | 846/1954 [07:14<09:10,  2.01it/s] 50%|████▉     | 968/1954 [08:02<08:08,  2.02it/s] 50%|████▉     | 968/1954 [08:14<08:08,  2.02it/s] 56%|█████▌    | 1090/1954 [09:02<07:07,  2.02it/s] 56%|█████▌    | 1090/1954 [09:14<07:07,  2.02it/s] 62%|██████▏   | 1211/1954 [10:02<06:08,  2.02it/s] 62%|██████▏   | 1211/1954 [10:14<06:08,  2.02it/s] 68%|██████▊   | 1332/1954 [11:03<05:08,  2.02it/s] 68%|██████▊   | 1332/1954 [11:14<05:08,  2.02it/s] 74%|███████▍  | 1454/1954 [12:03<04:07,  2.02it/s] 74%|███████▍  | 1454/1954 [12:14<04:07,  2.02it/s] 81%|████████  | 1575/1954 [13:04<03:08,  2.01it/s] 81%|████████  | 1575/1954 [13:14<03:08,  2.01it/s] 87%|████████▋ | 1696/1954 [14:04<02:08,  2.01it/s] 87%|████████▋ | 1696/1954 [14:24<02:08,  2.01it/s] 93%|█████████▎| 1817/1954 [15:04<01:08,  2.01it/s] 93%|█████████▎| 1817/1954 [15:24<01:08,  2.01it/s] 99%|█████████▉| 1938/1954 [16:04<00:07,  2.01it/s]100%|██████████| 1954/1954 [16:12<00:00,  2.01it/s]
07/17/2024 21:11:41 - INFO - mingpt.trainer_atari - train loss: 1.153381
target return: 680, eval return: 6
epoch 4
  0%|          | 0/1954 [00:00<?, ?it/s]  6%|▌         | 118/1954 [01:00<15:40,  1.95it/s]  6%|▌         | 118/1954 [01:19<15:40,  1.95it/s] 12%|█▏        | 237/1954 [02:00<14:33,  1.97it/s] 12%|█▏        | 237/1954 [02:19<14:33,  1.97it/s] 18%|█▊        | 356/1954 [03:00<13:31,  1.97it/s] 18%|█▊        | 356/1954 [03:19<13:31,  1.97it/s] 24%|██▍       | 474/1954 [04:01<12:32,  1.97it/s] 24%|██▍       | 474/1954 [04:19<12:32,  1.97it/s] 30%|███       | 592/1954 [05:01<11:32,  1.97it/s] 30%|███       | 592/1954 [05:19<11:32,  1.97it/s] 36%|███▋      | 710/1954 [06:01<10:32,  1.97it/s] 36%|███▋      | 710/1954 [06:19<10:32,  1.97it/s] 42%|████▏     | 828/1954 [07:01<09:33,  1.96it/s] 42%|████▏     | 828/1954 [07:19<09:33,  1.96it/s] 48%|████▊     | 947/1954 [08:01<08:32,  1.97it/s] 48%|████▊     | 947/1954 [08:19<08:32,  1.97it/s] 55%|█████▍    | 1066/1954 [09:02<07:31,  1.97it/s] 55%|█████▍    | 1066/1954 [09:19<07:31,  1.97it/s] 61%|██████    | 1184/1954 [10:02<06:31,  1.97it/s] 61%|██████    | 1184/1954 [10:19<06:31,  1.97it/s] 67%|██████▋   | 1302/1954 [11:02<05:32,  1.96it/s] 67%|██████▋   | 1302/1954 [11:19<05:32,  1.96it/s] 73%|███████▎  | 1420/1954 [12:02<04:31,  1.96it/s] 73%|███████▎  | 1420/1954 [12:19<04:31,  1.96it/s] 79%|███████▊  | 1538/1954 [13:02<03:31,  1.96it/s] 79%|███████▊  | 1538/1954 [13:19<03:31,  1.96it/s] 85%|████████▍ | 1656/1954 [14:02<02:31,  1.96it/s] 85%|████████▍ | 1656/1954 [14:19<02:31,  1.96it/s] 91%|█████████ | 1775/1954 [15:03<01:31,  1.97it/s] 91%|█████████ | 1775/1954 [15:19<01:31,  1.97it/s] 97%|█████████▋| 1894/1954 [16:03<00:30,  1.97it/s] 97%|█████████▋| 1894/1954 [16:19<00:30,  1.97it/s]100%|██████████| 1954/1954 [16:33<00:00,  1.97it/s]
07/17/2024 21:30:18 - INFO - mingpt.trainer_atari - train loss: 1.080298
target return: 680, eval return: 12
